/*! For license information please see calendar-dashboard-lazy.js.LICENSE.txt */
(self.webpackChunkcalendar=self.webpackChunkcalendar||[]).push([["dashboard-lazy"],{40013:(e,t,a)=>{"use strict";a.d(t,{x:()=>r});var n=a(31352);function r(){return[(0,n.translate)("calendar","Anniversary"),(0,n.translate)("calendar","Appointment"),(0,n.translate)("calendar","Business"),(0,n.translate)("calendar","Education"),(0,n.translate)("calendar","Holiday"),(0,n.translate)("calendar","Meeting"),(0,n.translate)("calendar","Miscellaneous"),(0,n.translate)("calendar","Non-working hours"),(0,n.translate)("calendar","Not in office"),(0,n.translate)("calendar","Personal"),(0,n.translate)("calendar","Phone call"),(0,n.translate)("calendar","Sick day"),(0,n.translate)("calendar","Special occasion"),(0,n.translate)("calendar","Travel"),(0,n.translate)("calendar","Vacation")].map((e=>({value:e,label:e})))}},42849:(e,t,a)=>{"use strict";a.d(t,{P:()=>o});var n=a(82083),r=a(15558);const l=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object.assign({},{alarmComponent:null,type:null,isRelative:!1,absoluteDate:null,absoluteTimezoneId:null,relativeIsBefore:null,relativeIsRelatedToStart:null,relativeUnitTimed:null,relativeAmountTimed:null,relativeUnitAllDay:null,relativeAmountAllDay:null,relativeHoursAllDay:null,relativeMinutesAllDay:null,relativeTrigger:null},e)},o=e=>{if(e.trigger.isRelative()){const t=e.trigger.value.isNegative,a="START"===e.trigger.related,{amount:r,unit:o}=(0,n.Yg)(e.trigger.value.totalSeconds),{unit:c,amount:s,hours:d,minutes:i}=(0,n.cB)(e.trigger.value.totalSeconds),u=e.trigger.value.totalSeconds;return l({alarmComponent:e,type:e.action,isRelative:e.trigger.isRelative(),relativeIsBefore:t,relativeIsRelatedToStart:a,relativeUnitTimed:o,relativeAmountTimed:r,relativeUnitAllDay:c,relativeAmountAllDay:s,relativeHoursAllDay:d,relativeMinutesAllDay:i,relativeTrigger:u})}{const t=(0,r.nZ)(e.trigger.value);return l({alarmComponent:e,type:e.action,isRelative:e.trigger.isRelative(),absoluteDate:t,absoluteTimezoneId:e.trigger.value.timezoneId})}}},74300:(e,t,a)=>{"use strict";a.d(t,{Z:()=>l});var n=a(79753),r=a(49683);class l{id;token;name;description;location;visibility;targetCalendarUri;availability;length;increment;preparationDuration;followupDuration;timeBeforeNextSlot;dailyMax;futureLimit;calendarFreeBusyUris;createTalkRoom;constructor(e){e??={},this.id=e.id,this.token=e.token,this.name=e.name,this.description=e.description,this.location=e.location,this.visibility=e.visibility,this.targetCalendarUri=e.targetCalendarUri,this.availability=e.availability,this.length=o(e.length)??0,this.increment=o(e.increment)??0,this.preparationDuration=o(e.preparationDuration),this.followupDuration=o(e.followupDuration),this.timeBeforeNextSlot=o(e.timeBeforeNextSlot),this.dailyMax=o(e.dailyMax),this.futureLimit=o(e.futureLimit),this.calendarFreeBusyUris=e.calendarFreeBusyUris,this.createTalkRoom=e.createTalkRoom}static createDefault(e,t,a){let n=(0,r.vA)();if(t&&t.availability){const e=(0,r.Xg)(t.availability);n=e.slots,a=e.timezoneId??a}else{const e=(e,t)=>Math.round((new Date).setHours(e,t,0,0)/1e3);["MO","TU","WE","TH","FR"].forEach((t=>n[t].push({start:e(9,0),end:e(17,0)})))}return new l({name:"",description:"",location:"",targetCalendarUri:e,availability:{timezoneId:a,slots:n},visibility:"PRIVATE",length:300,increment:900,preparationDuration:0,followupDuration:0,timeBeforeNextSlot:0,calendarFreeBusyUris:[],futureLimit:5184e3})}clone(){return l.fromJSON(JSON.stringify(this))}static fromJSON(e){return new l(JSON.parse(e))}get bookingUrl(){return`${window.location.protocol}//${window.location.hostname}`+(0,n.generateUrl)("/apps/calendar/appointment/{token}",{token:this.token})}}function o(e){if(null!=e)return parseInt(e)}},25573:(e,t,a)=>{"use strict";a.d(t,{d:()=>n});const n=e=>function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object.assign({},{attachmentProperty:null,fileName:null,formatType:null,uri:null,value:null,xNcHasPreview:null,xNcFileId:null},e)}({attachmentProperty:e,fileName:e.getParameterFirstValue("FILENAME"),formatType:e.formatType,uri:e.uri,value:e.value,xNcHasPreview:"true"===e.getParameterFirstValue("X-NC-HAS-PREVIEW"),xNcFileId:e.getParameterFirstValue("X-NC-FILE-ID")})},31799:(e,t,a)=>{"use strict";a.d(t,{Z:()=>n});const n=e=>function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object.assign({},{attendeeProperty:null,commonName:null,calendarUserType:"INDIVIDUAL",participationStatus:"NEEDS-ACTION",role:"REQ-PARTICIPANT",rsvp:!1,uri:null,member:null},e)}({attendeeProperty:e,commonName:e.commonName,calendarUserType:e.userType,participationStatus:e.participationStatus,role:e.role,rsvp:e.rsvp,uri:e.email,member:e.member})},37494:(e,t,a)=>{"use strict";a.d(t,{J:()=>l,o:()=>o});var n=a(62768),r=a(96466);const l=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object.assign({},{id:"",displayName:"",color:(0,n.ny)(""),enabled:!0,loading:!1,supportsEvents:!0,supportsJournals:!1,supportsTasks:!1,owner:"",timezone:null,shares:[],publishURL:null,url:"",readOnly:!1,order:0,isSharedWithMe:!1,canBeShared:!1,canBePublished:!1,dav:!1,calendarObjects:[],fetchedTimeRanges:[]},e)},o=(e,t)=>{const a=btoa(e.url),o=e.displayname||function(e){e.endsWith("/")&&(e=e.substring(0,e.length-1));return e.substring(e.lastIndexOf("/")+1)}(e.url);let c=(0,n._u)(e.color);c||(c=(0,n.ny)(o));const s=e.components.includes("VEVENT"),d=e.components.includes("VJOURNAL"),i=e.components.includes("VTODO"),u=e.owner,m=!e.isWriteable(),p=e.isShareable(),g=e.isPublishable(),b=e.order||0,h=e.url,f=e.publishURL||null,_=e.timezone||null;let y,j=!1;j=!t||u!==t.url,t?"boolean"==typeof e.enabled?y=e.enabled:(y=!0,e.enabled=!0):y=!0;const C=[];if(t&&Array.isArray(e.shares))for(const a of e.shares)a.href!==t.principalScheme&&C.push((0,r.F)(a));return l({id:a,displayName:o,color:c,order:b,url:h,enabled:y,supportsEvents:s,supportsJournals:d,supportsTasks:i,isSharedWithMe:j,owner:u,readOnly:m,publishURL:f,canBeShared:p,canBePublished:g,shares:C,timezone:_,dav:e})}},96690:(e,t,a)=>{"use strict";a.d(t,{Vw:()=>c,un:()=>o});var n=a(32066),r=a(59055);const l=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object.assign({},{id:null,calendarId:null,dav:null,calendarComponent:null,uid:null,uri:null,objectType:null,isEvent:!1,isJournal:!1,isTodo:!1,existsOnServer:!1},e)},o=(e,t)=>{const a=(0,n.wJ)().getParserForFileType("text/calendar");if("string"!=typeof e.data||""===e.data.trim())throw new Error("Empty calendar object");a.parse(e.data);const o=a.getItemIterator().next().value;if(!o)throw new Error("Empty calendar object");const c=o.getVObjectIterator().next().value;return l({id:btoa(e.url),calendarId:t,dav:e,calendarComponent:o,uid:c.uid,uri:e.url,objectType:c.name,isEvent:c.name===r.RP,isJournal:c.name===r.PA,isTodo:c.name===r.nx,existsOnServer:!0})},c=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const a=e.getVObjectIterator(),n=a.next().value;if(!n)throw new Error("Calendar object without vobjects");return l({calendarId:t,calendarComponent:e,uid:n.uid,objectType:n.name,isEvent:n.name===r.RP,isJournal:n.name===r.PA,isTodo:n.name===r.nx})}},96466:(e,t,a)=>{"use strict";a.d(t,{F:()=>r});var n=a(59055);const r=e=>{const t=btoa(encodeURI(e.href));let a;a=e["common-name"]&&""!==e["common-name"].trim()?e["common-name"]:e.href.startsWith(n.vG)?decodeURIComponent(e.href.slice(28)):e.href.startsWith(n.v0)?decodeURIComponent(e.href.slice(27)):e.href;return function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object.assign({},{id:null,displayName:null,writeable:!1,isUser:!1,isGroup:!1,isCircle:!1,uri:null},e)}({id:t,displayName:a,writeable:e.access[0].endsWith("read-write"),isUser:e.href.startsWith(n.v0),isGroup:e.href.startsWith(n.vG),isCircle:e.href.startsWith(n.WV),uri:e.href})}},59055:(e,t,a)=>{"use strict";a.d(t,{EG:()=>d,EI:()=>p,FR:()=>i,On:()=>u,PA:()=>r,RP:()=>n,WV:()=>s,bL:()=>g,mz:()=>m,nx:()=>l,v0:()=>o,vG:()=>c});const n="VEVENT",r="VJOURNAL",l="VTODO",o="principal:principals/users/",c="principal:principals/groups/",s="principal:principals/circles/",d="principal:principals/calendar-resources/",i="principal:principals/calendar-rooms/",u="contact_birthdays",m="default",p="importing",g="processing"},53978:(e,t,a)=>{"use strict";a.d(t,{H4:()=>m,QX:()=>u,_F:()=>i});var n=a(15558),r=a(32066),l=a(62768),o=a(42849),c=a(31799),s=a(25573),d=a(88440);const i=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object.assign({},{eventComponent:null,title:null,startDate:null,startTimezoneId:null,endDate:null,endTimezoneId:null,isAllDay:!1,canModifyAllDay:!0,location:null,description:null,accessClass:null,status:null,timeTransparency:null,recurrenceRule:(0,d.K)(),hasMultipleRRules:!1,isMasterItem:!1,isRecurrenceException:!1,forceThisAndAllFuture:!1,canCreateRecurrenceException:!1,attendees:[],organizer:null,alarms:[],customColor:null,categories:[],attachments:[]},e)},u=e=>{const t=i({eventComponent:e,title:e.title,isAllDay:e.isAllDay(),canModifyAllDay:e.canModifyAllDay(),location:e.location,description:e.description,accessClass:e.accessClass,status:e.status,timeTransparency:e.timeTransparency,categories:Array.from(e.getCategoryIterator()),isMasterItem:e.isMasterItem(),isRecurrenceException:e.isRecurrenceException(),canCreateRecurrenceException:e.canCreateRecurrenceExceptions()});if(t.startDate=(0,n.nZ)(e.startDate),t.startTimezoneId=e.startDate.timezoneId,e.isAllDay()){const a=e.endDate.clone();a.addDuration(r.iM.fromSeconds(-86400)),t.endDate=(0,n.nZ)(a)}else t.endDate=(0,n.nZ)(e.endDate);if(t.endTimezoneId=e.endDate.timezoneId,e.organizer){const a=e.getFirstProperty("ORGANIZER");t.organizer={commonName:a.commonName,uri:a.email,attendeeProperty:a}}for(const a of e.getAlarmIterator())t.alarms.push((0,o.P)(a));for(const a of e.getAttendeeIterator())t.attendees.push((0,c.Z)(a));for(const a of e.getPropertyIterator("ATTACH"))t.attachments.push((0,s.d)(a));const a=e.getPropertyIterator("RRULE"),u=a.next().value;if(u&&(t.recurrenceRule=(0,d.N)(u.getFirstValue(),e.startDate),t.hasMultipleRRules=!a.next().done),e.hasProperty("COLOR")){const a=(0,l.eq)(e.getFirstPropertyFirstValue("COLOR"));null!==a&&(t.customColor=a)}return t},m=(e,t)=>{t.title=e.title,t.location=e.location,t.description=e.description,t.accessClass=e.accessClass,t.status=e.status,t.timeTransparency=e.timeTransparency;for(const a of e.categories)t.addCategory(a);e.organizer&&t.setOrganizerFromNameAndEMail(e.organizer.commonName,e.organizer.uri);for(const a of e.alarms)if(a.isRelative){const e=r.iM.fromSeconds(a.relativeTrigger);t.addRelativeAlarm(a.type,e,a.relativeIsRelatedToStart)}else{const e=r.ul.fromJSDate(a.absoluteDate);t.addAbsoluteAlarm(a.type,e)}for(const a of e.attendees)t.addProperty(a.attendeeProperty);for(const a of e.eventComponent.getPropertyIterator("RRULE"))t.addProperty(a);e.customColor&&(t.color=(0,l.Nt)(e.customColor))}},4269:(e,t,a)=>{"use strict";a.d(t,{B:()=>r,R:()=>l});var n=a(59055);const r=e=>Object.assign({},{id:null,calendarUserType:"INDIVIDUAL",emailAddress:null,displayname:null,principalScheme:null,userId:null,url:null,dav:null,isCircle:!1,isUser:!1,isGroup:!1,isCalendarResource:!1,isCalendarRoom:!1,principalId:null},e),l=e=>{const t=btoa(encodeURI(e.url)),a=e.calendarUserType,l=e.principalScheme,o=e.email,c=e.displayname,s=e.principalScheme.startsWith(n.v0),d=e.principalScheme.startsWith(n.vG),i=e.principalScheme.startsWith(n.WV),u=e.principalScheme.startsWith(n.EG),m=e.principalScheme.startsWith(n.FR);let p=null;s?p=e.principalScheme.substring(n.v0.length):d?p=e.principalScheme.substring(n.vG.length):i?p=e.principalScheme.substring(n.WV.length):u?p=e.principalScheme.substring(n.EG.length):m&&(p=e.principalScheme.substring(n.FR.length));const g=e.principalUrl,b=e.userId;return r({id:t,calendarUserType:a,principalScheme:l,emailAddress:o,displayname:c,url:g,dav:e,isUser:s,isGroup:d,isCircle:i,isCalendarResource:u,isCalendarRoom:m,principalId:p,userId:b})}},88440:(e,t,a)=>{"use strict";a.d(t,{K:()=>l,N:()=>o});var n=a(53854),r=a(15558);const l=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object.assign({},{recurrenceRuleValue:null,frequency:"NONE",interval:1,count:null,until:null,byDay:[],byMonth:[],byMonthDay:[],bySetPosition:null,isUnsupported:!1},e)},o=(e,t)=>{switch(e.frequency){case"DAILY":return b(e);case"WEEKLY":return h(e,t);case"MONTHLY":return f(e,t);case"YEARLY":return _(e,t);default:return I(e,{isUnsupported:!0})}},c=["BYSECOND","BYMINUTE","BYHOUR","BYDAY","BYMONTHDAY","BYYEARDAY","BYWEEKNO","BYMONTH","BYSETPOS"],s=["BYSECOND","BYMINUTE","BYHOUR","BYMONTHDAY","BYYEARDAY","BYWEEKNO","BYMONTH","BYSETPOS"],d=["BYSECOND","BYMINUTE","BYHOUR","BYYEARDAY","BYWEEKNO","BYMONTH"],i=["BYSECOND","BYMINUTE","BYHOUR","BYMONTHDAY","BYYEARDAY","BYWEEKNO"],u=["SU","MO","TU","WE","TH","FR","SA"],m=(e,t)=>Array.apply(null,Array(t-e+1)).map(((t,a)=>a+e)).map((e=>e.toString())),p=m(1,31),g=m(1,12),b=e=>{const t=C(e,c);return I(e,{isUnsupported:t})},h=(e,t)=>{const a=C(e,s),r=e.getComponent("BYDAY").some((e=>!u.includes(e))),l=a||r,o=e.getComponent("BYDAY").filter((e=>u.includes(e)));return 0===o.length&&o.push((0,n.F)(t.jsDate)),I(e,{byDay:o,isUnsupported:l})},f=(e,t)=>{let a=C(e,d),n=[],r=null,l=[];if(C(e,["BYMONTHDAY"])){C(e,["BYDAY","BYSETPOS"])&&(a=!0);const t=e.getComponent("BYMONTHDAY").some((e=>!p.includes(e.toString())));a=a||t,l=e.getComponent("BYMONTHDAY").filter((e=>p.includes(e.toString()))).map((e=>e.toString()))}else if(C(e,["BYDAY"])&&C(e,["BYSETPOS"])){y(e.getComponent("BYDAY"))?n=e.getComponent("BYDAY"):(n=["MO","TU","WE","TH","FR","SA","SU"],a=!0);const t=e.getComponent("BYSETPOS");1===t.length&&j(t[0])?r=t[0]:(r=1,a=!0)}else if(C(e,["BYDAY"])){const o=e.getComponent("BYDAY");if(o.length>1)l.push(t.day.toString()),a=!0;else{const e=o[0],c=/^(-?\d)([A-Z]{2})$/.exec(e);if(c){const e=c[1],t=c[2];j(e)?(n=[t],r=parseInt(e,10)):(n=[t],r=1,a=!0)}else l.push(t.day.toString()),a=!0}}else l.push(t.day.toString());return I(e,{byDay:n,bySetPosition:r,byMonthDay:l,isUnsupported:a})},_=(e,t)=>{let a=C(e,i),n=[],r=null,l=[];if(C(e,["BYMONTH"])){const t=e.getComponent("BYMONTH").some((e=>!g.includes(e.toString())));a=a||t,l=e.getComponent("BYMONTH").filter((e=>g.includes(e.toString()))).map((e=>e.toString()))}else l.push(t.month.toString());if(C(e,["BYDAY"])&&C(e,["BYSETPOS"])){y(e.getComponent("BYDAY"))?n=e.getComponent("BYDAY"):(n=["MO","TU","WE","TH","FR","SA","SU"],a=!0);const t=e.getComponent("BYSETPOS");1===t.length&&j(t[0])?r=t[0]:(r=1,a=!0)}else if(C(e,["BYDAY"])){const t=e.getComponent("BYDAY");if(t.length>1)a=!0;else{const e=t[0],l=/^(-?\d)([A-Z]{2})$/.exec(e);if(l){const e=l[1],t=l[2];j(e)?(n=[t],r=parseInt(e,10)):(n=[t],r=1,a=!0)}else a=!0}}return I(e,{byDay:n,bySetPosition:r,byMonth:l,isUnsupported:a})},y=e=>["MO","TU","WE","TH","FR","SA","SU","FR,MO,SA,SU,TH,TU,WE","FR,MO,TH,TU,WE","SA,SU"].includes(e.slice().sort().join(",")),j=e=>["-2","-1","1","2","3","4","5"].includes(e.toString()),C=(e,t)=>{for(const a of t){if(e.getComponent(a).length>0)return!0}return!1},I=(e,t)=>{const a=null!==e.count&&null!==e.until;let n={};return a&&(n={isUnsupported:a}),l(Object.assign({},{recurrenceRuleValue:e,frequency:e.frequency,interval:parseInt(e.interval,10)||1,count:e.count,until:e.until?(0,r.nZ)(e.until):null},t,n))}},8838:(e,t,a)=>{"use strict";a.d(t,{w:()=>l});var n=a(31352),r=a(40013);const l=()=>({accessClass:{readableName:(0,n.translate)("calendar","When shared show"),icon:"Eye",options:[{value:"PUBLIC",label:(0,n.translate)("calendar","When shared show full event")},{value:"CONFIDENTIAL",label:(0,n.translate)("calendar","When shared show only busy")},{value:"PRIVATE",label:(0,n.translate)("calendar","When shared hide this event")}],multiple:!1,info:(0,n.translate)("calendar","The visibility of this event in shared calendars."),defaultValue:"PUBLIC"},location:{readableName:(0,n.translate)("calendar","Location"),placeholder:(0,n.translate)("calendar","Add a location"),icon:"MapMarker"},description:{readableName:(0,n.translate)("calendar","Description"),placeholder:(0,n.translate)("calendar","Add a description"),icon:"TextBoxOutline",defaultNumberOfRows:2},status:{readableName:(0,n.translate)("calendar","Status"),icon:"Check",options:[{value:"CONFIRMED",label:(0,n.translate)("calendar","Confirmed")},{value:"TENTATIVE",label:(0,n.translate)("calendar","Tentative")},{value:"CANCELLED",label:(0,n.translate)("calendar","Canceled")}],multiple:!1,info:(0,n.translate)("calendar","Confirmation about the overall status of the event."),defaultValue:"CONFIRMED"},timeTransparency:{readableName:(0,n.translate)("calendar","Show as"),icon:"Briefcase",multiple:!1,info:(0,n.translate)("calendar","Take this event into account when calculating free-busy information."),options:[{value:"TRANSPARENT",label:(0,n.translate)("calendar","Free")},{value:"OPAQUE",label:(0,n.translate)("calendar","Busy")}],defaultValue:"TRANSPARENT"},categories:{readableName:(0,n.translate)("calendar","Categories"),icon:"Tag",multiple:!0,info:(0,n.translate)("calendar","Categories help you to structure and organize your events."),placeholder:(0,n.translate)("calendar","Search or add categories"),tagPlaceholder:(0,n.translate)("calendar","Add this as a new category"),options:(0,r.x)()},color:{readableName:(0,n.translate)("calendar","Custom color"),icon:"EyedropperVariant",multiple:!1,info:(0,n.translate)("calendar","Special color of this event. Overrides the calendar-color.")}})},34671:(e,t,a)=>{"use strict";a.d(t,{_g:()=>c,rF:()=>d,vj:()=>s});var n=a(79753),r=a(93664),l=a(74300),o=a(75357);async function c(e){o.ZP.debug("Creating appointment config",{config:e});const t=(0,n.generateUrl)("/apps/calendar/v1/appointment_configs"),a=await r.Z.post(t,e);return new l.Z(a.data.data)}async function s(e){o.ZP.debug("Deleting appointment config",{id:e});const t=(0,n.generateUrl)("/apps/calendar/v1/appointment_configs/{id}",{id:e});await r.Z.delete(t)}async function d(e){o.ZP.debug("Updating appointment config",{config:e});const t=(0,n.generateUrl)("/apps/calendar/v1/appointment_configs/{id}",{id:e.id}),a=await r.Z.put(t,e);return new l.Z(a.data.data)}},2323:(e,t,a)=>{"use strict";a.d(t,{Dz:()=>g,Oq:()=>p,S3:()=>b,V_:()=>_,XW:()=>f,YR:()=>h,i8:()=>C,yG:()=>u,z$:()=>j});var n=a(3781),r=a.n(n),l=a(79753),o=a(77958),c=a(59055);const s={},d=e=>JSON.stringify(e),i=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=d(e);return s[t]||(s[t]=new(r())({rootUrl:(0,l.generateRemoteUrl)("dav")},(()=>{const t={"X-Requested-With":"XMLHttpRequest",requesttoken:(0,o.IH)(),"X-NC-CalDAV-Webcal-Caching":"On",...e},a=new XMLHttpRequest,n=a.open;return a.open=function(){const e=n.apply(this,arguments);for(const e in t)a.setRequestHeader(e,t[e]);return e},OC.registerXHRForErrorProcessing(a),a}))),s[t]},u=async()=>{await i().connect({enableCalDAV:!0})},m=e=>i(e).calendarHomes[0],p=()=>m().findAllCalDAVCollectionsGrouped(),g=()=>m().findAllDeletedCalendars(),b=async e=>{const t=[];for(const a of e){const e=i().publicCalendarHome.find(a).catch((()=>null));t.push(e)}return(await Promise.all(t)).filter((e=>null!==e))},h=async(e,t,a,n,r)=>m().createCalendarCollection(e,t,a,n,r),f=async(e,t,a,n)=>m().createSubscribedCollection(e,t,a,n),_=async()=>(await m().enableBirthdayCalendar(),y()),y=async()=>m().find(c.On),j=()=>i().currentUserPrincipal,C=async e=>i().findPrincipal(e)},67718:(e,t,a)=>{"use strict";a.d(t,{v:()=>l});var n=a(93664),r=a(83884);const l=async(e,t)=>{await n.Z.post((0,r.i)(e),{value:t})}},90124:(e,t,a)=>{"use strict";a.d(t,{jv:()=>d});var n=a(93664),r=(a(31352),a(79753)),l=a(43554),o=a(77958),c=a(75357),s=a(33827);async function d(e){const t=(0,l.j)("calendar","talk_api_version"),a=e.getConferenceList()[0]?.uri??e.location;if(!a||!a.startsWith(window.location.protocol+"//"+window.location.host))return void c.ZP.debug("Event's conference/location is from another host",a);const d=a.match(/\/call\/([a-z0-9]*)$/)[1];if(d)try{const a=await n.Z.get((0,r.generateOcsUrl)("apps/spreed/api/"+t+"/",2)+"room/"+d+"/participants");if(!a.data.ocs.data.some((e=>e.actorId===(0,o.ts)().uid&&e.participantType<=2)))return void c.ZP.debug("Current user is not a moderator or owner",{currentUser:(0,o.ts)().uid,conversation:a.data.ocs.data});for(const a of e.getAttendeeIterator()){if(c.ZP.debug("Processing attendee",{attendee:a}),["GROUP","RESOURCE","ROOM"].includes(a.userType))continue;let e=(0,s.Oo)(a.email),l="emails";try{const t=await n.Z.get((0,r.generateOcsUrl)("core/autocomplete/",2)+"get?search="+encodeURIComponent(e)+"&itemType=&itemId=%20&shareTypes[]=0&limit=2");1===t.data.ocs.data.length?(e=t.data.ocs.data[0].id,l="users"):c.ZP.debug("Attendee "+e+" is not a Nextcloud user")}catch(t){c.ZP.info("Could not find user data for attendee "+e,{error:t})}"users"!==l||e!==(0,o.ts)().uid?await n.Z.post((0,r.generateOcsUrl)("apps/spreed/api/"+t+"/",2)+"room/"+d+"/participants",{newParticipant:e,source:l}):c.ZP.debug("Skipping organizer")}}catch(e){c.ZP.warn("Could not update Talk room attendees",{error:e})}else c.ZP.debug("URL "+a+" contains no call token")}},54782:(e,t,a)=>{"use strict";a.d(t,{Z:()=>l});const n=(0,a(32066).ko)();let r=!1;function l(){return r||(n.registerDefaultTimezones(),r=!0),n}},50923:(e,t,a)=>{"use strict";a.d(t,{N:()=>l});var n=a(44140),r=a.n(n);const l=()=>{const e=r().determine();if(!e)return"UTC";const t=e.name();return t||"UTC"}},84627:(e,t,a)=>{"use strict";a.d(t,{Z:()=>s});var n=a(20144),r=a(34671),l=a(75357);const o={addInitialConfigs(e,t){for(const a of t)n.default.set(e.configs,a.id,a)},updateConfig(e,t){let{config:a}=t;e.configs[a.id]&&n.default.set(e.configs,a.id,a.clone())},addConfig(e,t){let{config:a}=t;n.default.set(e.configs,a.id,a)},deleteConfig(e,t){let{id:a}=t;e.configs[a]&&n.default.delete(e.configs,a)}},c={allConfigs:e=>Object.values(e.configs)},s={state:{configs:{}},mutations:o,getters:c,actions:{async updateConfig(e,t){let{commit:a}=e,{config:n}=t;try{const e=await(0,r.rF)(n);return a("updateConfig",{config:e}),e}catch(e){throw l.ZP.error("Failed to update config",{error:e}),e}},async createConfig(e,t){let{commit:a}=e,{config:n}=t;try{const e=await(0,r._g)(n);return a("addConfig",{config:e}),e}catch(e){throw l.ZP.error("Failed to create config",{error:e}),e}},async deleteConfig(e,t){let{commit:a}=e,{id:n}=t;try{await(0,r.vj)(n),a("deleteConfig",{id:n})}catch(e){throw l.ZP.error("Failed to delete config",{error:e}),e}}}}},64280:(e,t,a)=>{"use strict";a.d(t,{Z:()=>j});var n=a(20144),r=a(54782),l=a(15558),o=a(32066),c=a(53854),s=a(53978),d=a(82083),i=a(62768),u=a(42849),m=a(45792),p=a(75357),g=a(92539),b=a(8838),h=a(79753),f=a(90124);const _={setCalendarObjectInstanceForExistingEvent(e,t){let{calendarObject:a,calendarObjectInstance:n,objectId:r,recurrenceId:l}=t;e.isNew=!1,e.calendarObject=a,e.calendarObjectInstance=n,e.existingEvent.objectId=r,e.existingEvent.recurrenceId=l},setCalendarObjectInstanceForNewEvent(e,t){let{calendarObject:a,calendarObjectInstance:n}=t;e.isNew=!0,e.calendarObject=a,e.calendarObjectInstance=n,e.existingEvent.objectId=null,e.existingEvent.recurrenceId=null},resetCalendarObjectInstanceObjectIdAndRecurrenceId(e){e.isNew=!1,e.calendarObject=null,e.calendarObjectInstance=null,e.existingEvent.objectId=null,e.existingEvent.recurrenceId=null},changeTitle(e,t){let{calendarObjectInstance:a,title:n}=t;a.eventComponent.title=n,a.title=n},changeStartDate(e,t){let{calendarObjectInstance:a,startDate:n}=t;a.eventComponent.startDate.year=n.getFullYear(),a.eventComponent.startDate.month=n.getMonth()+1,a.eventComponent.startDate.day=n.getDate(),a.eventComponent.startDate.hour=n.getHours(),a.eventComponent.startDate.minute=n.getMinutes(),a.eventComponent.startDate.second=0;const c=a.eventComponent.isAllDay(),s=a.eventComponent.endDate.clone(),d=a.eventComponent.startDate.clone();if(c){if(s.addDuration(o.iM.fromSeconds(-86400)),-1===s.compare(d)){const e=(0,r.Z)().getTimezoneForId(s.timezoneId);a.eventComponent.endDate=a.eventComponent.startDate.getInTimezone(e),a.endDate=(0,l.nZ)(a.eventComponent.endDate),a.eventComponent.endDate.addDuration(o.iM.fromSeconds(86400))}}else if(-1===s.compare(d)){const e=(0,r.Z)().getTimezoneForId(s.timezoneId);a.eventComponent.endDate=a.eventComponent.startDate.getInTimezone(e),a.endDate=(0,l.nZ)(a.eventComponent.endDate)}a.startDate=n},changeStartTimezone(e,t){let{calendarObjectInstance:a,startTimezone:n}=t;const l=(0,r.Z)().getTimezoneForId(n);a.eventComponent.startDate.replaceTimezone(l),a.startTimezoneId=n,"floating"!==n&&"floating"!==a.endTimezoneId||(a.eventComponent.endDate.replaceTimezone(l),a.endTimezoneId=n)},changeEndDate(e,t){let{calendarObjectInstance:a,endDate:n}=t;const c=a.eventComponent.endDate;a.eventComponent.endDate=c,a.eventComponent.endDate.year=n.getFullYear(),a.eventComponent.endDate.month=n.getMonth()+1,a.eventComponent.endDate.day=n.getDate(),a.eventComponent.endDate.hour=n.getHours(),a.eventComponent.endDate.minute=n.getMinutes(),a.eventComponent.endDate.second=0;const s=a.eventComponent.isAllDay(),d=a.eventComponent.endDate.clone(),i=a.eventComponent.startDate.clone();if(s){if(-1===d.compare(i)){const e=(0,r.Z)().getTimezoneForId(i.timezoneId);a.eventComponent.startDate=a.eventComponent.endDate.getInTimezone(e),a.startDate=(0,l.nZ)(a.eventComponent.startDate)}a.eventComponent.endDate.addDuration(o.iM.fromSeconds(86400))}else if(-1===d.compare(i))if(d.addDuration(o.iM.fromSeconds(86400)),-1===d.compare(i)){const e=(0,r.Z)().getTimezoneForId(i.timezoneId);a.eventComponent.startDate=a.eventComponent.endDate.getInTimezone(e),a.startDate=(0,l.nZ)(a.eventComponent.startDate)}else a.eventComponent.endDate.addDuration(o.iM.fromSeconds(86400)),n=new Date(n.getTime()+864e5);a.endDate=n},changeEndTimezone(e,t){let{calendarObjectInstance:a,endTimezone:n}=t;const l=(0,r.Z)().getTimezoneForId(n);a.eventComponent.endDate.replaceTimezone(l),a.endTimezoneId=n,"floating"!==n&&"floating"!==a.startTimezoneId||(a.eventComponent.startDate.replaceTimezone(l),a.startTimezoneId=n)},toggleAllDay(e,t){let{calendarObjectInstance:a}=t;if(!a.eventComponent.canModifyAllDay())return;const n=a.eventComponent.isAllDay();a.eventComponent.startDate.isDate=!n,a.eventComponent.endDate.isDate=!n,a.isAllDay=a.eventComponent.isAllDay(),n?a.eventComponent.endDate.addDuration(o.iM.fromSeconds(-86400)):a.eventComponent.endDate.addDuration(o.iM.fromSeconds(86400))},changeTimeToDefaultForTimedEvents(e,t){let{calendarObjectInstance:a}=t;const n=a.eventComponent.startDate,r=a.eventComponent.endDate;0===n.hour&&0===n.minute&&0===r.hour&&0===r.minute&&(n.hour=10,r.hour=11,a.startDate=(0,l.nZ)(n),a.endDate=(0,l.nZ)(r))},changeLocation(e,t){let{calendarObjectInstance:a,location:n}=t;a.eventComponent.deleteAllProperties("X-APPLE-STRUCTURED-LOCATION"),a.eventComponent.location=n,a.location=n},changeDescription(e,t){let{calendarObjectInstance:a,description:n}=t;const r=a.eventComponent.getFirstProperty("Description");if(r)for(const e of r.getParametersIterator())r.deleteParameter(e.name);a.eventComponent.deleteAllProperties("X-ALT-DESC"),a.eventComponent.description=n,a.description=n},changeAccessClass(e,t){let{calendarObjectInstance:a,accessClass:n}=t;a.eventComponent.accessClass=n,a.accessClass=n},changeStatus(e,t){let{calendarObjectInstance:a,status:n}=t;a.eventComponent.status=n,a.status=n},changeTimeTransparency(e,t){let{calendarObjectInstance:a,timeTransparency:n}=t;a.eventComponent.timeTransparency=n,a.timeTransparency=n},changeCustomColor(e,t){let{calendarObjectInstance:a,customColor:r}=t;if(null===r)return a.eventComponent.deleteAllProperties("COLOR"),void n.default.set(a,"customColor",null);const l=(0,i.Nt)(r),o=(0,i.eq)(l);if(!l||!o)return console.error("Setting custom color failed"),console.error("customColor: ",r),console.error("cssColorName: ",l),void console.error("hexColorOfCssName: ",o);a.eventComponent.color=l,n.default.set(a,"customColor",o)},addAttendee(e,t){let{calendarObjectInstance:a,commonName:n,uri:r,calendarUserType:l=null,participationStatus:c=null,role:s=null,rsvp:d=null,language:i=null,timezoneId:u=null,organizer:m=null}=t;const p=o.NQ.fromNameAndEMail(n,r);null!==l&&(p.userType=l),null!==c&&(p.participationStatus=c),null!==s&&(p.role=s),null!==d&&(p.rsvp=d),null!==i&&(p.language=i),null!==u&&p.updateParameterIfExist("TZID",u),a.eventComponent.addProperty(p),a.attendees.push({commonName:n,participationStatus:c,role:s,rsvp:d,uri:r,attendeeProperty:p}),!a.organizer&&m&&this.commit("setOrganizer",{calendarObjectInstance:a,commonName:m.displayname,email:m.emailAddress})},removeAttendee(e,t){let{calendarObjectInstance:a,attendee:n}=t;a.eventComponent.removeAttendee(n.attendeeProperty),"GROUP"===n.attendeeProperty.userType&&n.members.forEach((function(e){a.eventComponent.removeAttendee(e.attendeeProperty);const t=a.attendees.indexOf(e);-1!==t&&a.attendees.splice(t,1)}));const r=a.attendees.indexOf(n);-1!==r&&a.attendees.splice(r,1)},changeAttendeesParticipationStatus(e,t){let{attendee:a,participationStatus:n}=t;a.attendeeProperty.participationStatus=n,a.participationStatus=n},changeAttendeesRole(e,t){let{attendee:a,role:n}=t;a.attendeeProperty.role=n,a.role=n},toggleAttendeeRSVP(e,t){let{attendee:a}=t;const n=a.attendeeProperty.rsvp;a.attendeeProperty.rsvp=!n,a.rsvp=!n},setOrganizer(e,t){let{calendarObjectInstance:a,commonName:r=null,email:l}=t;a.eventComponent.setOrganizerFromNameAndEMail(r,l),n.default.set(a,"organizer",{}),n.default.set(a.organizer,"commonName",r),n.default.set(a.organizer,"uri",l),n.default.set(a.organizer,"attendeeProperty",a.eventComponent.getFirstProperty("ORGANIZER"))},addCategory(e,t){let{calendarObjectInstance:a,category:n}=t;a.eventComponent.addCategory(n),a.categories.push(n)},removeCategory(e,t){let{calendarObjectInstance:a,category:n}=t;a.eventComponent.removeCategory(n);const r=a.categories.indexOf(n);-1!==r&&a.categories.splice(r,1)},changeRecurrenceInterval(e,t){let{calendarObjectInstance:a,recurrenceRule:n,interval:r}=t;n.recurrenceRuleValue&&(n.recurrenceRuleValue.interval=r,n.interval=r,console.debug(n.recurrenceRuleValue._innerValue.toString()))},changeRecurrenceFrequency(e,t){let{calendarObjectInstance:a,recurrenceRule:n,frequency:r}=t;n.recurrenceRuleValue&&(n.recurrenceRuleValue.frequency=r,n.frequency=r,console.debug(n.recurrenceRuleValue._innerValue.toString()))},changeRecurrenceCount(e,t){let{calendarObjectInstance:a,recurrenceRule:n,count:r}=t;n.recurrenceRuleValue&&(n.recurrenceRuleValue.count=r,n.count=r,n.until=null,console.debug(n.recurrenceRuleValue._innerValue.toString()))},changeRecurrenceUntil(e,t){let{calendarObjectInstance:a,recurrenceRule:n,until:r}=t;n.recurrenceRuleValue&&("floating"!==a.startTimezoneId?n.recurrenceRuleValue.until=o.ul.fromJSDate(r,{zone:"utc"}):n.recurrenceRuleValue.until=o.ul.fromJSDate(r),n.until=r,n.count=null,console.debug(n.recurrenceRuleValue._innerValue.toString()))},changeRecurrenceToInfinite(e,t){let{calendarObjectInstance:a,recurrenceRule:n}=t;n.recurrenceRuleValue&&(n.recurrenceRuleValue.setToInfinite(),n.until=null,n.count=null,console.debug(n.recurrenceRuleValue._innerValue.toString()))},resetRecurrenceByParts(e,t){let{calendarObjectInstance:a,recurrenceRule:r}=t;if(r.recurrenceRuleValue){const e=["BYSECOND","BYMINUTE","BYHOUR","BYDAY","BYMONTHDAY","BYYEARDAY","BYWEEKNO","BYMONTH","BYSETPOS"];for(const t of e)r.recurrenceRuleValue.setComponent(t,[]);n.default.set(r,"byDay",[]),n.default.set(r,"byMonth",[]),n.default.set(r,"byMonthDay",[]),n.default.set(r,"bySetPosition",null),console.debug(r.recurrenceRuleValue._innerValue.toString())}},setDefaultRecurrenceByPartsForWeekly(e,t){let{calendarObjectInstance:a,recurrenceRule:n}=t;if(n.recurrenceRuleValue){const e=(0,c.F)(a.startDate);n.recurrenceRuleValue.setComponent("BYDAY",[e]),n.byDay.push(e),console.debug(n.recurrenceRuleValue._innerValue.toString())}},setDefaultRecurrenceByPartsForMonthly(e,t){let{calendarObjectInstance:a,recurrenceRule:n}=t;if(n.recurrenceRuleValue){const e=a.startDate.getDate().toString();n.recurrenceRuleValue.setComponent("BYMONTHDAY",[e]),n.byMonthDay.push(e),console.debug(n.recurrenceRuleValue._innerValue.toString())}},setDefaultRecurrenceByPartsForMonthlyBySetPosition(e,t){let{calendarObjectInstance:a,recurrenceRule:n}=t;if(n.recurrenceRuleValue){const{byDay:e,bySetPosition:t}=(0,c.b)(a.startDate);n.recurrenceRuleValue.setComponent("BYDAY",[e]),n.recurrenceRuleValue.setComponent("BYSETPOS",[t]),n.byDay.push(e),n.bySetPosition=t,console.debug(n.recurrenceRuleValue._innerValue.toString())}},setDefaultRecurrenceByPartsForYearly(e,t){let{calendarObjectInstance:a,recurrenceRule:n}=t;if(n.recurrenceRuleValue){const e=a.startDate.getMonth()+1;n.recurrenceRuleValue.setComponent("BYMONTH",[e]),n.byMonth.push(e),console.debug(n.recurrenceRuleValue._innerValue.toString())}},addByDayToRecurrenceRule(e,t){let{calendarObjectInstance:a,recurrenceRule:n,byDay:r}=t;if(n.recurrenceRuleValue){const e=n.recurrenceRuleValue.getComponent("BYDAY");-1===e.indexOf(r)&&(e.push(r),n.recurrenceRuleValue.setComponent("BYDAY",e));-1===n.byDay.indexOf(r)&&n.byDay.push(r),console.debug(n.recurrenceRuleValue._innerValue.toString())}},removeByDayFromRecurrenceRule(e,t){let{calendarObjectInstance:a,recurrenceRule:n,byDay:r}=t;if(n.recurrenceRuleValue){const e=n.recurrenceRuleValue.getComponent("BYDAY"),t=e.indexOf(r);-1!==t&&(e.splice(t,1),n.recurrenceRuleValue.setComponent("BYDAY",e));const a=n.byDay.indexOf(r);-1!==a&&n.byDay.splice(a,1),console.debug(n.recurrenceRuleValue._innerValue.toString())}},addByMonthDayToRecurrenceRule(e,t){let{calendarObjectInstance:a,recurrenceRule:n,byMonthDay:r}=t;if(n.recurrenceRuleValue){const e=n.recurrenceRuleValue.getComponent("BYMONTHDAY");-1===e.indexOf(r)&&(e.push(r),n.recurrenceRuleValue.setComponent("BYMONTHDAY",e));-1===n.byMonthDay.indexOf(r)&&n.byMonthDay.push(r),console.debug(n.recurrenceRuleValue._innerValue.toString())}},removeByMonthDayFromRecurrenceRule(e,t){let{calendarObjectInstance:a,recurrenceRule:n,byMonthDay:r}=t;if(n.recurrenceRuleValue){const e=n.recurrenceRuleValue.getComponent("BYMONTHDAY"),t=e.indexOf(r);-1!==t&&(e.splice(t,1),n.recurrenceRuleValue.setComponent("BYMONTHDAY",e));const a=n.byMonthDay.indexOf(r);-1!==a&&n.byMonthDay.splice(a,1),console.debug(n.recurrenceRuleValue._innerValue.toString())}},addByMonthToRecurrenceRule(e,t){let{calendarObjectInstance:a,recurrenceRule:n,byMonth:r}=t;if(n.recurrenceRuleValue){console.debug("addByMonthToRecurrenceRule",r);const e=n.recurrenceRuleValue.getComponent("BYMONTH");-1===e.indexOf(r)&&(e.push(r),n.recurrenceRuleValue.setComponent("BYMONTH",e));-1===n.byMonth.indexOf(r)&&n.byMonth.push(r),console.debug(n.recurrenceRuleValue._innerValue.toString())}},removeByMonthFromRecurrenceRule(e,t){let{calendarObjectInstance:a,recurrenceRule:n,byMonth:r}=t;if(n.recurrenceRuleValue){console.debug("removeByMonthFromRecurrenceRule",r);const e=n.recurrenceRuleValue.getComponent("BYMONTH"),t=e.indexOf(r);-1!==t&&(e.splice(t,1),n.recurrenceRuleValue.setComponent("BYMONTH",e));const a=n.byMonth.indexOf(r);-1!==a&&n.byMonth.splice(a,1),console.debug(n.recurrenceRuleValue._innerValue.toString())}},changeRecurrenceByDay(e,t){let{calendarObjectInstance:a,recurrenceRule:r,byDay:l}=t;r.recurrenceRuleValue&&(r.recurrenceRuleValue.setComponent("BYDAY",l),n.default.set(r,"byDay",l),console.debug(r.recurrenceRuleValue._innerValue.toString()))},changeRecurrenceBySetPosition(e,t){let{calendarObjectInstance:a,recurrenceRule:r,bySetPosition:l}=t;r.recurrenceRuleValue&&(r.recurrenceRuleValue.setComponent("BYSETPOS",[l]),n.default.set(r,"bySetPosition",l),console.debug(r.recurrenceRuleValue._innerValue.toString()))},unsetRecurrenceBySetPosition(e,t){let{calendarObjectInstance:a,recurrenceRule:r}=t;r.recurrenceRuleValue&&(r.recurrenceRuleValue.setComponent("BYSETPOS",[]),n.default.set(r,"bySetPosition",null),console.debug(r.recurrenceRuleValue._innerValue.toString()))},removeRecurrenceRuleFromCalendarObjectInstance(e,t){let{calendarObjectInstance:a,recurrenceRule:r}=t;r.recurrenceRuleValue&&(a.eventComponent.deleteAllProperties("RRULE"),n.default.set(a,"recurrenceRule",(0,s._F)().recurrenceRule),console.debug(a),console.debug(r))},addRecurrenceRuleFromCalendarObjectInstance(e,t){let{calendarObjectInstance:a}=t;const n=o.Ze.fromData({}),r=new o.Z9("RRULE",n);a.eventComponent.addProperty(r),a.recurrenceRule.recurrenceRuleValue=n},markRecurrenceRuleAsSupported(e,t){let{calendarObjectInstance:a,recurrenceRule:n}=t;n.isUnsupported=!1},changeAlarmType(e,t){let{calendarObjectInstance:a,alarm:n,type:r}=t;n.alarmComponent&&(n.alarmComponent.action=r,n.type=r,console.debug(n.alarmComponent.toICALJs().toString()))},changeAlarmAmountTimed(e,t){let{calendarObjectInstance:a,alarm:n,amount:r}=t;n.alarmComponent&&(n.alarmComponent.trigger.value.totalSeconds=(0,d.IP)(r,n.relativeUnitTimed,n.relativeIsBefore),n.relativeAmountTimed=r,n.relativeTrigger=n.alarmComponent.trigger.value.totalSeconds,console.debug(n.alarmComponent.toICALJs().toString()))},changeAlarmUnitTimed(e,t){let{calendarObjectInstance:a,alarm:n,unit:r}=t;n.alarmComponent&&(n.alarmComponent.trigger.value.totalSeconds=(0,d.IP)(n.relativeAmountTimed,r,n.relativeIsBefore),n.relativeUnitTimed=r,n.relativeTrigger=n.alarmComponent.trigger.value.totalSeconds,console.debug(n.alarmComponent.toICALJs().toString()))},changeAlarmAmountAllDay(e,t){let{calendarObjectInstance:a,alarm:n,amount:r}=t;n.alarmComponent&&(n.alarmComponent.trigger.value.totalSeconds=(0,d.mV)(r,n.relativeHoursAllDay,n.relativeMinutesAllDay,n.relativeUnitAllDay),n.relativeAmountAllDay=r,n.relativeTrigger=n.alarmComponent.trigger.value.totalSeconds,console.debug(n.alarmComponent.toICALJs().toString()))},changeAlarmUnitAllDay(e,t){let{calendarObjectInstance:a,alarm:n,unit:r}=t;n.alarmComponent&&(n.alarmComponent.trigger.value.totalSeconds=(0,d.mV)(n.relativeAmountAllDay,n.relativeHoursAllDay,n.relativeMinutesAllDay,r),n.relativeUnitAllDay=r,n.relativeTrigger=n.alarmComponent.trigger.value.totalSeconds,console.debug(n.alarmComponent.toICALJs().toString()))},changeAlarmHoursMinutesAllDay(e,t){let{calendarObjectInstance:a,alarm:n,hours:r,minutes:l}=t;n.alarmComponent&&(n.alarmComponent.trigger.value.totalSeconds=(0,d.mV)(n.relativeAmountAllDay,r,l,n.relativeUnitAllDay),n.relativeHoursAllDay=r,n.relativeMinutesAllDay=l,n.relativeTrigger=n.alarmComponent.trigger.value.totalSeconds,console.debug(n.alarmComponent.toICALJs().toString()))},changeAlarmAbsoluteDate(e,t){let{calendarObjectInstance:a,alarm:n,date:r}=t;n.alarmComponent&&(n.alarmComponent.trigger.value.year=r.getFullYear(),n.alarmComponent.trigger.value.month=r.getMonth()+1,n.alarmComponent.trigger.value.day=r.getDate(),n.alarmComponent.trigger.value.hour=r.getHours(),n.alarmComponent.trigger.value.minute=r.getMinutes(),n.alarmComponent.trigger.value.second=0,n.absoluteDate=r,console.debug(n.alarmComponent.toICALJs().toString()))},changeAlarmAbsoluteTimezoneId(e,t){let{calendarObjectInstance:a,alarm:n,timezoneId:l}=t;if(n.alarmComponent){const e=(0,r.Z)().getTimezoneForId(l);n.alarmComponent.trigger.value.replaceTimezone(e),n.absoluteTimezoneId=l,console.debug(n.alarmComponent.toICALJs().toString())}},changeAlarmFromRelativeToAbsolute(e,t){let{calendarObjectInstance:a,alarm:n}=t;if(n.alarmComponent){const e=a.eventComponent.startDate.clone();e.isDate=!1,e.addDuration(n.alarmComponent.trigger.value),n.alarmComponent.setTriggerFromAbsolute(e),n.absoluteDate=(0,l.nZ)(n.alarmComponent.trigger.value),n.absoluteTimezoneId=n.alarmComponent.trigger.value.timezoneId,console.debug(n.alarmComponent.toICALJs().toString())}},changeAlarmFromAbsoluteToRelative(e,t){let{calendarObjectInstance:a,alarm:n}=t;if(n.alarmComponent){const e=n.alarmComponent.trigger.value.subtractDateWithTimezone(a.eventComponent.startDate);n.alarmComponent.setTriggerFromRelative(e),n.relativeIsBefore=n.alarmComponent.trigger.value.isNegative,n.relativeIsRelatedToStart=!0,n.relativeTrigger=e.totalSeconds}},resetAlarmRelativeParts(e,t){let{alarm:a}=t;a.relativeIsBefore=null,a.relativeIsRelatedToStart=null,a.relativeUnitTimed=null,a.relativeAmountTimed=null,a.relativeUnitAllDay=null,a.relativeAmountAllDay=null,a.relativeHoursAllDay=null,a.relativeMinutesAllDay=null,a.relativeTrigger=null},resetAlarmAbsoluteParts(e,t){let{alarm:a}=t;a.absoluteDate=null,a.absoluteTimezoneId=null},updateAlarmAllDayParts(e,t){let{calendarObjectInstance:a,alarm:n}=t;if(n.alarmComponent){const e=n.alarmComponent.trigger.value.totalSeconds,t=(0,d.cB)(e);n.relativeUnitAllDay=t.unit,n.relativeAmountAllDay=t.amount,n.relativeHoursAllDay=t.hours,n.relativeMinutesAllDay=t.minutes}},updateAlarmTimedParts(e,t){let{calendarObjectInstance:a,alarm:n}=t;if(n.alarmComponent){const e=n.alarmComponent.trigger.value.totalSeconds,t=(0,d.Yg)(e);n.relativeUnitTimed=t.unit,n.relativeAmountTimed=t.amount,console.debug(n.alarmComponent.toICALJs().toString())}},addAlarmToCalendarObjectInstance(e,t){let{calendarObjectInstance:a,type:n,totalSeconds:r}=t;if(a.eventComponent){const e=a.eventComponent,t=o.iM.fromSeconds(r),l=e.addRelativeAlarm(n,t),c=(0,u.P)(l);a.alarms.push(c),console.debug(c.alarmComponent.toICALJs().toString())}},removeAlarmFromCalendarObjectInstance(e,t){let{calendarObjectInstance:a,alarm:n}=t;if(n.alarmComponent){a.eventComponent.removeAlarm(n.alarmComponent);const e=a.alarms.indexOf(n);-1!==e&&a.alarms.splice(e,1)}},addAttachmentBySharedData(e,t){let{calendarObjectInstance:a,sharedData:n}=t;const r=o.gj.fromLink(n.url),l=n.fileName,c=new o.d2("FILENAME",l),s=new o.d2("X-NC-HAS-PREVIEW",n["has-preview"].toString()),d=new o.d2("X-NC-FILE-ID",n.fileid.toString()),i=new o.d2("X-NC-SHARED-TYPES",n["share-types"]["share-type"]?n["share-types"]["share-type"].join(","):"");r.setParameter(c),r.setParameter(d),r.setParameter(s),r.setParameter(i),r.isNew=!0,r.shareTypes=n["share-types"]["share-type"]?n["share-types"]["share-type"].join(","):"",r.fileName=l,r.xNcFileId=n.fileid,r.xNcHasPreview=n["has-preview"],r.formatType=n.getcontenttype,r.uri=n.url?n.url:(0,h.generateUrl)(`/f/${n.fileid}`),a.eventComponent.addProperty(r),a.attachments.push(r)},addAttachmentWithProperty(e,t){let{calendarObjectInstance:a,sharedData:n}=t;const r={},l=n.fileName;r.isNew=!0,r.shareTypes=("number"==typeof n?.["share-types"]?.["share-type"]?n?.["share-types"]?.["share-type"]?.toString():n?.["share-types"]?.["share-type"]?.join(","))??null,r.fileName=l,r.xNcFileId=n.fileid,r.xNcHasPreview=n["has-preview"],r.formatType=n.getcontenttype,r.uri=n.url?n.url:(0,h.generateUrl)(`/f/${n.fileid}`);const c=o.gj.fromLink(r.uri,r.formatType),s=new o.d2("FILENAME",l),d=new o.d2("X-NC-HAS-PREVIEW",r.xNcHasPreview.toString()),i=new o.d2("X-NC-FILE-ID",r.xNcFileId.toString());if(null!==r.shareTypes){const e=new o.d2("X-NC-SHARED-TYPES",r.shareTypes);c.setParameter(e)}c.setParameter(s),c.setParameter(i),c.setParameter(d),c.uri=r.uri,r.attachmentProperty=c,a.eventComponent.addProperty(c),a.attachments.push(r)},deleteAttachment(e,t){let{calendarObjectInstance:a,attachment:n}=t;try{const e=a.attachments.indexOf(n);-1!==e&&a.attachments.splice(e,1),a.eventComponent.removeAttachment(n.attachmentProperty)}catch{}}},y={async resolveClosestRecurrenceIdForCalendarObject(e,t){let{state:a,dispatch:n,commit:r}=e,{objectId:l,closeToDate:c}=t;const s=(await n("getEventByObjectId",{objectId:l})).calendarComponent.getVObjectIterator().next().value,d=o.ul.fromJSDate(c,!0);return s.recurrenceManager.getClosestOccurrence(d).getReferenceRecurrenceId().unixTime},async getCalendarObjectInstanceByObjectIdAndRecurrenceId(e,t){let{state:a,dispatch:n,commit:r}=e,{objectId:l,recurrenceId:o}=t;if(a.existingEvent.objectId===l&&a.existingEvent.recurrenceId===o)return Promise.resolve({calendarObject:a.calendarObject,calendarObjectInstance:a.calendarObjectInstance});const c=new Date(1e3*o),d=await n("getEventByObjectId",{objectId:l}),i=(0,m.f)(d,c);if(null===i)throw new Error("Not a valid recurrence-id");const u=(0,s.QX)(i);return r("setCalendarObjectInstanceForExistingEvent",{calendarObject:d,calendarObjectInstance:u,objectId:l,recurrenceId:o}),{calendarObject:d,calendarObjectInstance:u}},async getCalendarObjectInstanceForNewEvent(e,t){let{state:a,dispatch:n,commit:r}=e,{isAllDay:l,start:o,end:c,timezoneId:d}=t;if(!0===a.isNew)return Promise.resolve({calendarObject:a.calendarObject,calendarObjectInstance:a.calendarObjectInstance});const i=await n("createNewEvent",{start:o,end:c,isAllDay:l,timezoneId:d}),u=new Date(1e3*o),h=(0,m.f)(i,u),f=(0,s.QX)(h),_=parseInt(g.Z.state.defaultReminder);isNaN(_)||(r("addAlarmToCalendarObjectInstance",{calendarObjectInstance:f,type:"DISPLAY",totalSeconds:_}),p.ZP.debug(`Added defaultReminder (${_}s) to newly created event`));return r("changeStatus",{calendarObjectInstance:f,status:(0,b.w)().status.defaultValue}),r("setCalendarObjectInstanceForNewEvent",{calendarObject:i,calendarObjectInstance:f}),{calendarObject:i,calendarObjectInstance:f}},async updateCalendarObjectInstanceForNewEvent(e,t){let{state:a,dispatch:n,commit:r}=e,{isAllDay:l,start:o,end:c,timezoneId:s}=t;return await n("updateTimeOfNewEvent",{calendarObjectInstance:a.calendarObjectInstance,start:o,end:c,isAllDay:l,timezoneId:s}),r("setCalendarObjectInstanceForNewEvent",{calendarObject:a.calendarObject,calendarObjectInstance:a.calendarObjectInstance}),{calendarObject:a.calendarObject,calendarObjectInstance:a.calendarObjectInstance}},async saveCalendarObjectInstance(e,t){let{state:a,dispatch:n,commit:r}=e,{thisAndAllFuture:l,calendarId:o}=t;const c=a.calendarObjectInstance.eventComponent,s=a.calendarObject;if((0,d.oG)(c),(0,f.jv)(c),c.isDirty()){let e=null,t=null;null!==c.primaryItem&&c.canCreateRecurrenceExceptions()&&([e,t]=c.createRecurrenceException(l)),await n("updateCalendarObject",{calendarObject:s}),null!==e&&null!==t&&e.root!==t.root&&await n("createCalendarObjectFromFork",{eventComponent:t,calendarId:o})}o!==a.calendarObject.calendarId&&await n("moveCalendarObject",{calendarObject:s,newCalendarId:o})},async duplicateCalendarObjectInstance(e){let{state:t,dispatch:a,commit:n}=e;const r=t.calendarObjectInstance,l=r.eventComponent,o=l.startDate.getInUTC(),c=l.endDate.getInUTC(),d=await a("createNewEvent",{start:o.unixTime,end:c.unixTime,timezoneId:l.startDate.timezoneId,isAllDay:l.isAllDay()}),i=(0,m.f)(d,o.jsDate);(0,s.H4)(r,i);const u=(0,s.QX)(i);await n("setCalendarObjectInstanceForNewEvent",{calendarObject:d,calendarObjectInstance:u})},async deleteCalendarObjectInstance(e,t){let{state:a,dispatch:n,commit:r}=e,{thisAndAllFuture:l}=t;const o=a.calendarObjectInstance.eventComponent.removeThisOccurrence(l),c=a.calendarObject;o?await n("deleteCalendarObject",{calendarObject:c}):await n("updateCalendarObject",{calendarObject:c})},changeStartDate(e,t){let{commit:a}=e,{calendarObjectInstance:n,startDate:r}=t;const l=r.getTime()-n.startDate.getTime(),o=new Date(n.endDate.getTime()+l);a("changeStartDate",{calendarObjectInstance:n,startDate:r}),a("changeEndDate",{calendarObjectInstance:n,endDate:o})},changeStartTimezone(e,t){let{commit:a}=e,{calendarObjectInstance:n,startTimezone:r}=t;a("changeStartTimezone",{calendarObjectInstance:n,startTimezone:r}),a("changeStartDate",{calendarObjectInstance:n,startDate:n.startDate})},changeEndTimezone(e,t){let{commit:a}=e,{calendarObjectInstance:n,endTimezone:r}=t;a("changeEndTimezone",{calendarObjectInstance:n,endTimezone:r}),a("changeEndDate",{calendarObjectInstance:n,endDate:n.endDate})},changeRecurrenceFrequency(e,t){let{commit:a,dispatch:n}=e,{calendarObjectInstance:r,recurrenceRule:l,frequency:o}=t;console.debug(r),console.debug(l),console.debug(o),"NONE"===l.frequency&&"NONE"!==o?(a("addRecurrenceRuleFromCalendarObjectInstance",{calendarObjectInstance:r}),a("resetRecurrenceByParts",{calendarObjectInstance:r,recurrenceRule:l}),a("changeRecurrenceFrequency",{calendarObjectInstance:r,recurrenceRule:r.recurrenceRule,frequency:o}),a("changeRecurrenceInterval",{calendarObjectInstance:r,recurrenceRule:r.recurrenceRule,interval:1}),a("changeRecurrenceToInfinite",{calendarObjectInstance:r,recurrenceRule:r.recurrenceRule}),n("setDefaultRecurrenceByParts",{calendarObjectInstance:r,recurrenceRule:l,frequency:o}),console.debug(`changed from none to ${o}`)):"NONE"!==l.frequency&&"NONE"===o?(console.debug("calling removeRecurrenceRuleFromCalendarObjectInstance"),a("removeRecurrenceRuleFromCalendarObjectInstance",{calendarObjectInstance:r,recurrenceRule:l})):(a("resetRecurrenceByParts",{calendarObjectInstance:r,recurrenceRule:l}),a("changeRecurrenceFrequency",{calendarObjectInstance:r,recurrenceRule:r.recurrenceRule,frequency:o}),n("setDefaultRecurrenceByParts",{calendarObjectInstance:r,recurrenceRule:l,frequency:o}))},setDefaultRecurrenceByParts(e,t){let{commit:a}=e,{calendarObjectInstance:n,recurrenceRule:r,frequency:l}=t;switch(l){case"WEEKLY":a("setDefaultRecurrenceByPartsForWeekly",{calendarObjectInstance:n,recurrenceRule:r});break;case"MONTHLY":a("setDefaultRecurrenceByPartsForMonthly",{calendarObjectInstance:n,recurrenceRule:r});break;case"YEARLY":a("setDefaultRecurrenceByPartsForYearly",{calendarObjectInstance:n,recurrenceRule:r})}},setRecurrenceToInfinite(e,t){let{commit:a}=e,{calendarObjectInstance:n,recurrenceRule:r}=t;a("changeRecurrenceToInfinite",{calendarObjectInstance:n,recurrenceRule:r})},changeMonthlyRecurrenceFromByDayToBySetPosition(e,t){let{commit:a}=e,{calendarObjectInstance:n,recurrenceRule:r}=t;console.debug("changeMonthlyRecurrenceFromByDayToBySetPosition"),a("resetRecurrenceByParts",{calendarObjectInstance:n,recurrenceRule:r}),a("setDefaultRecurrenceByPartsForMonthlyBySetPosition",{calendarObjectInstance:n,recurrenceRule:r})},changeMonthlyRecurrenceFromBySetPositionToByDay(e,t){let{commit:a}=e,{calendarObjectInstance:n,recurrenceRule:r}=t;console.debug("changeMonthlyRecurrenceFromBySetPositionToByDay"),a("resetRecurrenceByParts",{calendarObjectInstance:n,recurrenceRule:r}),a("setDefaultRecurrenceByPartsForMonthly",{calendarObjectInstance:n,recurrenceRule:r})},enableYearlyRecurrenceBySetPosition(e,t){let{commit:a}=e,{calendarObjectInstance:n,recurrenceRule:r}=t;a("setDefaultRecurrenceByPartsForMonthlyBySetPosition",{calendarObjectInstance:n,recurrenceRule:r})},disableYearlyRecurrenceBySetPosition(e,t){let{commit:a}=e,{calendarObjectInstance:n,recurrenceRule:r}=t;a("changeRecurrenceByDay",{calendarObjectInstance:n,recurrenceRule:r,byDay:[]}),a("unsetRecurrenceBySetPosition",{calendarObjectInstance:n,recurrenceRule:r})},enableRecurrenceLimitByUntil(e,t){let a,{commit:n}=e,{calendarObjectInstance:r,recurrenceRule:l}=t;switch(l.frequency){case"DAILY":a=new Date(r.startDate.getTime()+6048e5);break;case"WEEKLY":a=new Date(r.startDate.getTime()+24192e5);break;case"YEARLY":a=new Date(r.startDate.getFullYear()+10,r.startDate.getMonth(),r.startDate.getDate(),23,59,59);break;default:a=new Date(r.startDate.getFullYear()+1,r.startDate.getMonth(),r.startDate.getDate(),23,59,59)}n("changeRecurrenceToInfinite",{calendarObjectInstance:r,recurrenceRule:l}),n("changeRecurrenceUntil",{calendarObjectInstance:r,recurrenceRule:l,until:a})},enableRecurrenceLimitByCount(e,t){let{commit:a}=e,{calendarObjectInstance:n,recurrenceRule:r}=t;a("changeRecurrenceToInfinite",{calendarObjectInstance:n,recurrenceRule:r}),a("changeRecurrenceCount",{calendarObjectInstance:n,recurrenceRule:r,count:2})},changeAlarmAmountTimed(e,t){let{commit:a}=e,{calendarObjectInstance:n,alarm:r,amount:l}=t;a("changeAlarmAmountTimed",{calendarObjectInstance:n,alarm:r,amount:l}),a("updateAlarmAllDayParts",{calendarObjectInstance:n,alarm:r})},changeAlarmUnitTimed(e,t){let{commit:a}=e,{calendarObjectInstance:n,alarm:r,unit:l}=t;a("changeAlarmUnitTimed",{calendarObjectInstance:n,alarm:r,unit:l}),a("updateAlarmAllDayParts",{calendarObjectInstance:n,alarm:r})},changeAlarmAmountAllDay(e,t){let{commit:a}=e,{calendarObjectInstance:n,alarm:r,amount:l}=t;a("changeAlarmAmountAllDay",{calendarObjectInstance:n,alarm:r,amount:l}),a("updateAlarmTimedParts",{calendarObjectInstance:n,alarm:r})},changeAlarmUnitAllDay(e,t){let{commit:a}=e,{calendarObjectInstance:n,alarm:r,unit:l}=t;a("changeAlarmUnitAllDay",{calendarObjectInstance:n,alarm:r,unit:l}),a("updateAlarmTimedParts",{calendarObjectInstance:n,alarm:r})},changeAlarmHoursMinutesAllDay(e,t){let{commit:a}=e,{calendarObjectInstance:n,alarm:r,hours:l,minutes:o}=t;a("changeAlarmHoursMinutesAllDay",{calendarObjectInstance:n,alarm:r,hours:l,minutes:o}),a("updateAlarmTimedParts",{calendarObjectInstance:n,alarm:r})},changeAlarmFromRelativeToAbsolute(e,t){let{commit:a}=e,{calendarObjectInstance:n,alarm:r}=t;a("changeAlarmFromRelativeToAbsolute",{calendarObjectInstance:n,alarm:r}),a("resetAlarmRelativeParts",{alarm:r})},changeAlarmFromAbsoluteToRelative(e,t){let{commit:a}=e,{calendarObjectInstance:n,alarm:r}=t;a("changeAlarmFromAbsoluteToRelative",{calendarObjectInstance:n,alarm:r}),a("updateAlarmAllDayParts",{calendarObjectInstance:n,alarm:r}),a("updateAlarmTimedParts",{calendarObjectInstance:n,alarm:r}),a("resetAlarmAbsoluteParts",{alarm:r})},toggleAllDay(e,t){let{commit:a,getters:n}=e,{calendarObjectInstance:r}=t;if(a("toggleAllDay",{calendarObjectInstance:r}),!r.isAllDay){if("floating"===r.startTimezoneId){a("changeStartTimezone",{calendarObjectInstance:r,startTimezone:n.getResolvedTimezone})}a("changeTimeToDefaultForTimedEvents",{calendarObjectInstance:r})}}},j={state:{isNew:null,calendarObject:null,calendarObjectInstance:null,existingEvent:{objectId:null,recurrenceId:null}},mutations:_,getters:{},actions:y}},83e3:(e,t,a)=>{"use strict";a.d(t,{Z:()=>s});var n=a(20144),r=a(96690),l=a(75357),o=a(32066);const c={appendCalendarObjects(e,t){let{calendarObjects:a=[]}=t;for(const t of a)e.calendarObjects[t.id]||n.default.set(e.calendarObjects,t.id,t)},appendCalendarObject(e,t){let{calendarObject:a}=t;e.calendarObjects[a.id]||n.default.set(e.calendarObjects,a.id,a)},updateCalendarObjectId(e,t){let{calendarObject:a}=t;null===a.dav?a.id=null:a.id=btoa(a.dav.url)},updateCalendarObjectIdCalendarId(e,t){let{calendarObjectId:a,calendarId:n}=t;e.calendarObjects[a].calendarId=n},resetCalendarObjectToDav(e,t){let{calendarObject:a}=t;if(a=e.calendarObjects[a.id],!a||!a.existsOnServer)return;const n=(0,o.wJ)().getParserForFileType("text/calendar");n.parse(a.dav.data);const r=n.getItemIterator().next().value;r&&(a.calendarComponent=r)},deleteCalendarObject(e,t){let{calendarObject:a}=t;n.default.delete(e.calendarObjects,a.id)},incrementModificationCount(e){e.modificationCount++}},s={state:{calendarObjects:{},modificationCount:0},mutations:c,getters:{getCalendarObjectById:e=>t=>e.calendarObjects[t]},actions:{async moveCalendarObject(e,t){let{calendarObject:a,newCalendarId:n}=t;if(!a.existsOnServer)return;const r=a.id,o=a.calendarId;if(o===n)return void l.ZP.error("Old calendar Id and new calendar Id are the same, nothing to move");const c=e.getters.getCalendarById(n);c?(await a.dav.move(c.dav),e.commit("updateCalendarObjectIdCalendarId",{calendarObjectId:a.id,calendarId:n}),e.commit("addCalendarObjectToCalendar",{calendar:{id:n},calendarObjectId:a.id}),e.commit("addCalendarObjectIdToAllTimeRangesOfCalendar",{calendarId:n,calendarObjectId:a.id}),e.commit("deleteCalendarObjectFromCalendar",{calendar:{id:o},calendarObjectId:r}),e.commit("removeCalendarObjectIdFromAllTimeRangesOfCalendar",{calendarId:o,calendarObjectId:r}),e.commit("incrementModificationCount")):l.ZP.error("Calendar to move to not found, aborting")},async updateCalendarObject(e,t){let{calendarObject:a}=t;if(a.existsOnServer)return a.dav.data=a.calendarComponent.toICS(),await a.dav.update(),e.commit("addCalendarObjectIdToAllTimeRangesOfCalendar",{calendarId:a.calendarId,calendarObjectId:a.id}),void e.commit("incrementModificationCount");const n=e.getters.getCalendarById(a.calendarId);a.dav=await n.dav.createVObject(a.calendarComponent.toICS()),a.existsOnServer=!0,e.commit("updateCalendarObjectId",{calendarObject:a}),e.commit("appendCalendarObject",{calendarObject:a}),e.commit("addCalendarObjectToCalendar",{calendar:{id:a.calendarId},calendarObjectId:a.id}),e.commit("addCalendarObjectIdToAllTimeRangesOfCalendar",{calendarId:a.calendarId,calendarObjectId:a.id}),e.commit("resetCalendarObjectToDav",{calendarObject:a}),e.commit("incrementModificationCount")},async createCalendarObjectFromFork(e,t){let{eventComponent:a,calendarId:n}=t;const l=e.getters.getCalendarById(n),o=(0,r.Vw)(a.root,l.id);o.dav=await l.dav.createVObject(o.calendarComponent.toICS()),o.existsOnServer=!0,e.commit("updateCalendarObjectId",{calendarObject:o}),e.commit("appendCalendarObject",{calendarObject:o}),e.commit("addCalendarObjectToCalendar",{calendar:{id:o.calendarId},calendarObjectId:o.id}),e.commit("addCalendarObjectIdToAllTimeRangesOfCalendar",{calendarId:l.id,calendarObjectId:o.id}),e.commit("incrementModificationCount")},async deleteCalendarObject(e,t){let{calendarObject:a}=t;a.existsOnServer&&await a.dav.delete(),e.commit("deleteCalendarObject",{calendarObject:a}),e.commit("deleteCalendarObjectFromCalendar",{calendar:{id:a.calendarId},calendarObjectId:a.id}),e.commit("removeCalendarObjectIdFromAnyTimeRange",{calendarObjectId:a.id}),e.commit("incrementModificationCount")},createNewEvent(e,t){let{start:a,end:n,timezoneId:l,isAllDay:c}=t;const s=(0,o.ko)().getTimezoneForId(l),d=new Date(1e3*a),i=new Date(1e3*n),u=o.ul.fromJSDate(d,!0).getInTimezone(s),m=o.ul.fromJSDate(i,!0).getInTimezone(s);c&&(u.isDate=!0,m.isDate=!0);const p=(0,o.yM)(u,m);for(const e of p.getVObjectIterator())e.undirtify();const g=e.getters.sortedCalendars[0].id;return Promise.resolve((0,r.Vw)(p,g))},updateTimeOfNewEvent(e,t){let{commit:a,dispatch:n}=e,{calendarObjectInstance:r,start:l,end:o,timezoneId:c,isAllDay:s}=t;const d=r.eventComponent.isDirty(),i=new Date(1e3*l),u=new Date(1e3*o);r.isAllDay!==s&&a("toggleAllDay",{calendarObjectInstance:r}),n("changeStartTimezone",{calendarObjectInstance:r,startTimezone:c}),n("changeEndTimezone",{calendarObjectInstance:r,endTimezone:c}),a("changeStartDate",{calendarObjectInstance:r,startDate:i}),a("changeEndDate",s?{calendarObjectInstance:r,endDate:new Date(u.getTime()-864e5)}:{calendarObjectInstance:r,endDate:u}),d||r.eventComponent.undirtify()}}}},77800:(e,t,a)=>{"use strict";a.d(t,{Z:()=>_});var n=a(20144),r=a(2323),l=a(96690),o=a(15558),c=a(37494),s=a(98448),d=a(62768),i=a(31352),u=a(54782),m=a(32066),p=a(59055),g=a(64024);const b={addCalendar(e,t){let{calendar:a}=t;const r=(0,c.J)(a);e.calendars.some((e=>e.id===r.id))||e.calendars.push(r),n.default.set(e.calendarsById,r.id,r)},addTrashBin(e,t){let{trashBin:a}=t;e.trashBin=a},addScheduleInbox(e,t){let{scheduleInbox:a}=t;e.scheduleInbox=a},addDeletedCalendar(e,t){let{calendar:a}=t;e.deletedCalendars.some((e=>e.url===a.url))||e.deletedCalendars.push(a)},removeDeletedCalendar(e,t){let{calendar:a}=t;e.deletedCalendars=e.deletedCalendars.filter((e=>e!==a))},removeDeletedCalendarObject(e,t){let{vobject:a}=t;e.deletedCalendarObjects=e.deletedCalendarObjects.filter((e=>e.id!==a.id))},addDeletedCalendarObject(e,t){let{vobject:a}=t;e.deletedCalendarObjects.some((e=>e.uri===a.uri))||e.deletedCalendarObjects.push(a)},deleteCalendar(e,t){let{calendar:a}=t;e.calendars.splice(e.calendars.indexOf(a),1),n.default.delete(e.calendarsById,a.id)},toggleCalendarEnabled(e,t){let{calendar:a}=t;e.calendarsById[a.id].enabled=!e.calendarsById[a.id].enabled},renameCalendar(e,t){let{calendar:a,newName:n}=t;e.calendarsById[a.id].displayName=n},changeCalendarColor(e,t){let{calendar:a,newColor:n}=t;e.calendarsById[a.id].color=n},changeCalendarOrder(e,t){let{calendar:a,newOrder:n}=t;e.calendarsById[a.id].order=n},appendCalendarObjectsToCalendar(e,t){let{calendar:a,calendarObjectIds:n}=t;for(const t of n)-1===e.calendarsById[a.id].calendarObjects.indexOf(t)&&e.calendarsById[a.id].calendarObjects.push(t)},addCalendarObjectToCalendar(e,t){let{calendar:a,calendarObjectId:n}=t;-1===e.calendarsById[a.id].calendarObjects.indexOf(n)&&e.calendarsById[a.id].calendarObjects.push(n)},deleteCalendarObjectFromCalendar(e,t){let{calendar:a,calendarObjectId:n}=t;const r=e.calendarsById[a.id].calendarObjects.indexOf(n);-1!==r&&e.calendarsById[a.id].calendarObjects.slice(r,1)},addFetchedTimeRangeToCalendar(e,t){let{calendar:a,fetchedTimeRangeId:n}=t;e.calendarsById[a.id].fetchedTimeRanges.push(n)},deleteFetchedTimeRangeFromCalendar(e,t){let{calendar:a,fetchedTimeRangeId:n}=t;const r=e.calendarsById[a.id].fetchedTimeRanges.indexOf(n);-1!==r&&e.calendarsById[a.id].fetchedTimeRanges.slice(r,1)},shareCalendar(e,t){let{calendar:a,user:n,displayName:r,uri:l,isGroup:o,isCircle:c}=t;const s={displayName:r,id:n,writeable:!1,isGroup:o,isCircle:c,uri:l};e.calendarsById[a.id].shares.push(s)},unshareCalendar(e,t){let{calendar:a,uri:n}=t;a=e.calendars.find((e=>e.id===a.id));const r=a.shares.findIndex((e=>e.uri===n));a.shares.splice(r,1)},toggleCalendarShareWritable(e,t){let{calendar:a,uri:n}=t;a=e.calendars.find((e=>e.id===a.id));const r=a.shares.find((e=>e.uri===n));r.writeable=!r.writeable},publishCalendar(e,t){let{calendar:a,publishURL:n}=t;a=e.calendars.find((e=>e.id===a.id)),a.publishURL=n},unpublishCalendar(e,t){let{calendar:a}=t;a=e.calendars.find((e=>e.id===a.id)),a.publishURL=null},initialCalendarsLoaded(e){e.initialCalendarsLoaded=!0},markCalendarAsLoading(e,t){let{calendar:a}=t;e.calendarsById[a.id].loading=!0},markCalendarAsNotLoading(e,t){let{calendar:a}=t;e.calendarsById[a.id].loading=!1},showEditCalendarModal(e,t){let{calendarId:a}=t;e.editCalendarModal={calendarId:a}},hideEditCalendarModal(e){e.editCalendarModal=void 0},setCalendarDeleteCountdown(e,t){let{calendar:a,countdown:r}=t;n.default.set(e.calendarsById[a.id],"countdown",r)},setCalendarDeleteHandles(e,t){let{calendar:a,deleteTimeout:r,deleteInterval:l}=t;n.default.set(e.calendarsById[a.id],"deleteTimeout",r),n.default.set(e.calendarsById[a.id],"deleteInterval",l)}},h={sortedCalendarsSubscriptions:(e,t,a)=>e.calendars.filter((e=>e.supportsEvents||a.settings.showTasks&&e.supportsTasks)).sort(((e,t)=>e.order-t.order)),sortedCalendars:e=>e.calendars.filter((e=>e.supportsEvents)).filter((e=>!e.readOnly)).sort(((e,t)=>e.order-t.order)),ownSortedCalendars:e=>e.calendars.filter((e=>e.supportsEvents)).filter((e=>!e.readOnly)).filter((e=>!e.isSharedWithMe)).sort(((e,t)=>e.order-t.order)),hasTrashBin:e=>void 0!==e.trashBin&&0!==e.trashBin.retentionDuration,trashBin:e=>e.trashBin,scheduleInbox:e=>e.scheduleInbox,sortedDeletedCalendars:e=>e.deletedCalendars.sort(((e,t)=>e.deletedAt-t.deletedAt)),deletedCalendarObjects(e){const t={};return e.calendars.forEach((e=>{const a=e.url.replace(/\/$/,""),n=a.slice(a.lastIndexOf("/")+1);t[n]=e})),e.deletedCalendarObjects.map((e=>({calendar:t[e.dav._props["{http://nextcloud.com/ns}calendar-uri"]],...e})))},sortedSubscriptions:e=>e.calendars.filter((e=>e.supportsEvents)).filter((e=>e.readOnly)).sort(((e,t)=>e.order-t.order)),enabledCalendars:(e,t,a)=>e.calendars.filter((e=>e.supportsEvents||a.settings.showTasks&&e.supportsTasks)).filter((e=>e.enabled)),getCalendarById:e=>t=>e.calendarsById[t],getBirthdayCalendar:e=>{for(const t of e.calendars){const e=t.url.slice(0,-1),a=e.lastIndexOf("/");if(e.slice(a+1)===p.On)return t}return null},hasBirthdayCalendar:(e,t)=>!!t.getBirthdayCalendar,sortedCalendarFilteredByComponents:(e,t)=>(e,a,n)=>t.sortedCalendars.filter((t=>!(e&&!t.supportsEvents)&&(!(a&&!t.supportsJournals)&&!(n&&!t.supportsTasks)))),editCalendarModal:e=>e.editCalendarModal},f={async loadCollections(e){let{commit:t,state:a,getters:n}=e;const{calendars:l,trashBins:o,scheduleInboxes:s,subscriptions:d}=await(0,r.Oq)();return console.info("calendar home scanned",l,o,d),l.map((e=>(0,c.o)(e,n.getCurrentUserPrincipal))).forEach((e=>{t("addCalendar",{calendar:e})})),o.length&&t("addTrashBin",{trashBin:o[0]}),s.length&&t("addScheduleInbox",{scheduleInbox:s[0]}),t("initialCalendarsLoaded"),{calendars:a.calendars,trashBin:a.trashBin}},async loadDeletedCalendars(e){let{commit:t}=e;(await(0,r.Dz)()).forEach((e=>t("addDeletedCalendar",{calendar:e})))},async loadDeletedCalendarObjects(e){let{commit:t,state:a}=e;const n=await a.trashBin.findDeletedObjects();console.info("vobjects loaded",{vobjects:n}),n.forEach((e=>{try{const a=(0,l.un)(e,void 0);t("addDeletedCalendarObject",{vobject:a})}catch(t){console.error("could not convert calendar object",e,t)}}))},async getPublicCalendars(e,t){let{commit:a}=e,{tokens:n}=t;const l=await(0,r.S3)(n),o=[];for(const e of l){const t=(0,c.o)(e);a("addCalendar",{calendar:t}),o.push(t)}return a("initialCalendarsLoaded"),o},async appendCalendar(e,t){let{displayName:a,color:n,order:l,components:o=["VEVENT"],timezone:s=null}=t;null===s&&(s=e.getters.getResolvedTimezone);let d=null;const i=(0,u.Z)().getTimezoneForId(s);if(i!==m.ru.utc&&i!==m.ru.floating){const e=m.eV.fromEmpty();e.addComponent(m.Qy.fromICALJs(i.toICALJs())),d=e.toICS(!1)}const p=await(0,r.YR)(a,n,o,l,d),g=(0,c.o)(p,e.getters.getCurrentUserPrincipal);e.commit("addCalendar",{calendar:g})},async appendSubscription(e,t){let{displayName:a,color:n,order:l,source:o}=t;const s=await(0,r.XW)(a,n,o,l),d=(0,c.o)(s,e.getters.getCurrentUserPrincipal);e.commit("addCalendar",{calendar:d})},async deleteCalendar(e,t){let{calendar:a}=t;await a.dav.delete(),e.commit("deleteCalendar",{calendar:a})},async deleteCalendarPermanently(e,t){let{calendar:a}=t;await a.delete({"X-NC-CalDAV-No-Trashbin":1}),e.commit("removeDeletedCalendar",{calendar:a})},deleteCalendarAfterTimeout(e,t){let{calendar:a,countdown:n=7}=t;e.commit("setCalendarDeleteCountdown",{calendar:a,countdown:n});const r=setInterval((()=>{n--,n<0&&(n=0),e.commit("setCalendarDeleteCountdown",{calendar:a,countdown:n})}),1e3),l=setTimeout((async()=>{try{await e.dispatch("deleteCalendar",{calendar:a})}catch(e){(0,g.x2)((0,i.translate)("calendar","An error occurred, unable to delete the calendar.")),console.error(e)}finally{clearInterval(r)}}),7e3);e.commit("setCalendarDeleteHandles",{calendar:a,deleteInterval:r,deleteTimeout:l})},cancelCalendarDeletion(e,t){let{calendar:a}=t;a.deleteInterval&&clearInterval(a.deleteInterval),a.deleteTimeout&&clearTimeout(a.deleteTimeout),e.commit("setCalendarDeleteHandles",{calendar:a,deleteInterval:void 0,deleteTimeout:void 0})},async restoreCalendar(e,t){let{commit:a,state:n}=e,{calendar:r}=t;await n.trashBin.restore(r.url),a("removeDeletedCalendar",{calendar:r})},async restoreCalendarObject(e,t){let{commit:a,state:n,getters:r}=e,{vobject:o}=t;await n.trashBin.restore(o.uri),a("removeDeletedCalendarObject",{vobject:o});const c=(0,l.un)(o.dav,void 0).calendarComponent.getFirstComponent(o.objectType),s=r.getTimeRangeForCalendarCoveringRange(o.calendar.id,c.startDate?.unixTime,c.endDate?.unixTime);s&&(a("deleteFetchedTimeRangeFromCalendar",{calendar:o.calendar,fetchedTimeRangeId:s.id}),a("removeTimeRange",{timeRangeId:s.id})),a("incrementModificationCount")},async deleteCalendarObjectPermanently(e,t){let{vobject:a}=t;await a.dav.delete({"X-NC-CalDAV-No-Trashbin":1}),e.commit("removeDeletedCalendarObject",{vobject:a})},async toggleCalendarEnabled(e,t){let{calendar:a}=t;e.commit("markCalendarAsLoading",{calendar:a}),a.dav.enabled=!a.dav.enabled;try{await a.dav.update(),e.commit("markCalendarAsNotLoading",{calendar:a}),e.commit("toggleCalendarEnabled",{calendar:a})}catch(t){throw e.commit("markCalendarAsNotLoading",{calendar:a}),t}},async renameCalendar(e,t){let{calendar:a,newName:n}=t;a.dav.displayname=n,await a.dav.update(),e.commit("renameCalendar",{calendar:a,newName:n})},async changeCalendarColor(e,t){let{calendar:a,newColor:n}=t;a.dav.color=n,await a.dav.update(),e.commit("changeCalendarColor",{calendar:a,newColor:n})},async shareCalendar(e,t){let{calendar:a,user:n,displayName:r,uri:l,isGroup:o,isCircle:c}=t;await a.dav.share(l),e.commit("shareCalendar",{calendar:a,user:n,displayName:r,uri:l,isGroup:o,isCircle:c})},async toggleCalendarShareWritable(e,t){let{calendar:a,uri:n}=t;const r=a.shares.find((e=>e.uri===n));await a.dav.share(n,!r.writeable),e.commit("toggleCalendarShareWritable",{calendar:a,uri:n})},async unshareCalendar(e,t){let{calendar:a,uri:n}=t;await a.dav.unshare(n),e.commit("unshareCalendar",{calendar:a,uri:n})},async publishCalendar(e,t){let{calendar:a}=t;await a.dav.publish();const n=a.dav.publishURL;e.commit("publishCalendar",{calendar:a,publishURL:n})},async unpublishCalendar(e,t){let{calendar:a}=t;await a.dav.unpublish(),e.commit("unpublishCalendar",{calendar:a})},async getEventsFromCalendarInTimeRange(e,t){let{calendar:a,from:n,to:r}=t;e.commit("markCalendarAsLoading",{calendar:a});const c=await a.dav.findByTypeInTimeRange("VEVENT",n,r);let s=[];e.rootState.settings.showTasks&&(s=await a.dav.findByTypeInTimeRange("VTODO",n,r)),e.commit("addTimeRange",{calendarId:a.id,from:(0,o._6)(n),to:(0,o._6)(r),lastFetched:(0,o._6)((0,o.n8)()),calendarObjectIds:[]});const d=e.getters.getLastTimeRangeInsertId;e.commit("addFetchedTimeRangeToCalendar",{calendar:a,fetchedTimeRangeId:d});const i=[],u=[];for(const e of c.concat(s))try{const t=(0,l.un)(e,a.id);i.push(t),u.push(t.id)}catch(t){console.error(`could not convert calendar object of calendar ${a.id}`,t,{response:e})}return e.commit("appendCalendarObjects",{calendarObjects:i}),e.commit("appendCalendarObjectsToCalendar",{calendar:a,calendarObjectIds:u}),e.commit("appendCalendarObjectIdsToTimeFrame",{timeRangeId:d,calendarObjectIds:u}),e.commit("markCalendarAsNotLoading",{calendar:a}),e.rootState.fetchedTimeRanges.lastTimeRangeInsertId},async getEventByObjectId(e,t){let{objectId:a}=t;if(e.getters.getCalendarObjectById(a))return Promise.resolve(e.getters.getCalendarObjectById(a));const n=atob(a),r=n.lastIndexOf("/"),o=n.slice(0,r+1),c=n.slice(r+1),s=btoa(o);if(!e.state.calendarsById[s])return Promise.reject(new Error(""));const d=e.state.calendarsById[s],i=await d.dav.find(c),u=(0,l.un)(i,d.id);return e.commit("appendCalendarObject",{calendarObject:u}),e.commit("addCalendarObjectToCalendar",{calendar:{id:s},calendarObjectId:u.id}),u},async importEventsIntoCalendar(e){e.commit("changeStage",p.EI);const t=e.rootState.importFiles.importFiles.slice();let a=0;for(const n of t){a+=n.parser.getItemCount();if("new"===e.rootState.importFiles.importCalendarRelation[n.id]){const t=n.parser.getName()||(0,i.translate)("calendar","Imported {filename}",{filename:n.name}),a=n.parser.getColor()||(0,d.ny)(t),l=[];n.parser.containsVEvents()&&l.push("VEVENT"),n.parser.containsVJournals()&&l.push("VJOURNAL"),n.parser.containsVTodos()&&l.push("VTODO");const o=await(0,r.YR)(t,a,l,0),s=(0,c.o)(o,e.getters.getCurrentUserPrincipal);e.commit("addCalendar",{calendar:s}),e.commit("setCalendarForFileId",{fileId:n.id,calendarId:s.id})}}e.commit("setTotal",a);const n=(0,s.Z)(3),o=[];for(const a of t){const t=e.rootState.importFiles.importCalendarRelation[a.id],r=e.getters.getCalendarById(t);for(const c of a.parser.getItemIterator())o.push(n((async()=>{const a=c.toICS();let n;try{n=await r.dav.createVObject(a)}catch(t){return e.commit("incrementDenied"),void console.error(t)}const o=(0,l.un)(n,t);e.commit("appendCalendarObject",{calendarObject:o}),e.commit("addCalendarObjectToCalendar",{calendar:r,calendarObjectId:o.id}),e.commit("addCalendarObjectIdToAllTimeRangesOfCalendar",{calendarId:r.id,calendarObjectId:o.id}),e.commit("incrementAccepted")})))}await Promise.all(o),e.commit("changeStage",p.bL)},async updateCalendarListOrder(e,t){let{state:a,commit:n}=e,{newOrder:r}=t;const l=(0,s.Z)(3),o=[],c=[];for(const e in r)o.push(l((async()=>{const t=a.calendarsById[e];t.dav.order!==r[e]&&(t.dav.order=r[e],await t.dav.update(),c.push({calendar:t,newOrder:r[e]}))})));await Promise.all(o);for(const{calendar:e,newOrder:t}of c)console.debug(e,t),n("changeCalendarOrder",{calendar:e,newOrder:t})}},_={state:{calendars:[],trashBin:void 0,scheduleInbox:void 0,deletedCalendars:[],deletedCalendarObjects:[],calendarsById:{},initialCalendarsLoaded:!1,editCalendarModal:void 0},mutations:b,getters:h,actions:f}},16748:(e,t,a)=>{"use strict";a.d(t,{Z:()=>l});var n=a(20144);const r={appendContact(e,t){let{contact:a}=t;-1===e.contacts.indexOf(a)&&e.contacts.push(a);for(const t of a.emails)void 0===e.contactByEMail[t]&&n.default.set(e.contactByEMail,t,a)},removeContact(e,t){let{contact:a}=t;for(const t of a.emails)e.contactByEMail[t]===a&&n.default.delete(e.contactByEMail,t);const r=e.contacts.indexOf(a);-1!==r&&e.contacts.splice(r,1)}},l={state:{contacts:[],contactByEMail:{}},mutations:r,getters:{},actions:{}}},96951:(e,t,a)=>{"use strict";a.d(t,{Z:()=>r});const n={loadDavRestrictionsFromServer(e,t){let{minimumDate:a,maximumDate:n}=t;e.minimumDate=a,e.maximumDate=n}},r={state:{minimumDate:"1970-01-01T00:00:00Z",maximumDate:"2037-12-31T23:59:59Z"},mutations:n,getters:{},actions:{}}},73544:(e,t,a)=>{"use strict";a.d(t,{Z:()=>l});var n=a(20144);const r={addTimeRange(e,t){let{calendarId:a,from:r,to:l,lastFetched:o,calendarObjectIds:c}=t;const s={id:++e.lastTimeRangeInsertId,calendarId:a,from:r,to:l,lastFetched:o,calendarObjectIds:c};e.fetchedTimeRanges.push(s),n.default.set(e.fetchedTimeRangesById,s.id,s)},removeTimeRange(e,t){let{timeRangeId:a}=t;const r=e.fetchedTimeRangesById[a],l=e.fetchedTimeRanges.indexOf(r);-1!==l&&(e.fetchedTimeRanges.splice(l,1),n.default.delete(e.fetchedTimeRangesById,a))},appendCalendarObjectIdsToTimeFrame(e,t){let{timeRangeId:a,calendarObjectIds:n}=t;for(const t of n)-1===e.fetchedTimeRangesById[a].calendarObjectIds.indexOf(t)&&e.fetchedTimeRangesById[a].calendarObjectIds.push(t)},appendCalendarObjectIdToTimeRange(e,t){let{timeRangeId:a,calendarObjectId:n}=t;e.fetchedTimeRangesById[a].calendarObjectIds.push(n)},removeCalendarObjectIdFromTimeRange(e,t){let{timeRangeId:a,calendarObjectId:n}=t;const r=e.fetchedTimeRangesById[a].calendarObjectIds.indexOf(n);-1!==r&&e.fetchedTimeRangesById[a].calendarObjectIds.splice(r,1)},removeCalendarObjectIdFromAnyTimeRange(e,t){let{calendarObjectId:a}=t;for(const t of e.fetchedTimeRanges){const e=t.calendarObjectIds.indexOf(a);-1!==e&&t.calendarObjectIds.splice(e,1)}},updateTimestampOfLastFetched(e,t){let{timeRangeId:a,lastFetched:n}=t;e.fetchedTimeRangesById[a].lastFetched=n},addCalendarObjectIdToAllTimeRangesOfCalendar(e,t){let{calendarObjectId:a,calendarId:n}=t;for(const t of e.fetchedTimeRanges)t.calendarId===n&&-1===t.calendarObjectIds.indexOf(a)&&t.calendarObjectIds.push(a)},removeCalendarObjectIdFromAllTimeRangesOfCalendar(e,t){let{calendarObjectId:a,calendarId:n}=t;for(const t of e.fetchedTimeRanges){if(t.calendarId!==n)continue;const e=t.calendarObjectIds.indexOf(a);-1!==e&&t.calendarObjectIds.splice(e,1)}},clearFetchedTimeRanges(e){e.lastTimeRangeInsertId=-1,e.fetchedTimeRanges=[],e.fetchedTimeRangesById={}}},l={state:{lastTimeRangeInsertId:-1,fetchedTimeRanges:[],fetchedTimeRangesById:{}},mutations:r,getters:{getAllTimeRangesForCalendar:e=>t=>e.fetchedTimeRanges.filter((e=>e.calendarId===t)),getTimeRangeForCalendarCoveringRange:e=>(t,a,n)=>e.fetchedTimeRanges.find((e=>e.calendarId===t&&e.from<=a&&e.to>=n)),getAllTimeRangesOlderThan:e=>t=>e.fetchedTimeRanges.filter((e=>e.lastFetched<=t)),getLastTimeRangeInsertId:e=>e.lastTimeRangeInsertId,getCalendarObjectsByTimeRangeId:(e,t)=>a=>e.fetchedTimeRangesById[a]?e.fetchedTimeRangesById[a].calendarObjectIds.map((e=>t.getCalendarObjectById(e))):[]},actions:{}}},41259:(e,t,a)=>{"use strict";a.d(t,{Z:()=>l});var n=a(20144);const r={addFile(e,t){let{contents:a,lastModified:r,name:l,parser:o,size:c,type:s}=t;const d={id:++e.lastFileInsertId,contents:a,lastModified:r,name:l,parser:o,size:c,type:s};e.importFiles.push(d),n.default.set(e.importFilesById,d.id,d)},setCalendarForFileId(e,t){let{fileId:a,calendarId:r}=t;n.default.set(e.importCalendarRelation,a,r)},removeAllFiles(e){n.default.set(e,"importFiles",[]),n.default.set(e,"importFilesById",{}),n.default.set(e,"importCalendarRelation",{})}},l={state:{lastFileInsertId:-1,importFiles:[],importFilesById:{},importCalendarRelation:{}},mutations:r,getters:{},actions:{}}},6985:(e,t,a)=>{"use strict";a.d(t,{Z:()=>l});var n=a(59055);const r={incrementAccepted(e){e.accepted++},incrementDenied(e){e.denied++},setTotal(e,t){e.total=t},changeStage(e,t){e.stage=t},resetState(e){e.total=0,e.accepted=0,e.denied=0,e.stage=n.mz}},l={state:{total:0,accepted:0,denied:0,stage:n.mz},mutations:r,getters:{},actions:{}}},30319:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>h});var n=a(20144),r=a(20629),l=a(64280),o=a(83e3),c=a(77800),s=a(16748),d=a(96951),i=a(73544),u=a(41259),m=a(6985),p=a(54480),g=a(92539),b=a(84627);n.default.use(r.ZP);const h=new r.ZP.Store({modules:{appointmentConfigs:b.Z,calendarObjectInstance:l.Z,calendarObjects:o.Z,calendars:c.Z,contacts:s.Z,davRestrictions:d.Z,fetchedTimeRanges:i.Z,importFiles:u.Z,importState:m.Z,principals:p.Z,settings:g.Z}})},54480:(e,t,a)=>{"use strict";a.d(t,{Z:()=>s});var n=a(20144),r=a(2323),l=a(75357),o=a(4269);const c={addPrincipal(e,t){let{principal:a}=t;const r=(0,o.B)(a);e.principalsById[r.id]||(e.principals.push(r),n.default.set(e.principalsById,r.id,r))},setCurrentUserPrincipal(e,t){let{principalId:a}=t;e.currentUserPrincipal=a}},s={state:{principals:[],principalsById:{},currentUserPrincipal:null},mutations:c,getters:{getPrincipalByUrl:e=>t=>e.principals.find((e=>e.url===t)),getPrincipalById:e=>t=>e.principalsById[t],getCurrentUserPrincipal:e=>e.principalsById[e.currentUserPrincipal],getCurrentUserPrincipalEmail:e=>e.principalsById[e.currentUserPrincipal]?.emailAddress},actions:{async fetchPrincipalByUrl(e,t){let{url:a}=t;if(e.getters.getPrincipalByUrl(a))return;const n=await(0,r.i8)(a);n&&e.commit("addPrincipal",{principal:(0,o.R)(n)})},async fetchCurrentUserPrincipal(e){const t=(0,r.z$)();if(!t)return;const a=(0,o.R)(t);e.commit("addPrincipal",{principal:a}),e.commit("setCurrentUserPrincipal",{principalId:a.id}),l.ZP.debug(`Current user principal is ${a.url}`)}}}},92539:(e,t,a)=>{"use strict";a.d(t,{Z:()=>p});var n=a(2323),r=a(37494),l=a(50923),o=a(32066),c=a(67718),s=a(75357),d=a(54782);const i={toggleEventLimitEnabled(e){e.eventLimit=!e.eventLimit},togglePopoverEnabled(e){e.skipPopover=!e.skipPopover},toggleTasksEnabled(e){e.showTasks=!e.showTasks},toggleWeekendsEnabled(e){e.showWeekends=!e.showWeekends},toggleWeekNumberEnabled(e){e.showWeekNumbers=!e.showWeekNumbers},setSlotDuration(e,t){let{slotDuration:a}=t;e.slotDuration=a},setDefaultReminder(e,t){let{defaultReminder:a}=t;e.defaultReminder=a},setTimezone(e,t){let{timezoneId:a}=t;e.timezone=a},setAttachmentsFolder(e,t){let{attachmentsFolder:a}=t;e.attachmentsFolder=a},loadSettingsFromServer(e,t){let{appVersion:a,eventLimit:n,firstRun:r,showWeekNumbers:l,showTasks:o,showWeekends:c,skipPopover:d,slotDuration:i,defaultReminder:u,talkEnabled:m,tasksEnabled:p,timezone:g,hideEventExport:b,forceEventAlarmType:h,disableAppointments:f,canSubscribeLink:_,attachmentsFolder:y,showResources:j}=t;(0,s.PN)(`\nInitial settings:\n\t- AppVersion: ${a}\n\t- EventLimit: ${n}\n\t- FirstRun: ${r}\n\t- ShowWeekNumbers: ${l}\n\t- ShowTasks: ${o}\n\t- ShowWeekends: ${c}\n\t- SkipPopover: ${d}\n\t- SlotDuration: ${i}\n\t- DefaultReminder: ${u}\n\t- TalkEnabled: ${m}\n\t- TasksEnabled: ${p}\n\t- Timezone: ${g}\n\t- HideEventExport: ${b}\n\t- ForceEventAlarmType: ${h}\n\t- disableAppointments: ${f}\n\t- CanSubscribeLink: ${_}\n\t- attachmentsFolder: ${y}\n\t- ShowResources: ${j}\n`),e.appVersion=a,e.eventLimit=n,e.firstRun=r,e.showWeekNumbers=l,e.showTasks=o,e.showWeekends=c,e.skipPopover=d,e.slotDuration=i,e.defaultReminder=u,e.talkEnabled=m,e.tasksEnabled=p,e.timezone=g,e.hideEventExport=b,e.forceEventAlarmType=h,e.disableAppointments=f,e.canSubscribeLink=_,e.attachmentsFolder=y,e.showResources=j},setMomentLocale(e,t){let{locale:a}=t;(0,s.PN)(`Updated moment locale: ${a}`),e.momentLocale=a}},u={isTalkEnabled:e=>e.talkEnabled,getResolvedTimezone:e=>"automatic"===e.timezone?(0,l.N)():e.timezone,getResolvedTimezoneObject:(e,t)=>{const a=t.getResolvedTimezone;let n=(0,d.Z)().getTimezoneForId(a);return n||(n=(0,d.Z)().getTimezoneForId("UTC")),n}},m={async toggleBirthdayCalendarEnabled(e){let{getters:t,commit:a,dispatch:l}=e;if(t.hasBirthdayCalendar){const e=t.getBirthdayCalendar;await l("deleteCalendar",{calendar:e})}else{const e=await(0,n.V_)();a("addCalendar",{calendar:(0,r.o)(e)})}},async toggleEventLimitEnabled(e){let{state:t,commit:a}=e;const n=!t.eventLimit?"yes":"no";await(0,c.v)("eventLimit",n),a("toggleEventLimitEnabled")},async togglePopoverEnabled(e){let{state:t,commit:a}=e;const n=!t.skipPopover?"yes":"no";await(0,c.v)("skipPopover",n),a("togglePopoverEnabled")},async toggleWeekendsEnabled(e){let{state:t,commit:a}=e;const n=!t.showWeekends?"yes":"no";await(0,c.v)("showWeekends",n),a("toggleWeekendsEnabled")},async toggleTasksEnabled(e){let{state:t,commit:a}=e;const n=!t.showTasks?"yes":"no";await(0,c.v)("showTasks",n),a("toggleTasksEnabled"),a("clearFetchedTimeRanges"),a("incrementModificationCount")},async toggleWeekNumberEnabled(e){let{state:t,commit:a}=e;const n=!t.showWeekNumbers?"yes":"no";await(0,c.v)("showWeekNr",n),a("toggleWeekNumberEnabled")},async setInitialView(e,t){let{initialView:a}=t;await(0,c.v)("view",a)},async setSlotDuration(e,t){let{state:a,commit:n}=e,{slotDuration:r}=t;a.slotDuration!==r&&(await(0,c.v)("slotDuration",r),n("setSlotDuration",{slotDuration:r}))},async setDefaultReminder(e,t){let{state:a,commit:n}=e,{defaultReminder:r}=t;a.defaultReminder!==r&&(await(0,c.v)("defaultReminder",r),n("setDefaultReminder",{defaultReminder:r}))},async setTimezone(e,t){let{state:a,commit:n}=e,{timezoneId:r}=t;a.timezone!==r&&(await(0,c.v)("timezone",r),n("setTimezone",{timezoneId:r}))},async setAttachmentsFolder(e,t){let{state:a,commit:n}=e,{attachmentsFolder:r}=t;a.attachmentsFolder!==r&&(await(0,c.v)("attachmentsFolder",r),n("setAttachmentsFolder",{attachmentsFolder:r}))},initializeCalendarJsConfig(e){let{state:t}=e;(0,o.v6)("PRODID",`-//IDN nextcloud.com//Calendar app ${t.appVersion}//EN`),(0,o.v6)("property-list-significant-change",["SUMMARY","LOCATION","DESCRIPTION"])}},p={state:{appVersion:null,firstRun:null,talkEnabled:!1,disableAppointments:!1,eventLimit:null,showTasks:null,showWeekends:null,showWeekNumbers:null,skipPopover:null,slotDuration:null,defaultReminder:null,tasksEnabled:!1,timezone:"automatic",hideEventExport:!1,forceEventAlarmType:!1,canSubscribeLink:!0,showResources:!0,momentLocale:"en",attachmentsFolder:"/Calendar"},mutations:i,getters:u,actions:m}},82083:(e,t,a)=>{"use strict";a.d(t,{IP:()=>c,Yg:()=>o,cB:()=>s,mV:()=>d,oG:()=>i});var n=a(32066),r=a(31352);function l(e){switch(e){case"seconds":default:return 1;case"minutes":return 60;case"hours":return 3600;case"days":return 86400;case"weeks":return 604800}}function o(e){return 0===(e=Math.abs(e))?{amount:0,unit:"minutes"}:e%604800==0?{amount:e/604800,unit:"weeks"}:e%86400==0?{amount:e/86400,unit:"days"}:e%3600==0?{amount:e/3600,unit:"hours"}:e%60==0?{amount:e/60,unit:"minutes"}:{amount:e,unit:"seconds"}}function c(e,t){let a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return e*l(t)*(a?-1:1)}function s(e){const t=l("days"),a=l("hours"),n=l("minutes"),r=e<0;e=Math.abs(e);let o=Math.floor(e/t);const c=e%t;0!==c&&r&&o++;let s=0,d=null;0===o?d="days":o%7==0?(s=o/7,d="weeks"):(s=o,d="days");let i=Math.floor(c/a);const u=c%a;let m=Math.floor(u/n);return r&&(i=24-i,0!==m&&(i--,m=60-m)),{amount:s,unit:d,hours:i,minutes:m}}function d(e,t,a,n){"weeks"===n&&(e*=7,n="days");if(e>0){e--,e*=l(n);let r=24-t,o=0;0!==a&&(r--,o=60-a),e+=r*l("hours"),e+=o*l("minutes"),e*=-1}else e*=l("days"),e+=t*l("hours"),e+=a*l("minutes");return e}function i(e){for(const t of e.getAlarmIterator()){if("EMAIL"!==t.action)continue;t.deleteAllProperties("SUMMARY");const a=e.getFirstProperty("SUMMARY");if(a)t.addProperty(a.clone());else{const e=(0,r.translate)("calendar","Untitled event");t.addProperty(new n.Z9("SUMMARY",e))}if(!t.hasProperty("DESCRIPTION")){const e=(0,r.translate)("calendar","This is an event reminder.");t.addProperty(new n.Z9("DESCRIPTION",e))}t.deleteAllProperties("ATTENDEE");for(const a of e.getAttendeeIterator())["RESOURCE","ROOM"].includes(a.userType)||t.addProperty(new n.NQ("ATTENDEE",a.value))}}},33827:(e,t,a)=>{"use strict";function n(e){return"string"!=typeof e?"":e.startsWith("mailto:")?e.slice(7):e}a.d(t,{Oo:()=>n})},45792:(e,t,a)=>{"use strict";a.d(t,{f:()=>l,m:()=>r});var n=a(32066);const r=(e,t,a)=>{const r=e.calendarComponent.getVObjectIterator().next().value;if(!r)return[];const l=n.ul.fromJSDate(t,!0),o=n.ul.fromJSDate(a,!0);return r.recurrenceManager.getAllOccurrencesBetween(l,o)},l=(e,t)=>{const a=e.calendarComponent.getVObjectIterator().next().value;if(!a)return null;const r=n.ul.fromJSDate(t,!0);return a.recurrenceManager.getOccurrenceAtExactly(r)}},62768:(e,t,a)=>{"use strict";a.d(t,{_u:()=>O,Ud:()=>C,Nt:()=>D,eq:()=>T,$W:()=>I,RQ:()=>j,ny:()=>v});var n=a(12085),r=a.n(n),l=a(74655),o=a(44998),c=a(89734),s=a.n(c),d=a(78718),i=a.n(d),u=a(45578),m=a.n(u),p=a(19818);const g=m()(Object.keys(o),(e=>o[e])),b=i()(o,g),h=s()(Object.keys(b).map((e=>({name:e,hex:b[e]}))),(e=>e.hex)),f={detailed:!1};function _(e,t){const a=y(p.get.rgb(e)),n=y(p.get.rgb(t));return Math.sqrt(Math.pow(a[0]-n[0],2)+Math.pow(a[1]-n[1],2)+Math.pow(a[2]-n[2],2))}function y(e){const t=[0,0,0],a=[0,0,0],n=[0,0,0];for(let a=0;a<e.length;a++){let n=e[a]/255;n>.04045?n=Math.pow((n+.055)/1.055,2.4):n/=12.92,t[a]=100*n}a[0]=(.4124*t[0]+.3576*t[1]+.1805*t[2])/95.047,a[1]=(.2126*t[0]+.7152*t[1]+.0722*t[2])/100,a[2]=(.0193*t[0]+.1192*t[1]+.9505*t[2])/108.883;for(let e=0;e<3;e++){let t=a[e];t=t>.008856?Math.pow(t,1/3):7.787*t+16/116,a[e]=t}return n[0]=parseFloat((116*a[1]-16).toFixed(3)),n[1]=parseFloat((500*(a[0]-a[1])).toFixed(3)),n[2]=parseFloat((200*(a[1]-a[2])).toFixed(3)),n}function j(e){let{red:t,green:a,blue:n}=e;return(299*t+587*a+114*n)/1e3>130}function C(e){return function(e){let{red:t,green:a,blue:n}=e;return j({red:t,green:a,blue:n})?"#000000":"#FAFAFA"}(I(e))}function I(e){if(null==e)return{red:0,green:0,blue:0};const[t,a,n]=r().hex.rgb(e.slice(1));return{red:t,green:a,blue:n}}function v(e){const t=(0,l.U)(e);return"#"+r().rgb.hex(t.r,t.g,t.b)}function O(e){return/^(#)((?:[A-Fa-f0-9]{3}){1,2})$/.test(e)?e:/^((?:[A-Fa-f0-9]{3}){1,2})$/.test(e)?"#"+e:/^(#)((?:[A-Fa-f0-9]{8}))$/.test(e)?e.slice(0,7):!!/^((?:[A-Fa-f0-9]{8}))$/.test(e)&&"#"+e.slice(0,6)}function T(e){return o[e]||null}function D(e){return function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const a={...f,...t},n=s()(h,(t=>_(e,t.hex)));return a.detailed?n[0]:n[0].name}(e)}},15558:(e,t,a)=>{"use strict";a.d(t,{_6:()=>r,n8:()=>n,nZ:()=>l});a(75357);function n(){return new Date}function r(e){return Math.floor(e.getTime()/1e3)}function l(e){return new Date(e.year,e.month-1,e.day,e.hour,e.minute,0,0)}},75357:(e,t,a)=>{"use strict";a.d(t,{PN:()=>r,ZP:()=>l});const n=(0,a(17499).IY)().setApp("calendar").detectUser().build(),r=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};n.info(e,t)},l=n},53854:(e,t,a)=>{"use strict";function n(e){const t=r(e);let a=1,n=e.getDate();for(;n>7;n-=7)a++;return{byDay:t,bySetPosition:a}}function r(e){switch(e.getDay()){case 0:return"SU";case 1:return"MO";case 2:return"TU";case 3:return"WE";case 4:return"TH";case 5:return"FR";case 6:return"SA";default:throw TypeError("Invalid date-object given")}}a.d(t,{F:()=>r,b:()=>n})},83884:(e,t,a)=>{"use strict";a.d(t,{i:()=>r});var n=a(79753);function r(e){return[(0,n.linkTo)("calendar","index.php"),"v1/config",e].join("/")}},74655:(e,t,a)=>{"use strict";a.d(t,{U:()=>l});var n=a(2568),r=a.n(n);const l=e=>{let t=e.toLowerCase();null===t.match(/^([0-9a-f]{4}-?){8}$/)&&(t=r()(t)),t=t.replace(/[^0-9a-f]/g,"");const a=function(e){e||(e=6);const t=new o(182,70,157),a=new o(221,203,85),n=new o(0,130,201),r=c(e,t,a),l=c(e,a,n),s=c(e,n,t);return r.concat(l).concat(s)}(6);return a[function(e,t){let a=0;const n=[];for(let t=0;t<e.length;t++)n.push(parseInt(e.charAt(t),16)%16);for(const e in n)a+=n[e];return parseInt(parseInt(a,10)%t,10)}(t,18)]};function o(e,t,a){this.r=e,this.g=t,this.b=a}function c(e,t,a){const n=[];n.push(t);const r=function(e,t){const a=new Array(3);return a[0]=(t[1].r-t[0].r)/e,a[1]=(t[1].g-t[0].g)/e,a[2]=(t[1].b-t[0].b)/e,a}(e,[t,a]);for(let a=1;a<e;a++){const e=parseInt(t.r+r[0]*a,10),l=parseInt(t.g+r[1]*a,10),c=parseInt(t.b+r[2]*a,10);n.push(new o(e,l,c))}return n}},92916:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>c});var n=a(87537),r=a.n(n),l=a(23645),o=a.n(l)()(r());o.push([e.id,"#calendar_panel .calendar-dot{flex-shrink:0;height:1rem;width:1rem;margin-top:.2rem;border-radius:50%}#calendar_panel #calendar-widget-empty-content{text-align:center;margin-top:5vh}#calendar_panel #calendar-widget-empty-content.half-screen{margin-top:0;height:120px;margin-bottom:2vh}#calendar_panel .empty-label{display:flex;justify-content:center;margin-top:5vh}","",{version:3,sources:["webpack://./src/views/Dashboard.vue"],names:[],mappings:"AAEC,8BACC,aAAA,CACA,WAAA,CACA,UAAA,CACA,gBAAA,CACA,iBAAA,CAGD,+CACC,iBAAA,CACA,cAAA,CAEA,2DACC,YAAA,CACA,YAAA,CACA,iBAAA,CAKF,6BACC,YAAA,CACA,sBAAA,CACA,cAAA",sourcesContent:["\n#calendar_panel {\n\t.calendar-dot {\n\t\tflex-shrink: 0;\n\t\theight: 1rem;\n\t\twidth: 1rem;\n\t\tmargin-top: 0.2rem;\n\t\tborder-radius: 50%;\n\t}\n\n\t#calendar-widget-empty-content {\n\t\ttext-align: center;\n\t\tmargin-top: 5vh;\n\n\t\t&.half-screen {\n\t\t\tmargin-top: 0;\n\t\t\theight: 120px;\n\t\t\tmargin-bottom: 2vh;\n\t\t}\n\n\t}\n\n\t.empty-label {\n\t\tdisplay: flex;\n\t\tjustify-content: center;\n\t\tmargin-top: 5vh;\n\t}\n}\n"],sourceRoot:""}]);const c=o},77961:(e,t,a)=>{var n={"./af.js":[42786,"node_modules_moment_locale_af_js"],"./ar-dz.js":[14130,"node_modules_moment_locale_ar-dz_js"],"./ar-kw.js":[96135,"node_modules_moment_locale_ar-kw_js"],"./ar-ly.js":[56440,"node_modules_moment_locale_ar-ly_js"],"./ar-ma.js":[47702,"node_modules_moment_locale_ar-ma_js"],"./ar-sa.js":[16040,"node_modules_moment_locale_ar-sa_js"],"./ar-tn.js":[37100,"node_modules_moment_locale_ar-tn_js"],"./ar.js":[30867,"node_modules_moment_locale_ar_js"],"./az.js":[31083,"node_modules_moment_locale_az_js"],"./be.js":[9808,"node_modules_moment_locale_be_js"],"./bg.js":[68338,"node_modules_moment_locale_bg_js"],"./bm.js":[67438,"node_modules_moment_locale_bm_js"],"./bn-bd.js":[76225,"node_modules_moment_locale_bn-bd_js"],"./bn.js":[8905,"node_modules_moment_locale_bn_js"],"./bo.js":[11560,"node_modules_moment_locale_bo_js"],"./br.js":[1278,"node_modules_moment_locale_br_js"],"./bs.js":[80622,"node_modules_moment_locale_bs_js"],"./ca.js":[2468,"node_modules_moment_locale_ca_js"],"./cs.js":[5822,"node_modules_moment_locale_cs_js"],"./cv.js":[50877,"node_modules_moment_locale_cv_js"],"./cy.js":[47373,"node_modules_moment_locale_cy_js"],"./da.js":[24780,"node_modules_moment_locale_da_js"],"./de-at.js":[60217,"node_modules_moment_locale_de-at_js"],"./de-ch.js":[60894,"node_modules_moment_locale_de-ch_js"],"./de.js":[59740,"node_modules_moment_locale_de_js"],"./dv.js":[5300,"node_modules_moment_locale_dv_js"],"./el.js":[50837,"node_modules_moment_locale_el_js"],"./en-au.js":[78348,"node_modules_moment_locale_en-au_js"],"./en-ca.js":[77925,"node_modules_moment_locale_en-ca_js"],"./en-gb.js":[22243,"node_modules_moment_locale_en-gb_js"],"./en-ie.js":[46436,"node_modules_moment_locale_en-ie_js"],"./en-il.js":[47207,"node_modules_moment_locale_en-il_js"],"./en-in.js":[44175,"node_modules_moment_locale_en-in_js"],"./en-nz.js":[76319,"node_modules_moment_locale_en-nz_js"],"./en-sg.js":[31662,"node_modules_moment_locale_en-sg_js"],"./eo.js":[92915,"node_modules_moment_locale_eo_js"],"./es-do.js":[55251,"node_modules_moment_locale_es-do_js"],"./es-mx.js":[96112,"node_modules_moment_locale_es-mx_js"],"./es-us.js":[71146,"node_modules_moment_locale_es-us_js"],"./es.js":[55655,"node_modules_moment_locale_es_js"],"./et.js":[5603,"node_modules_moment_locale_et_js"],"./eu.js":[77763,"node_modules_moment_locale_eu_js"],"./fa.js":[76959,"node_modules_moment_locale_fa_js"],"./fi.js":[11897,"node_modules_moment_locale_fi_js"],"./fil.js":[42549,"node_modules_moment_locale_fil_js"],"./fo.js":[94694,"node_modules_moment_locale_fo_js"],"./fr-ca.js":[63049,"node_modules_moment_locale_fr-ca_js"],"./fr-ch.js":[52330,"node_modules_moment_locale_fr-ch_js"],"./fr.js":[15596,"node_modules_moment_locale_fr_js"],"./fy.js":[5044,"node_modules_moment_locale_fy_js"],"./ga.js":[29295,"node_modules_moment_locale_ga_js"],"./gd.js":[2101,"node_modules_moment_locale_gd_js"],"./gl.js":[38794,"node_modules_moment_locale_gl_js"],"./gom-deva.js":[27884,"node_modules_moment_locale_gom-deva_js"],"./gom-latn.js":[23168,"node_modules_moment_locale_gom-latn_js"],"./gu.js":[95349,"node_modules_moment_locale_gu_js"],"./he.js":[24206,"node_modules_moment_locale_he_js"],"./hi.js":[2819,"node_modules_moment_locale_hi_js"],"./hr.js":[30316,"node_modules_moment_locale_hr_js"],"./hu.js":[22138,"node_modules_moment_locale_hu_js"],"./hy-am.js":[11423,"node_modules_moment_locale_hy-am_js"],"./id.js":[29218,"node_modules_moment_locale_id_js"],"./is.js":[90135,"node_modules_moment_locale_is_js"],"./it-ch.js":[10150,"node_modules_moment_locale_it-ch_js"],"./it.js":[90626,"node_modules_moment_locale_it_js"],"./ja.js":[39183,"node_modules_moment_locale_ja_js"],"./jv.js":[24286,"node_modules_moment_locale_jv_js"],"./ka.js":[12105,"node_modules_moment_locale_ka_js"],"./kk.js":[47772,"node_modules_moment_locale_kk_js"],"./km.js":[18758,"node_modules_moment_locale_km_js"],"./kn.js":[79282,"node_modules_moment_locale_kn_js"],"./ko.js":[33730,"node_modules_moment_locale_ko_js"],"./ku.js":[1408,"node_modules_moment_locale_ku_js"],"./ky.js":[33291,"node_modules_moment_locale_ky_js"],"./lb.js":[36841,"node_modules_moment_locale_lb_js"],"./lo.js":[55466,"node_modules_moment_locale_lo_js"],"./lt.js":[57010,"node_modules_moment_locale_lt_js"],"./lv.js":[37595,"node_modules_moment_locale_lv_js"],"./me.js":[39861,"node_modules_moment_locale_me_js"],"./mi.js":[35493,"node_modules_moment_locale_mi_js"],"./mk.js":[95966,"node_modules_moment_locale_mk_js"],"./ml.js":[87341,"node_modules_moment_locale_ml_js"],"./mn.js":[5115,"node_modules_moment_locale_mn_js"],"./mr.js":[10370,"node_modules_moment_locale_mr_js"],"./ms-my.js":[41237,"node_modules_moment_locale_ms-my_js"],"./ms.js":[9847,"node_modules_moment_locale_ms_js"],"./mt.js":[72126,"node_modules_moment_locale_mt_js"],"./my.js":[56165,"node_modules_moment_locale_my_js"],"./nb.js":[64924,"node_modules_moment_locale_nb_js"],"./ne.js":[16744,"node_modules_moment_locale_ne_js"],"./nl-be.js":[59814,"node_modules_moment_locale_nl-be_js"],"./nl.js":[93901,"node_modules_moment_locale_nl_js"],"./nn.js":[83877,"node_modules_moment_locale_nn_js"],"./oc-lnc.js":[92135,"node_modules_moment_locale_oc-lnc_js"],"./pa-in.js":[15858,"node_modules_moment_locale_pa-in_js"],"./pl.js":[64495,"node_modules_moment_locale_pl_js"],"./pt-br.js":[57971,"node_modules_moment_locale_pt-br_js"],"./pt.js":[89520,"node_modules_moment_locale_pt_js"],"./ro.js":[96459,"node_modules_moment_locale_ro_js"],"./ru.js":[21793,"node_modules_moment_locale_ru_js"],"./sd.js":[40950,"node_modules_moment_locale_sd_js"],"./se.js":[10490,"node_modules_moment_locale_se_js"],"./si.js":[26994,"node_modules_moment_locale_si_js"],"./sk.js":[64249,"node_modules_moment_locale_sk_js"],"./sl.js":[14985,"node_modules_moment_locale_sl_js"],"./sq.js":[51104,"node_modules_moment_locale_sq_js"],"./sr-cyrl.js":[79915,"node_modules_moment_locale_sr-cyrl_js"],"./sr.js":[49131,"node_modules_moment_locale_sr_js"],"./ss.js":[85893,"node_modules_moment_locale_ss_js"],"./sv.js":[98760,"node_modules_moment_locale_sv_js"],"./sw.js":[91172,"node_modules_moment_locale_sw_js"],"./ta.js":[27333,"node_modules_moment_locale_ta_js"],"./te.js":[23110,"node_modules_moment_locale_te_js"],"./tet.js":[52095,"node_modules_moment_locale_tet_js"],"./tg.js":[27321,"node_modules_moment_locale_tg_js"],"./th.js":[9041,"node_modules_moment_locale_th_js"],"./tk.js":[19005,"node_modules_moment_locale_tk_js"],"./tl-ph.js":[75768,"node_modules_moment_locale_tl-ph_js"],"./tlh.js":[89444,"node_modules_moment_locale_tlh_js"],"./tr.js":[72397,"node_modules_moment_locale_tr_js"],"./tzl.js":[28254,"node_modules_moment_locale_tzl_js"],"./tzm-latn.js":[30699,"node_modules_moment_locale_tzm-latn_js"],"./tzm.js":[51106,"node_modules_moment_locale_tzm_js"],"./ug-cn.js":[9288,"node_modules_moment_locale_ug-cn_js"],"./uk.js":[67691,"node_modules_moment_locale_uk_js"],"./ur.js":[13795,"node_modules_moment_locale_ur_js"],"./uz-latn.js":[60588,"node_modules_moment_locale_uz-latn_js"],"./uz.js":[6791,"node_modules_moment_locale_uz_js"],"./vi.js":[65666,"node_modules_moment_locale_vi_js"],"./x-pseudo.js":[14378,"node_modules_moment_locale_x-pseudo_js"],"./yo.js":[75805,"node_modules_moment_locale_yo_js"],"./zh-cn.js":[83839,"node_modules_moment_locale_zh-cn_js"],"./zh-hk.js":[55726,"node_modules_moment_locale_zh-hk_js"],"./zh-mo.js":[99807,"node_modules_moment_locale_zh-mo_js"],"./zh-tw.js":[74152,"node_modules_moment_locale_zh-tw_js"]};function r(e){if(!a.o(n,e))return Promise.resolve().then((()=>{var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=n[e],r=t[0];return a.e(t[1]).then((()=>a.t(r,23)))}r.keys=()=>Object.keys(n),r.id=77961,e.exports=r},33260:(e,a,n)=>{"use strict";n.r(a),n.d(a,{default:()=>T});var r=n(18600),l=n(15961),o=n(32861),c=n(80419),s=n(8417),d=n(43554),i=n(80351),u=n.n(i),m=n(79753),p=n(2323),g=n(15558),b=n(98448),h=n(31352),f=n(62768),_=n(75357),y=n(45792);function j(e,t,a,n,r){const l=[];for(const o of e){let e;try{e=(0,y.m)(o,a,n)}catch(e){_.ZP.error(e.message);continue}for(const a of e){const e=[];if("CANCELLED"===a.status?e.push("fc-event-nc-cancelled"):"TENTATIVE"===a.status&&e.push("fc-event-nc-tentative"),a.hasComponent("VALARM")&&e.push("fc-event-nc-alarms"),"VTODO"===a.name&&null===a.endDate)continue;let n,c,s;if("VEVENT"===a.name)n=a.startDate.getInTimezone(r).jsDate,c=a.endDate.getInTimezone(r).jsDate;else{if("VTODO"!==a.name)continue;n=a.endDate.getInTimezone(r).jsDate,c=a.endDate.getInTimezone(r).jsDate}n.getTime()===c.getTime()&&c.setSeconds(c.getSeconds()+1),"VTODO"===a.name&&(e.push("fc-event-nc-task"),100!==a.percent&&"COMPLETED"!==a.status||e.push("fc-event-nc-task-completed")),"VEVENT"===a.name?s=a.title?a.title.replace(/\n/g," "):(0,h.translate)("calendar","Untitled event"):(s=a.title?a.title.replace(/\n/g," "):(0,h.translate)("calendar","Untitled task"),null!==a.percent&&(s+=` (${a.percent}%)`));const d={id:[o.id,a.id].join("###"),title:s,allDay:a.isAllDay(),start:n,end:c,classNames:e,extendedProps:{objectId:o.id,recurrenceId:a.getReferenceRecurrenceId()?a.getReferenceRecurrenceId().unixTime:null,canModifyAllDay:a.canModifyAllDay(),calendarOrder:t.order,calendarName:t.displayName,calendarId:t.id,darkText:(0,f.RQ)((0,f.$W)(t.color)),objectType:a.name,percent:a.percent||null,davUrl:o.dav.url,location:a.location,description:a.description}};if(a.color){const e=(0,f.eq)(a.color);e&&(d.backgroundColor=e,d.borderColor=e,d.textColor=(0,f.Ud)(e))}l.push(d)}}return l}async function C(e){try{return await n(77961)(`./${e}.js`),e}catch(t){const a=e.split("-");try{return e=a[0],await n(77961)(`./${e}.js`),e}catch(e){console.debug("Fallback to locale","en")}}return"en"}var I=n(32066),v=n(20629);const O={name:"Dashboard",components:{DashboardWidget:r.Z,DashboardWidgetItem:r.v,NcButton:l.P2,EmptyContent:l.SL,EmptyCalendar:o.Z,IconCheck:c.default,IconCheckbox:s.default},data:()=>({events:null,locale:"en",imagePath:(0,m.imagePath)("calendar","illustrations/calendar"),loading:!0,now:(0,g.n8)()}),computed:{...(0,v.Se)({timezoneObject:"getResolvedTimezoneObject"}),items(){if(!Array.isArray(this.events)||0===this.events.length)return[];const e=this.events[0];return u()(this.now).endOf("day").isBefore(e.startDate)?[{isEmptyItem:!0}].concat(this.events.slice(0,4)):this.events},clickStartNew:()=>(0,m.generateUrl)("apps/calendar")+"/new"},mounted(){this.initialize()},methods:{async initialize(){const e=(0,g.n8)(),t=(0,g.n8)();t.setDate(t.getDate()+14);const a=u()(e).startOf("day").toDate();await this.initializeEnvironment();const n=await this.fetchExpandedEvents(e,t);this.events=await this.formatEvents(n,a),this.loading=!1},async initializeEnvironment(){await(0,p.yG)(),await this.$store.dispatch("fetchCurrentUserPrincipal"),await this.$store.dispatch("loadCollections");const{show_tasks:e,timezone:t}=(0,d.j)("calendar","dashboard_data"),a=await async function(){const e=(0,h.getLocale)().replace("_","-").toLowerCase(),t=(0,h.getLanguage)().replace("_","-").toLowerCase();if(e===t)return C(e);const[a,n]=await Promise.all([C(e),C(t)]);if(a===n)return a;const r=`nextcloud-calendar-fake-locale-${a}-${n}`;return u().defineLocale(r,{parentLocale:n,longDateFormat:{LT:u().localeData(a).longDateFormat("LT"),LTS:u().localeData(a).longDateFormat("LTS"),L:u().localeData(a).longDateFormat("L"),LL:u().localeData(a).longDateFormat("LL"),LLL:u().localeData(a).longDateFormat("LLL"),LLLL:u().localeData(a).longDateFormat("LLLL"),l:u().localeData(a).longDateFormat("l"),ll:u().localeData(a).longDateFormat("ll"),lll:u().localeData(a).longDateFormat("lll"),llll:u().localeData(a).longDateFormat("llll")},week:{dow:u().localeData(a).firstDayOfWeek(),doy:u().localeData(a).firstDayOfYear()}}),r}();this.$store.commit("loadSettingsFromServer",{timezone:t,showTasks:e}),this.$store.commit("setMomentLocale",{locale:a})},async fetchExpandedEvents(e,t){const a=(0,b.Z)(10),n=[];for(const r of this.$store.getters.enabledCalendars)n.push(a((async()=>{let a;try{a=await this.$store.dispatch("getEventsFromCalendarInTimeRange",{calendar:r,from:e,to:t})}catch(e){return[]}return j(this.$store.getters.getCalendarObjectsByTimeRangeId(a),r,e,t,this.timezoneObject)})));return(await Promise.all(n)).flat()},formatEvents(e,t){return e.sort(((e,t)=>e.start.getTime()-t.start.getTime())).filter((e=>!e.classNames.includes("fc-event-nc-task-completed"))).filter((e=>!e.classNames.includes("fc-event-nc-cancelled"))).filter((e=>t.getTime()<=e.start.getTime())).slice(0,7).map((e=>({isEmptyItem:!1,componentName:e.extendedProps.objectType,targetUrl:"VEVENT"===e.extendedProps.objectType?this.getCalendarAppUrl(e):this.getTasksAppUrl(e),subText:this.formatSubtext(e),mainText:e.title,startDate:e.start,calendarColor:this.$store.state.calendars.calendarsById[e.extendedProps.calendarId].color,calendarDisplayName:this.$store.state.calendars.calendarsById[e.extendedProps.calendarId].displayname})))},formatSubtext(e){const a=this.$store.state.settings.momentLocale;if(e.allDay)return u()(e.start).locale(a).calendar(null,{sameDay:t("calendar","[Today]"),nextDay:t("calendar","[Tomorrow]"),nextWeek:"dddd",lastDay:t("calendar","[Yesterday]"),lastWeek:t("calendar","[Last] dddd"),sameElse:()=>"[replace-from-now]"}).replace("replace-from-now",u()(e.start).locale(a).fromNow());{const t=I.ul.fromJSDate(e.start).getInTimezone(this.timezoneObject).utcOffset()/60;return u()(e.start).utcOffset(t).locale(a).calendar(null,{sameElse:()=>"[replace-from-now]"}).replace("replace-from-now",u()(e.start).utcOffset(t).locale(a).fromNow())}},getCalendarAppUrl(e){let{extendedProps:t}=e;return(0,m.generateUrl)("apps/calendar")+"/edit/"+t.objectId+"/"+t.recurrenceId},getTasksAppUrl(e){let{extendedProps:t}=e;const a=t.davUrl.split("/"),n=a.pop(),r=a.pop();return(0,m.generateUrl)("apps/tasks")+`/#/calendars/${r}/tasks/${n}`}}};n(9567);const T=(0,n(51900).Z)(O,(function(){var e=this,t=e._self._c;return t("DashboardWidget",{attrs:{id:"calendar_panel",items:e.items,loading:e.loading},scopedSlots:e._u([{key:"default",fn:function(a){let{item:n}=a;return[n.isEmptyItem?t("EmptyContent",{staticClass:"half-screen",attrs:{id:"calendar-widget-empty-content",title:e.t("calendar","No more events today")},scopedSlots:e._u([{key:"icon",fn:function(){return[t("IconCheck",{attrs:{size:67}})]},proxy:!0}],null,!0)}):t("DashboardWidgetItem",{attrs:{"main-text":n.mainText,"sub-text":n.subText,"target-url":n.targetUrl},scopedSlots:e._u([{key:"avatar",fn:function(){return["VEVENT"===n.componentName?t("div",{staticClass:"calendar-dot",style:{"background-color":n.calendarColor},attrs:{title:n.calendarDisplayName}}):t("IconCheckbox",{attrs:{"fill-color":n.calendarColor}})]},proxy:!0}],null,!0)})]}},{key:"empty-content",fn:function(){return[t("EmptyContent",{attrs:{id:"calendar-widget-empty-content",title:e.t("calendar","No upcoming events")},scopedSlots:e._u([{key:"icon",fn:function(){return[t("EmptyCalendar")]},proxy:!0}])}),e._v(" "),t("div",{staticClass:"empty-label"},[t("NcButton",{attrs:{type:"secondary",href:e.clickStartNew}},[e._v("\n\t\t\t\t"+e._s(e.t("calendar","Create a new event"))+"\n\t\t\t")])],1)]},proxy:!0}])})}),[],!1,null,null,null).exports},9567:(e,t,a)=>{var n=a(92916);n.__esModule&&(n=n.default),"string"==typeof n&&(n=[[e.id,n,""]]),n.locals&&(e.exports=n.locals);(0,a(45346).Z)("6040151a",n,!0,{})}}]);
//# sourceMappingURL=calendar-dashboard-lazy.js.map?v=5a4b391994df0c53c67a