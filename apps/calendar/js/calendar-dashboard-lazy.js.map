{"version":3,"file":"calendar-dashboard-lazy.js?v=5a4b391994df0c53c67a","mappings":"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AOxQ,EAAI2Q,EAAK,GAAKjD,EAAG,IAC3CgD,EAAQj/B,KAAK,IAAIm+B,EAAMvM,EAAGiL,EAAGtO,GAC9B,CACA,OAAO0Q,CACR,iGClHII,QAA0B,GAA4B,KAE1DA,EAAwBr/B,KAAK,CAACs/B,EAAOvhC,GAAI,gXAAiX,GAAG,CAAC,QAAU,EAAE,QAAU,CAAC,uCAAuC,MAAQ,GAAG,SAAW,iKAAiK,eAAiB,CAAC,kcAAkc,WAAa,MAEpnC,2BCPA,IAAIvC,EAAM,CACT,UAAW,CACV,MACA,oCAED,aAAc,CACb,MACA,uCAED,aAAc,CACb,MACA,uCAED,aAAc,CACb,MACA,uCAED,aAAc,CACb,MACA,uCAED,aAAc,CACb,MACA,uCAED,aAAc,CACb,MACA,uCAED,UAAW,CACV,MACA,oCAED,UAAW,CACV,MACA,oCAED,UAAW,CACV,KACA,oCAED,UAAW,CACV,MACA,oCAED,UAAW,CACV,MACA,oCAED,aAAc,CACb,MACA,uCAED,UAAW,CACV,KACA,oCAED,UAAW,CACV,MACA,oCAED,UAAW,CACV,KACA,oCAED,UAAW,CACV,MACA,oCAED,UAAW,CACV,KACA,oCAED,UAAW,CACV,KACA,oCAED,UAAW,CACV,MACA,oCAED,UAAW,CACV,MACA,oCAED,UAAW,CACV,MACA,oCAED,aAAc,CACb,MACA,uCAED,aAAc,CACb,MACA,uCAED,UAAW,CACV,MACA,oCAED,UAAW,CACV,KACA,oCAED,UAAW,CACV,MACA,oCAED,aAAc,CACb,MACA,uCAED,aAAc,CACb,MACA,uCAED,aAAc,CACb,MACA,uCAED,aAAc,CACb,MACA,uCAED,aAAc,CACb,MACA,uCAED,aAAc,CACb,MACA,uCAED,aAAc,CACb,MACA,uCAED,aAAc,CACb,MACA,uCAED,UAAW,CACV,MACA,oCAED,aAAc,CACb,MACA,uCAED,aAAc,CACb,MACA,uCAED,aAAc,CACb,MACA,uCAED,UAAW,CACV,MACA,oCAED,UAAW,CACV,KACA,oCAED,UAAW,CACV,MACA,oCAED,UAAW,CACV,MACA,oCAED,UAAW,CACV,MACA,oCAED,WAAY,CACX,MACA,qCAED,UAAW,CACV,MACA,oCAED,aAAc,CACb,MACA,uCAED,aAAc,CACb,MACA,uCAED,UAAW,CACV,MACA,oCAED,UAAW,CACV,KACA,oCAED,UAAW,CACV,MACA,oCAED,UAAW,CACV,KACA,oCAED,UAAW,CACV,MACA,oCAED,gBAAiB,CAChB,MACA,0CAED,gBAAiB,CAChB,MACA,0CAED,UAAW,CACV,MACA,oCAED,UAAW,CACV,MACA,oCAED,UAAW,CACV,KACA,oCAED,UAAW,CACV,MACA,oCAED,UAAW,CACV,MACA,oCAED,aAAc,CACb,MACA,uCAED,UAAW,CACV,MACA,oCAED,UAAW,CACV,MACA,oCAED,aAAc,CACb,MACA,uCAED,UAAW,CACV,MACA,oCAED,UAAW,CACV,MACA,oCAED,UAAW,CACV,MACA,oCAED,UAAW,CACV,MACA,oCAED,UAAW,CACV,MACA,oCAED,UAAW,CACV,MACA,oCAED,UAAW,CACV,MACA,oCAED,UAAW,CACV,MACA,oCAED,UAAW,CACV,KACA,oCAED,UAAW,CACV,MACA,oCAED,UAAW,CACV,MACA,oCAED,UAAW,CACV,MACA,oCAED,UAAW,CACV,MACA,oCAED,UAAW,CACV,MACA,oCAED,UAAW,CACV,MACA,oCAED,UAAW,CACV,MACA,oCAED,UAAW,CACV,MACA,oCAED,UAAW,CACV,MACA,oCAED,UAAW,CACV,KACA,oCAED,UAAW,CACV,MACA,oCAED,aAAc,CACb,MACA,uCAED,UAAW,CACV,KACA,oCAED,UAAW,CACV,MACA,oCAED,UAAW,CACV,MACA,oCAED,UAAW,CACV,MACA,oCAED,UAAW,CACV,MACA,oCAED,aAAc,CACb,MACA,uCAED,UAAW,CACV,MACA,oCAED,UAAW,CACV,MACA,oCAED,cAAe,CACd,MACA,wCAED,aAAc,CACb,MACA,uCAED,UAAW,CACV,MACA,oCAED,aAAc,CACb,MACA,uCAED,UAAW,CACV,MACA,oCAED,UAAW,CACV,MACA,oCAED,UAAW,CACV,MACA,oCAED,UAAW,CACV,M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","sources":["webpack:///calendar/src/defaults/defaultCategories.js","webpack:///calendar/src/models/alarm.js","webpack:///calendar/src/models/appointmentConfig.js","webpack:///calendar/src/models/attachment.js","webpack:///calendar/src/models/attendee.js","webpack:///calendar/src/models/calendar.js","webpack:///calendar/src/models/calendarObject.js","webpack:///calendar/src/models/calendarShare.js","webpack:///calendar/src/models/consts.js","webpack:///calendar/src/models/event.js","webpack:///calendar/src/models/principal.js","webpack:///calendar/src/models/recurrenceRule.js","webpack:///calendar/src/models/rfcProps.js","webpack:///calendar/src/services/appointmentConfigService.js","webpack:///calendar/src/services/caldavService.js","webpack:///calendar/src/services/settings.js","webpack:///calendar/src/services/talkService.js","webpack:///calendar/src/services/timezoneDataProviderService.js","webpack:///calendar/src/services/timezoneDetectionService.js","webpack:///calendar/src/store/appointmentConfigs.js","webpack:///calendar/src/store/calendarObjectInstance.js","webpack:///calendar/src/store/calendarObjects.js","webpack:///calendar/src/store/calendars.js","webpack:///calendar/src/store/contacts.js","webpack:///calendar/src/store/davRestrictions.js","webpack:///calendar/src/store/fetchedTimeRanges.js","webpack:///calendar/src/store/importFiles.js","webpack:///calendar/src/store/importState.js","webpack:///calendar/src/store/index.js","webpack:///calendar/src/store/principals.js","webpack:///calendar/src/store/settings.js","webpack:///calendar/src/utils/alarms.js","webpack:///calendar/src/utils/attendee.js","webpack:///calendar/src/utils/calendarObject.js","webpack:///calendar/src/utils/closestColor.js","webpack:///calendar/src/utils/color.js","webpack:///calendar/src/utils/date.js","webpack:///calendar/src/utils/logger.js","webpack:///calendar/src/utils/recurrence.js","webpack:///calendar/src/utils/settings.js","webpack:///calendar/src/utils/uidToColor.js","webpack:///calendar/src/views/Dashboard.vue?vue&type=style&index=0&id=1324c966&prod&lang=scss&","webpack:///calendar/node_modules/moment/locale|lazy|/^\\.\\/.*\\.js$/|groupOptions: {}|namespace object","webpack://calendar/./src/views/Dashboard.vue?7277","webpack:///calendar/src/fullcalendar/eventSources/eventSourceFunction.js","webpack:///calendar/src/utils/moment.js","webpack:///calendar/src/views/Dashboard.vue","webpack:///calendar/src/views/Dashboard.vue?vue&type=script&lang=js&","webpack://calendar/./src/views/Dashboard.vue?e0de","webpack://calendar/./src/views/Dashboard.vue?6b03"],"sourcesContent":["/**\n * Calendar App\n *\n * @copyright 2019 Georg Ehrke <oc.list@georgehrke.com>\n *\n * @author Georg Ehrke\n *\n * @author Richard Steinmetz <richard@steinmetz.cloud>\n *\n * This library is free software; you can redistribute it and/or\n * modify it under the terms of the GNU AFFERO GENERAL PUBLIC LICENSE\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or any later version.\n *\n * This library is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU AFFERO GENERAL PUBLIC LICENSE for more details.\n *\n * You should have received a copy of the GNU Affero General Public\n * License along with this library.  If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport { translate as t } from '@nextcloud/l10n'\n\n/**\n *\n */\nexport function getDefaultCategories() {\n\t// This list was taken from https://tools.ietf.org/html/rfc5545#section-5\n\tconst values = [\n\t\tt('calendar', 'Anniversary'),\n\t\tt('calendar', 'Appointment'),\n\t\tt('calendar', 'Business'),\n\t\tt('calendar', 'Education'),\n\t\tt('calendar', 'Holiday'),\n\t\tt('calendar', 'Meeting'),\n\t\tt('calendar', 'Miscellaneous'),\n\t\tt('calendar', 'Non-working hours'),\n\t\tt('calendar', 'Not in office'),\n\t\tt('calendar', 'Personal'),\n\t\tt('calendar', 'Phone call'),\n\t\tt('calendar', 'Sick day'),\n\t\tt('calendar', 'Special occasion'),\n\t\tt('calendar', 'Travel'),\n\t\tt('calendar', 'Vacation'),\n\t]\n\treturn values.map(value => ({ value, label: value }))\n}\n\nexport default getDefaultCategories\n","/**\n * @copyright Copyright (c) 2020 Georg Ehrke\n *\n * @author Georg Ehrke <oc.list@georgehrke.com>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport {\n\tgetAmountAndUnitForTimedEvents,\n\tgetAmountHoursMinutesAndUnitForAllDayEvents,\n} from '../utils/alarms.js'\nimport { getDateFromDateTimeValue } from '../utils/date.js'\n\n/**\n * Creates a complete alarm object based on given props\n *\n * @param {object} props The alarm properties already provided\n * @return {object}\n */\nconst getDefaultAlarmObject = (props = {}) => Object.assign({}, {\n\t// The calendar-js alarm component\n\talarmComponent: null,\n\t// Type of alarm: DISPLAY, EMAIL, AUDIO\n\ttype: null,\n\t// Whether or not the alarm is relative\n\tisRelative: false,\n\t// Date object of an absolute alarm (if it's absolute, it must be DATE-TIME)\n\tabsoluteDate: null,\n\t// The time zone id of for absolute alarms\n\tabsoluteTimezoneId: null,\n\t// Whether or not the relative alarm is before the event,\n\trelativeIsBefore: null,\n\t// Whether or not the alarm is relative to the event's start\n\trelativeIsRelatedToStart: null,\n\t// TIMED EVENTS:\n\t// Unit (seconds, minutes, hours, ...) if this alarm is inside a timed event\n\trelativeUnitTimed: null,\n\t// The amount of unit if this alarm is inside a timed event\n\trelativeAmountTimed: null,\n\t// ALL-DAY EVENTS:\n\t// Unit (seconds, minutes, hours, ...) if this alarm is inside an all-day event\n\trelativeUnitAllDay: null,\n\t// The amount of unit if this alarm is inside a all-day event\n\trelativeAmountAllDay: null,\n\t// The hours to display alarm for in an all-day event (e.g. 1 day before at 9:00 am)\n\trelativeHoursAllDay: null,\n\t// The minutes to display alarm for in an all-day event (e.g. 1 day before at 9:30 am)\n\trelativeMinutesAllDay: null,\n\t// The total amount of seconds for a relative alarm\n\trelativeTrigger: null,\n}, props)\n\n/**\n * Map an alarm component to our alarm object\n *\n * @param {AlarmComponent} alarmComponent The calendar-js alarm-component to turn into an alarm object\n * @return {object}\n */\nconst mapAlarmComponentToAlarmObject = (alarmComponent) => {\n\tif (alarmComponent.trigger.isRelative()) {\n\t\tconst relativeIsBefore = alarmComponent.trigger.value.isNegative\n\t\tconst relativeIsRelatedToStart = alarmComponent.trigger.related === 'START'\n\n\t\tconst {\n\t\t\tamount: relativeAmountTimed,\n\t\t\tunit: relativeUnitTimed,\n\t\t} = getAmountAndUnitForTimedEvents(alarmComponent.trigger.value.totalSeconds)\n\n\t\tconst {\n\t\t\tunit: relativeUnitAllDay,\n\t\t\tamount: relativeAmountAllDay,\n\t\t\thours: relativeHoursAllDay,\n\t\t\tminutes: relativeMinutesAllDay,\n\t\t} = getAmountHoursMinutesAndUnitForAllDayEvents(alarmComponent.trigger.value.totalSeconds)\n\n\t\tconst relativeTrigger = alarmComponent.trigger.value.totalSeconds\n\n\t\treturn getDefaultAlarmObject({\n\t\t\talarmComponent,\n\t\t\ttype: alarmComponent.action,\n\t\t\tisRelative: alarmComponent.trigger.isRelative(),\n\t\t\trelativeIsBefore,\n\t\t\trelativeIsRelatedToStart,\n\t\t\trelativeUnitTimed,\n\t\t\trelativeAmountTimed,\n\t\t\trelativeUnitAllDay,\n\t\t\trelativeAmountAllDay,\n\t\t\trelativeHoursAllDay,\n\t\t\trelativeMinutesAllDay,\n\t\t\trelativeTrigger,\n\t\t})\n\t} else {\n\t\tconst absoluteDate = getDateFromDateTimeValue(alarmComponent.trigger.value)\n\n\t\treturn getDefaultAlarmObject({\n\t\t\talarmComponent,\n\t\t\ttype: alarmComponent.action,\n\t\t\tisRelative: alarmComponent.trigger.isRelative(),\n\t\t\tabsoluteDate,\n\t\t\tabsoluteTimezoneId: alarmComponent.trigger.value.timezoneId,\n\t\t})\n\t}\n}\n\nexport {\n\tgetDefaultAlarmObject,\n\tmapAlarmComponentToAlarmObject,\n}\n","/**\n * @copyright Copyright (c) 2021 Richard Steinmetz <richard@steinmetz.cloud>\n *\n * @author Richard Steinmetz <richard@steinmetz.cloud>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\nimport { generateUrl } from '@nextcloud/router'\nimport {\n\tgetEmptySlots,\n\tvavailabilityToSlots,\n} from '@nextcloud/calendar-availability-vue'\n\n/** @class */\nexport default class AppointmentConfig {\n\n\t/** @member {?number} */\n\tid\n\n\t/** @member {?string} */\n\ttoken\n\n\t/** @member {string} */\n\tname\n\n\t/** @member {string} */\n\tdescription\n\n\t/** @member {string} */\n\tlocation\n\n\t/** @member {string} */\n\tvisibility\n\n\t/** @member {string} */\n\ttargetCalendarUri\n\n\t/** @member {object} */\n\tavailability\n\n\t/** @member {number} */\n\tlength\n\n\t/** @member {number} */\n\tincrement\n\n\t/** @member {number} */\n\tpreparationDuration\n\n\t/** @member {number} */\n\tfollowupDuration\n\n\t/** @member {number} */\n\ttimeBeforeNextSlot\n\n\t/** @member {?number} */\n\tdailyMax\n\n\t/** @member {?number} */\n\tfutureLimit\n\n\t/** @member {?string[]} */\n\tcalendarFreeBusyUris\n\n\t/** @member {bool} */\n\tcreateTalkRoom\n\n\t/**\n\t * Create a new AppointmentConfig from the given plain object data\n\t *\n\t * @param {object} data Appointment config data to construct an instance from\n\t * @param {?number} data.id Id\n\t * @param {?string} data.token Token\n\t * @param {string} data.name Name\n\t * @param {string} data.description Description\n\t * @param {string} data.location Location\n\t * @param {string} data.visibility Visibility\n\t * @param {string} data.targetCalendarUri Target calendar URI\n\t * @param {object} data.availability Availability\n\t * @param {number} data.length Length in seconds\n\t * @param {number} data.increment Increment in seconds\n\t * @param {number} data.preparationDuration Preparation duration in seconds\n\t * @param {number} data.followupDuration Followup duration in seconds\n\t * @param {number} data.timeBeforeNextSlot Time before next slot in seconds\n\t * @param {?number} data.dailyMax Max daily slots\n\t * @param {?number} data.futureLimit Limits how far in the future appointments can be booked\n\t * @param {?string[]} data.calendarFreeBusyUris URIs of calendars to check for conflicts\n\t * @param {bool} data.createTalkRoom Whether a Talk room should be created\n\t */\n\tconstructor(data) {\n\t\tdata ??= {}\n\t\tthis.id = data.id\n\t\tthis.token = data.token\n\t\tthis.name = data.name\n\t\tthis.description = data.description\n\t\tthis.location = data.location\n\t\tthis.visibility = data.visibility\n\t\tthis.targetCalendarUri = data.targetCalendarUri\n\t\tthis.availability = data.availability\n\t\tthis.length = tryParseInt(data.length) ?? 0\n\t\tthis.increment = tryParseInt(data.increment) ?? 0\n\t\tthis.preparationDuration = tryParseInt(data.preparationDuration)\n\t\tthis.followupDuration = tryParseInt(data.followupDuration)\n\t\tthis.timeBeforeNextSlot = tryParseInt(data.timeBeforeNextSlot)\n\t\tthis.dailyMax = tryParseInt(data.dailyMax)\n\t\tthis.futureLimit = tryParseInt(data.futureLimit)\n\t\tthis.calendarFreeBusyUris = data.calendarFreeBusyUris\n\t\tthis.createTalkRoom = data.createTalkRoom\n\t}\n\n\t/**\n\t * Create a default appointment config instance\n\t *\n\t * @param {string} targetCalendarUri\n\t * @param {ScheduleInbox} scheduleInbox\n\t * @param {string} timezoneId fallback time zone when no schedule inbox availability is set\n\t * @return {AppointmentConfig} Default appointment config instance\n\t */\n\tstatic createDefault(targetCalendarUri, scheduleInbox, timezoneId) {\n\t\tlet slots = getEmptySlots()\n\t\tif (scheduleInbox && scheduleInbox.availability) {\n\t\t\tconst converted = vavailabilityToSlots(scheduleInbox.availability)\n\t\t\tslots = converted.slots\n\t\t\ttimezoneId = converted.timezoneId ?? timezoneId\n\t\t} else {\n\t\t\t// Set default availability to Mo-Fr 9-5\n\t\t\tconst tsAtTime = (hours, minutes) => Math.round((new Date()).setHours(hours, minutes, 0, 0) / 1000);\n\t\t\t['MO', 'TU', 'WE', 'TH', 'FR'].forEach(day => slots[day].push({\n\t\t\t\tstart: tsAtTime(9, 0),\n\t\t\t\tend: tsAtTime(17, 0),\n\t\t\t}))\n\t\t}\n\n\t\treturn new AppointmentConfig({\n\t\t\tname: '',\n\t\t\tdescription: '',\n\t\t\tlocation: '',\n\t\t\ttargetCalendarUri,\n\t\t\tavailability: {\n\t\t\t\ttimezoneId,\n\t\t\t\tslots,\n\t\t\t},\n\t\t\tvisibility: 'PRIVATE',\n\t\t\tlength: 5 * 60,\n\t\t\tincrement: 15 * 60,\n\t\t\tpreparationDuration: 0,\n\t\t\tfollowupDuration: 0,\n\t\t\ttimeBeforeNextSlot: 0,\n\t\t\tcalendarFreeBusyUris: [],\n\t\t\tfutureLimit: 2 * 30 * 24 * 60 * 60, // 2 months\n\t\t})\n\n\t}\n\n\t/**\n\t * Clone this instance\n\t *\n\t * @return {AppointmentConfig} A cloned version of this instance\n\t */\n\tclone() {\n\t\treturn AppointmentConfig.fromJSON(JSON.stringify(this))\n\t}\n\n\t/**\n\t * Parse a JSON string into a new AppointmentConfig instance\n\t *\n\t * @param {string} jsonString The JSON string to parse\n\t * @return {AppointmentConfig} New instance parsed from given JSON string\n\t */\n\tstatic fromJSON(jsonString) {\n\t\treturn new AppointmentConfig(JSON.parse(jsonString))\n\t}\n\n\t/**\n\t * Get the absolute booking URL of this instance\n\t *\n\t * @return {string} Absolute URL\n\t */\n\tget bookingUrl() {\n\t\tconst baseUrl = `${window.location.protocol}//${window.location.hostname}`\n\t\tconst relativeUrl = generateUrl('/apps/calendar/appointment/{token}', {\n\t\t\ttoken: this.token,\n\t\t})\n\t\treturn baseUrl + relativeUrl\n\t}\n\n}\n\n/**\n * Try to parse an int from the given value or return undefined\n *\n * @param {string|number|null|undefined} value The value to parse\n * @return {number|undefined} Parsed number or undefined\n */\nfunction tryParseInt(value) {\n\tif (value === null || value === undefined) {\n\t\treturn undefined\n\t}\n\n\treturn parseInt(value)\n}\n","/**\n * @copyright Copyright (c) 2022 Mikhail Sazanov\n *\n * @author Mikhail Sazanov <m@sazanof.ru>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\n/**\n * Creates a complete attachment object based on given props\n *\n * @param {object} props The attachment properties already provided\n * @return {object}\n */\nconst getDefaultAttachmentObject = (props = {}) => Object.assign({}, {\n\t// The calendar-js attachment property\n\tattachmentProperty: null,\n\t// The file name of the attachment\n\tfileName: null,\n\t// The attachment mime type\n\tformatType: null,\n\t// The uri of the attachment\n\turi: null,\n\t// The value from calendar object\n\tvalue: null,\n\t// Preview of file\n\txNcHasPreview: null,\n\t// File id in NC\n\txNcFileId: null,\n}, props)\n\n/**\n * Maps a calendar-js attachment property to our attachment object\n *\n * @param {attachmentProperty} attachmentProperty The calendar-js attachmentProperty to turn into a attachment object\n * @return {object}\n */\nconst mapAttachmentPropertyToAttchmentObject = (attachmentProperty) => {\n\treturn getDefaultAttachmentObject({\n\t\tattachmentProperty,\n\t\tfileName: attachmentProperty.getParameterFirstValue('FILENAME'),\n\t\tformatType: attachmentProperty.formatType,\n\t\turi: attachmentProperty.uri,\n\t\tvalue: attachmentProperty.value,\n\t\txNcHasPreview: attachmentProperty.getParameterFirstValue('X-NC-HAS-PREVIEW') === 'true',\n\t\txNcFileId: attachmentProperty.getParameterFirstValue('X-NC-FILE-ID'),\n\t})\n}\n\nexport {\n\tgetDefaultAttachmentObject,\n\tmapAttachmentPropertyToAttchmentObject,\n}\n","/**\n * @copyright Copyright (c) 2020 Georg Ehrke\n * @copyright Copyright (c) 2023 Jonas Heinrich\n *\n * @author Georg Ehrke <oc.list@georgehrke.com>\n * @author Jonas Heinrich <heinrich@synyx.net>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\n/**\n * Creates a complete attendee object based on given props\n *\n * TODO:\n *  - we should eventually support delegatedFrom and delegatedTo\n *\n * @param {object} props The attendee properties already provided\n * @return {object}\n */\nconst getDefaultAttendeeObject = (props = {}) => Object.assign({}, {\n\t// The calendar-js attendee property\n\tattendeeProperty: null,\n\t// The display-name of the attendee\n\tcommonName: null,\n\t// The calendar-user-type of the attendee\n\tcalendarUserType: 'INDIVIDUAL',\n\t// The participation status of the attendee\n\tparticipationStatus: 'NEEDS-ACTION',\n\t// The role of the attendee\n\trole: 'REQ-PARTICIPANT',\n\t// The RSVP for the attendee\n\trsvp: false,\n\t// The uri of the attendee\n\turi: null,\n\t// Member address of the attendee\n\tmember: null,\n}, props)\n\n/**\n * Maps a calendar-js attendee property to our attendee object\n *\n * @param {AttendeeProperty} attendeeProperty The calendar-js attendeeProperty to turn into a attendee object\n * @return {object}\n */\nconst mapAttendeePropertyToAttendeeObject = (attendeeProperty) => {\n\treturn getDefaultAttendeeObject({\n\t\tattendeeProperty,\n\t\tcommonName: attendeeProperty.commonName,\n\t\tcalendarUserType: attendeeProperty.userType,\n\t\tparticipationStatus: attendeeProperty.participationStatus,\n\t\trole: attendeeProperty.role,\n\t\trsvp: attendeeProperty.rsvp,\n\t\turi: attendeeProperty.email,\n\t\tmember: attendeeProperty.member,\n\t})\n}\n\nexport {\n\tgetDefaultAttendeeObject,\n\tmapAttendeePropertyToAttendeeObject,\n}\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <oc.list@georgehrke.com>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport { detectColor, uidToHexColor } from '../utils/color.js'\nimport { mapDavShareeToCalendarShareObject } from './calendarShare.js'\n\n/**\n * Creates a complete calendar-object based on given props\n *\n * @param {object} props Calendar-props already provided\n * @return {object}\n */\nconst getDefaultCalendarObject = (props = {}) => Object.assign({}, {\n\t// Id of the calendar\n\tid: '',\n\t// Visible display name\n\tdisplayName: '',\n\t// Color of the calendar\n\tcolor: uidToHexColor(''),\n\t// Whether or not the calendar is visible in the grid\n\tenabled: true,\n\t// Whether or not the calendar is loading events at the moment\n\tloading: false,\n\t// Whether this calendar supports VEvents\n\tsupportsEvents: true,\n\t// Whether this calendar supports VJournals\n\tsupportsJournals: false,\n\t// Whether this calendar supports VTodos\n\tsupportsTasks: false,\n\t// The principal uri of the owner\n\towner: '',\n\t// Timezone set for this calendar\n\ttimezone: null,\n\t// List of shares\n\tshares: [],\n\t// Published url\n\tpublishURL: null,\n\t// Internal CalDAV url of this calendar\n\turl: '',\n\t// Whether this calendar is read-only\n\treadOnly: false,\n\t// The order of this calendar in the calendar-list\n\torder: 0,\n\t// Whether or not the calendar is shared with me\n\tisSharedWithMe: false,\n\t// Whether or not the calendar can be shared by me\n\tcanBeShared: false,\n\t// Whether or not the calendar can be published by me\n\tcanBePublished: false,\n\t// Reference to cdav-lib object\n\tdav: false,\n\t// All calendar-objects from this calendar that have already been fetched\n\tcalendarObjects: [],\n\t// Time-ranges that have already been fetched for this calendar\n\tfetchedTimeRanges: [],\n}, props)\n\n/**\n * Map a dav collection to our calendar object model\n *\n * @param {object} calendar The calendar object from the cdav library\n * @param {object=} currentUserPrincipal The principal model of the current user principal\n * @return {object}\n */\nconst mapDavCollectionToCalendar = (calendar, currentUserPrincipal) => {\n\tconst id = btoa(calendar.url)\n\tconst displayName = calendar.displayname || getCalendarUriFromUrl(calendar.url)\n\n\t// calendar.color can be set to anything on the server,\n\t// so make sure it's something that remotely looks like a color\n\tlet color = detectColor(calendar.color)\n\tif (!color) {\n\t\t// As fallback if we don't know what color that is supposed to be\n\t\tcolor = uidToHexColor(displayName)\n\t}\n\n\tconst supportsEvents = calendar.components.includes('VEVENT')\n\tconst supportsJournals = calendar.components.includes('VJOURNAL')\n\tconst supportsTasks = calendar.components.includes('VTODO')\n\tconst owner = calendar.owner\n\tconst readOnly = !calendar.isWriteable()\n\tconst canBeShared = calendar.isShareable()\n\tconst canBePublished = calendar.isPublishable()\n\tconst order = calendar.order || 0\n\tconst url = calendar.url\n\tconst publishURL = calendar.publishURL || null\n\tconst timezone = calendar.timezone || null\n\n\tlet isSharedWithMe = false\n\tif (!currentUserPrincipal) {\n\t\t// If the user is not authenticated, the calendar\n\t\t// will always be marked as shared with them\n\t\tisSharedWithMe = true\n\t} else {\n\t\tisSharedWithMe = (owner !== currentUserPrincipal.url)\n\t}\n\n\tlet enabled\n\tif (!currentUserPrincipal) {\n\t\t// If the user is not authenticated,\n\t\t// always enable the calendar\n\t\tenabled = true\n\t} else if (typeof calendar.enabled === 'boolean') {\n\t\t// If calendar-enabled is set, we will just take that\n\t\tenabled = calendar.enabled\n\t} else {\n\t\t// If there is no calendar-enabled,\n\t\t// we will display the calendar by default and set enabled\n\t\tenabled = true\n\t\tcalendar.enabled = true\n\t}\n\n\tconst shares = []\n\tif (!!currentUserPrincipal && Array.isArray(calendar.shares)) {\n\t\tfor (const share of calendar.shares) {\n\t\t\tif (share.href === currentUserPrincipal.principalScheme) {\n\t\t\t\tcontinue\n\t\t\t}\n\n\t\t\tshares.push(mapDavShareeToCalendarShareObject(share))\n\t\t}\n\t}\n\n\treturn getDefaultCalendarObject({\n\t\tid,\n\t\tdisplayName,\n\t\tcolor,\n\t\torder,\n\t\turl,\n\t\tenabled,\n\t\tsupportsEvents,\n\t\tsupportsJournals,\n\t\tsupportsTasks,\n\t\tisSharedWithMe,\n\t\towner,\n\t\treadOnly,\n\t\tpublishURL,\n\t\tcanBeShared,\n\t\tcanBePublished,\n\t\tshares,\n\t\ttimezone,\n\t\tdav: calendar,\n\t})\n}\n\n/**\n * Gets the calendar uri from the url\n *\n * @param {string} url The url to get calendar uri from\n * @return {string}\n */\nfunction getCalendarUriFromUrl(url) {\n\tif (url.endsWith('/')) {\n\t\turl = url.substring(0, url.length - 1)\n\t}\n\n\treturn url.substring(url.lastIndexOf('/') + 1)\n}\n\nexport {\n\tgetDefaultCalendarObject,\n\tmapDavCollectionToCalendar,\n}\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <oc.list@georgehrke.com>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport { getParserManager } from '@nextcloud/calendar-js'\nimport {\n\tCOMPONENT_NAME_EVENT,\n\tCOMPONENT_NAME_JOURNAL,\n\tCOMPONENT_NAME_VTODO,\n} from './consts.js'\n\n/**\n * Creates a complete calendar-object-object based on given props\n *\n * @param {object} props Calendar-object-props already provided\n * @return {object}\n */\nconst getDefaultCalendarObjectObject = (props = {}) => Object.assign({}, {\n\t// Id of this calendar-object\n\tid: null,\n\t// Id of the associated calendar\n\tcalendarId: null,\n\t// The cdav-library object storing the calendar-object\n\tdav: null,\n\t// The parsed calendar-js object\n\tcalendarComponent: null,\n\t// The uid of the calendar-object\n\tuid: null,\n\t// The uri of the calendar-object\n\turi: null,\n\t// The type of calendar-object\n\tobjectType: null,\n\t// Whether or not the calendar-object is an event\n\tisEvent: false,\n\t// Whether or not the calendar-object is a journal\n\tisJournal: false,\n\t// Whether or not the calendar-object is a task\n\tisTodo: false,\n\t// Whether or not the calendar-object exists on the server\n\texistsOnServer: false,\n}, props)\n\n/**\n * Maps a calendar-object from c-dav to our calendar-object object\n *\n * @param {VObject} dav The c-dav VObject\n * @param {string} calendarId The calendar-id this object is associated with\n * @return {object}\n */\nconst mapCDavObjectToCalendarObject = (dav, calendarId) => {\n\tconst parserManager = getParserManager()\n\tconst parser = parserManager.getParserForFileType('text/calendar')\n\n\t// This should not be the case, but let's just be on the safe side\n\tif (typeof dav.data !== 'string' || dav.data.trim() === '') {\n\t\tthrow new Error('Empty calendar object')\n\t}\n\n\tparser.parse(dav.data)\n\tconst calendarComponentIterator = parser.getItemIterator()\n\tconst calendarComponent = calendarComponentIterator.next().value\n\tif (!calendarComponent) {\n\t\tthrow new Error('Empty calendar object')\n\t}\n\n\tconst vObjectIterator = calendarComponent.getVObjectIterator()\n\tconst firstVObject = vObjectIterator.next().value\n\n\treturn getDefaultCalendarObjectObject({\n\t\tid: btoa(dav.url),\n\t\tcalendarId,\n\t\tdav,\n\t\tcalendarComponent,\n\t\tuid: firstVObject.uid,\n\t\turi: dav.url,\n\t\tobjectType: firstVObject.name,\n\t\tisEvent: firstVObject.name === COMPONENT_NAME_EVENT,\n\t\tisJournal: firstVObject.name === COMPONENT_NAME_JOURNAL,\n\t\tisTodo: firstVObject.name === COMPONENT_NAME_VTODO,\n\t\texistsOnServer: true,\n\t})\n}\n\n/**\n * Maps a calendar-component from calendar-js to our calendar-object object\n *\n * @param {CalendarComponent} calendarComponent The calendarComponent to create the calendarObject from\n * @param {string=} calendarId The associated calendar if applicable\n * @return {object}\n */\nconst mapCalendarJsToCalendarObject = (calendarComponent, calendarId = null) => {\n\tconst vObjectIterator = calendarComponent.getVObjectIterator()\n\tconst firstVObject = vObjectIterator.next().value\n\tif (!firstVObject) {\n\t\tthrow new Error('Calendar object without vobjects')\n\t}\n\n\treturn getDefaultCalendarObjectObject({\n\t\tcalendarId,\n\t\tcalendarComponent,\n\t\tuid: firstVObject.uid,\n\t\tobjectType: firstVObject.name,\n\t\tisEvent: firstVObject.name === COMPONENT_NAME_EVENT,\n\t\tisJournal: firstVObject.name === COMPONENT_NAME_JOURNAL,\n\t\tisTodo: firstVObject.name === COMPONENT_NAME_VTODO,\n\t})\n}\n\nexport {\n\tgetDefaultCalendarObjectObject,\n\tmapCDavObjectToCalendarObject,\n\tmapCalendarJsToCalendarObject,\n}\n","/**\n * @copyright Copyright (c) 2020 Georg Ehrke\n *\n * @author Georg Ehrke <oc.list@georgehrke.com>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport {\n\tPRINCIPAL_PREFIX_CIRCLE,\n\tPRINCIPAL_PREFIX_GROUP,\n\tPRINCIPAL_PREFIX_USER,\n} from './consts.js'\n\n/**\n * Creates a complete calendar-share-object based on given props\n *\n * @param {object} props Calendar-share-props already provided\n * @return {object}\n */\nconst getDefaultCalendarShareObject = (props = {}) => Object.assign({}, {\n\t// Unique identifier\n\tid: null,\n\t// Displayname of the sharee\n\tdisplayName: null,\n\t// Whether or not share is writable\n\twriteable: false,\n\t// Whether or not sharee is an individual user\n\tisUser: false,\n\t// Whether or not sharee is an admin-defined group\n\tisGroup: false,\n\t// Whether or not sharee is a user-defined group\n\tisCircle: false,\n\t// Uri necessary for deleting / updating share\n\turi: null,\n}, props)\n\n/**\n * Map a dav collection to our calendar object model\n *\n * @param {object} sharee The sharee object from the cdav library shares\n * @return {object}\n */\nconst mapDavShareeToCalendarShareObject = (sharee) => {\n\t// sharee.href might contain non-latin characters, so let's uri encode it first\n\tconst id = btoa(encodeURI(sharee.href))\n\n\tlet displayName\n\tif (sharee['common-name'] && sharee['common-name'].trim() !== '') {\n\t\tdisplayName = sharee['common-name']\n\t} else if (sharee.href.startsWith(PRINCIPAL_PREFIX_GROUP)) {\n\t\tdisplayName = decodeURIComponent(sharee.href.slice(28))\n\t} else if (sharee.href.startsWith(PRINCIPAL_PREFIX_USER)) {\n\t\tdisplayName = decodeURIComponent(sharee.href.slice(27))\n\t} else {\n\t\tdisplayName = sharee.href\n\t}\n\n\tconst writeable = sharee.access[0].endsWith('read-write')\n\tconst isUser = sharee.href.startsWith(PRINCIPAL_PREFIX_USER)\n\tconst isGroup = sharee.href.startsWith(PRINCIPAL_PREFIX_GROUP)\n\tconst isCircle = sharee.href.startsWith(PRINCIPAL_PREFIX_CIRCLE)\n\tconst uri = sharee.href\n\n\treturn getDefaultCalendarShareObject({\n\t\tid,\n\t\tdisplayName,\n\t\twriteable,\n\t\tisUser,\n\t\tisGroup,\n\t\tisCircle,\n\t\turi,\n\t})\n}\n\nexport {\n\tgetDefaultCalendarShareObject,\n\tmapDavShareeToCalendarShareObject,\n}\n","/**\n * @copyright Copyright (c) 2020 Georg Ehrke\n *\n * @author Georg Ehrke <oc.list@georgehrke.com>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nconst COMPONENT_NAME_EVENT = 'VEVENT'\nconst COMPONENT_NAME_JOURNAL = 'VJOURNAL'\nconst COMPONENT_NAME_VTODO = 'VTODO'\n\nconst ITIP_MESSAGE_ADD = 'ADD'\nconst ITIP_MESSAGE_CANCEL = 'CANCEL'\nconst ITIP_MESSAGE_COUNTER = 'COUNTER'\nconst ITIP_MESSAGE_DECLINECOUNTER = 'DECLINECOUNTER'\nconst ITIP_MESSAGE_PUBLISH = 'PUBLISH'\nconst ITIP_MESSAGE_REFRESH = 'REFRESH'\nconst ITIP_MESSAGE_REPLY = 'REPLY'\nconst ITIP_MESSAGE_REQUEST = 'REQUEST'\n\nconst PRINCIPAL_PREFIX_USER = 'principal:principals/users/'\nconst PRINCIPAL_PREFIX_GROUP = 'principal:principals/groups/'\nconst PRINCIPAL_PREFIX_CIRCLE = 'principal:principals/circles/'\nconst PRINCIPAL_PREFIX_CALENDAR_RESOURCE = 'principal:principals/calendar-resources/'\nconst PRINCIPAL_PREFIX_CALENDAR_ROOM = 'principal:principals/calendar-rooms/'\n\nconst CALDAV_BIRTHDAY_CALENDAR = 'contact_birthdays'\n\nconst IMPORT_STAGE_DEFAULT = 'default'\nconst IMPORT_STAGE_IMPORTING = 'importing'\nconst IMPORT_STAGE_AWAITING_USER_SELECT = 'awaitingUserSelect'\nconst IMPORT_STAGE_PROCESSING = 'processing'\n\nexport {\n\tCOMPONENT_NAME_EVENT,\n\tCOMPONENT_NAME_JOURNAL,\n\tCOMPONENT_NAME_VTODO,\n\tITIP_MESSAGE_ADD,\n\tITIP_MESSAGE_CANCEL,\n\tITIP_MESSAGE_COUNTER,\n\tITIP_MESSAGE_DECLINECOUNTER,\n\tITIP_MESSAGE_PUBLISH,\n\tITIP_MESSAGE_REFRESH,\n\tITIP_MESSAGE_REPLY,\n\tITIP_MESSAGE_REQUEST,\n\tPRINCIPAL_PREFIX_USER,\n\tPRINCIPAL_PREFIX_GROUP,\n\tPRINCIPAL_PREFIX_CIRCLE,\n\tPRINCIPAL_PREFIX_CALENDAR_RESOURCE,\n\tPRINCIPAL_PREFIX_CALENDAR_ROOM,\n\tCALDAV_BIRTHDAY_CALENDAR,\n\tIMPORT_STAGE_DEFAULT,\n\tIMPORT_STAGE_IMPORTING,\n\tIMPORT_STAGE_AWAITING_USER_SELECT,\n\tIMPORT_STAGE_PROCESSING,\n}\n","/**\n * @copyright Copyright (c) 2020 Georg Ehrke\n *\n * @author Georg Ehrke <oc.list@georgehrke.com>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\nimport { getDateFromDateTimeValue } from '../utils/date.js'\nimport { DurationValue, DateTimeValue } from '@nextcloud/calendar-js'\nimport { getHexForColorName, getClosestCSS3ColorNameForHex } from '../utils/color.js'\nimport { mapAlarmComponentToAlarmObject } from './alarm.js'\nimport { mapAttendeePropertyToAttendeeObject } from './attendee.js'\nimport { mapAttachmentPropertyToAttchmentObject } from './attachment.js'\nimport {\n\tgetDefaultRecurrenceRuleObject,\n\tmapRecurrenceRuleValueToRecurrenceRuleObject,\n} from './recurrenceRule.js'\n\n/**\n * Creates a complete calendar-object-instance-object based on given props\n *\n * @param {object} props The props already provided\n * @return {object}\n */\nconst getDefaultEventObject = (props = {}) => Object.assign({}, {\n\t// The real event-component coming from calendar-js\n\teventComponent: null,\n\t// Title of the event\n\ttitle: null,\n\t// Start date of the event\n\tstartDate: null,\n\t// Timezone of the start date\n\tstartTimezoneId: null,\n\t// End date of the event\n\tendDate: null,\n\t// Timezone of the end date\n\tendTimezoneId: null,\n\t// Indicator whether or not event is all-day\n\tisAllDay: false,\n\t// Whether or not the user is allowed to toggle the all-day checkbox\n\tcanModifyAllDay: true,\n\t// Location that the event takes places in\n\tlocation: null,\n\t// description of the event\n\tdescription: null,\n\t// Access class of the event (PUBLIC, PRIVATE, CONFIDENTIAL)\n\taccessClass: null,\n\t// Status of the event (CONFIRMED, TENTATIVE, CANCELLED)\n\tstatus: null,\n\t// Whether or not to block this event in Free-Busy reports (TRANSPARENT, OPAQUE)\n\ttimeTransparency: null,\n\t// The recurrence rule of this event. We only support one recurrence-rule\n\trecurrenceRule: getDefaultRecurrenceRuleObject(),\n\t// Whether or not this event has multiple recurrence-rules\n\thasMultipleRRules: false,\n\t// Whether or not this is the master item\n\tisMasterItem: false,\n\t// Whether or not this is a recurrence-exception\n\tisRecurrenceException: false,\n\t// Whether or not the applied modifications require to update this and all future\n\tforceThisAndAllFuture: false,\n\t// Whether or not it's possible to create a recurrence-exception for this event\n\tcanCreateRecurrenceException: false,\n\t// Attendees of this event\n\tattendees: [],\n\t// Organizer of the event\n\torganizer: null,\n\t// Alarm of the event\n\talarms: [],\n\t// Custom color of the event\n\tcustomColor: null,\n\t// Categories\n\tcategories: [],\n\t// Attachments of this event\n\tattachments: [],\n}, props)\n\n/**\n *\n * @param {EventComponent} eventComponent The calendar-js eventComponent\n * @return {object}\n */\nconst mapEventComponentToEventObject = (eventComponent) => {\n\tconst eventObject = getDefaultEventObject({\n\t\teventComponent,\n\t\ttitle: eventComponent.title,\n\t\tisAllDay: eventComponent.isAllDay(),\n\t\tcanModifyAllDay: eventComponent.canModifyAllDay(),\n\t\tlocation: eventComponent.location,\n\t\tdescription: eventComponent.description,\n\t\taccessClass: eventComponent.accessClass,\n\t\tstatus: eventComponent.status,\n\t\ttimeTransparency: eventComponent.timeTransparency,\n\t\tcategories: Array.from(eventComponent.getCategoryIterator()),\n\t\tisMasterItem: eventComponent.isMasterItem(),\n\t\tisRecurrenceException: eventComponent.isRecurrenceException(),\n\t\tcanCreateRecurrenceException: eventComponent.canCreateRecurrenceExceptions(),\n\t})\n\n\t/**\n\t * According to RFC5545, DTEND is exclusive. This is rather intuitive for timed-events\n\t * but rather unintuitive for all-day events\n\t *\n\t * That's why, when an event is all-day from 2019-10-03 to 2019-10-04,\n\t * it will be displayed as 2019-10-03 to 2019-10-03 in the editor.\n\t */\n\teventObject.startDate = getDateFromDateTimeValue(eventComponent.startDate)\n\teventObject.startTimezoneId = eventComponent.startDate.timezoneId\n\n\tif (eventComponent.isAllDay()) {\n\t\tconst endDate = eventComponent.endDate.clone()\n\t\tendDate.addDuration(DurationValue.fromSeconds(-1 * 60 * 60 * 24))\n\t\teventObject.endDate = getDateFromDateTimeValue(endDate)\n\t} else {\n\t\teventObject.endDate = getDateFromDateTimeValue(eventComponent.endDate)\n\t}\n\teventObject.endTimezoneId = eventComponent.endDate.timezoneId\n\n\t/**\n\t * Extract organizer if there is any\n\t */\n\tif (eventComponent.organizer) {\n\t\tconst organizerProperty = eventComponent.getFirstProperty('ORGANIZER')\n\t\teventObject.organizer = {\n\t\t\tcommonName: organizerProperty.commonName,\n\t\t\turi: organizerProperty.email,\n\t\t\tattendeeProperty: organizerProperty,\n\t\t}\n\t}\n\n\t/**\n\t * Extract alarms\n\t */\n\tfor (const alarm of eventComponent.getAlarmIterator()) {\n\t\teventObject.alarms.push(mapAlarmComponentToAlarmObject(alarm))\n\t}\n\n\t/**\n\t * Extract attendees\n\t */\n\tfor (const attendee of eventComponent.getAttendeeIterator()) {\n\t\teventObject.attendees.push(mapAttendeePropertyToAttendeeObject(attendee))\n\t}\n\n\t/**\n\t * Extract attachments\n\t */\n\n\tfor (const attachment of eventComponent.getPropertyIterator('ATTACH')) {\n\t\teventObject.attachments.push(mapAttachmentPropertyToAttchmentObject(attachment))\n\t}\n\n\t/**\n\t * Extract recurrence-rule\n\t */\n\tconst recurrenceRuleIterator = eventComponent.getPropertyIterator('RRULE')\n\tconst recurrenceRuleFirstIteration = recurrenceRuleIterator.next()\n\n\tconst firstRecurrenceRule = recurrenceRuleFirstIteration.value\n\tif (firstRecurrenceRule) {\n\t\teventObject.recurrenceRule = mapRecurrenceRuleValueToRecurrenceRuleObject(firstRecurrenceRule.getFirstValue(), eventComponent.startDate)\n\t\teventObject.hasMultipleRRules = !recurrenceRuleIterator.next().done\n\t}\n\n\t/**\n\t * Convert the CSS 3 color name to a hex color\n\t */\n\tif (eventComponent.hasProperty('COLOR')) {\n\t\tconst hexColor = getHexForColorName(eventComponent.getFirstPropertyFirstValue('COLOR'))\n\t\tif (hexColor !== null) {\n\t\t\teventObject.customColor = hexColor\n\t\t}\n\t}\n\n\treturn eventObject\n}\n\n/**\n * Copy data from a calendar-object-instance into a calendar-js event-component\n *\n * @param {object} eventObject The calendar-object-instance object\n * @param {EventComponent} eventComponent The calendar-js EventComponent object\n */\nconst copyCalendarObjectInstanceIntoEventComponent = (eventObject, eventComponent) => {\n\teventComponent.title = eventObject.title\n\teventComponent.location = eventObject.location\n\teventComponent.description = eventObject.description\n\teventComponent.accessClass = eventObject.accessClass\n\teventComponent.status = eventObject.status\n\teventComponent.timeTransparency = eventObject.timeTransparency\n\n\tfor (const category of eventObject.categories) {\n\t\teventComponent.addCategory(category)\n\t}\n\n\tif (eventObject.organizer) {\n\t\teventComponent.setOrganizerFromNameAndEMail(eventObject.organizer.commonName, eventObject.organizer.uri)\n\t}\n\n\tfor (const alarm of eventObject.alarms) {\n\t\tif (alarm.isRelative) {\n\t\t\tconst duration = DurationValue.fromSeconds(alarm.relativeTrigger)\n\t\t\teventComponent.addRelativeAlarm(alarm.type, duration, alarm.relativeIsRelatedToStart)\n\t\t} else {\n\t\t\tconst date = DateTimeValue.fromJSDate(alarm.absoluteDate)\n\t\t\teventComponent.addAbsoluteAlarm(alarm.type, date)\n\t\t}\n\t}\n\n\tfor (const attendee of eventObject.attendees) {\n\t\teventComponent.addProperty(attendee.attendeeProperty)\n\t}\n\n\tfor (const rule of eventObject.eventComponent.getPropertyIterator('RRULE')) {\n\t\teventComponent.addProperty(rule)\n\t}\n\n\tif (eventObject.customColor) {\n\t\teventComponent.color = getClosestCSS3ColorNameForHex(eventObject.customColor)\n\t}\n}\n\nexport {\n\tgetDefaultEventObject,\n\tmapEventComponentToEventObject,\n\tcopyCalendarObjectInstanceIntoEventComponent,\n}\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <oc.list@georgehrke.com>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\nimport {\n\tPRINCIPAL_PREFIX_CALENDAR_RESOURCE,\n\tPRINCIPAL_PREFIX_CALENDAR_ROOM,\n\tPRINCIPAL_PREFIX_CIRCLE,\n\tPRINCIPAL_PREFIX_GROUP,\n\tPRINCIPAL_PREFIX_USER,\n} from './consts.js'\n\n/**\n * Creates a complete principal-object based on given props\n *\n * @param {object} props Principal-props already provided\n * @return {any}\n */\nconst getDefaultPrincipalObject = (props) => Object.assign({}, {\n\t// Id of the principal\n\tid: null,\n\t// Calendar-user-type. This can be INDIVIDUAL, GROUP, RESOURCE or ROOM\n\tcalendarUserType: 'INDIVIDUAL',\n\t// E-Mail address of principal used for scheduling\n\temailAddress: null,\n\t// The principals display-name\n\t// TODO: this should be renamed to displayName\n\tdisplayname: null,\n\t// principalScheme\n\tprincipalScheme: null,\n\t// The internal user-id in case it is of type INDIVIDUAL and a user\n\t// TODO: userId is deprecrated, use principalId instead\n\tuserId: null,\n\t// url to the DAV-principal-resource\n\turl: null,\n\t// The cdav-library object\n\tdav: null,\n\t// Whether or not this principal represents a circle\n\tisCircle: false,\n\t// Whether or not this principal represents a user\n\tisUser: false,\n\t// Whether or not this principal represents a group\n\tisGroup: false,\n\t// Whether or not this principal represents a calendar-resource\n\tisCalendarResource: false,\n\t// Whether or not this principal represents a calendar-room\n\tisCalendarRoom: false,\n\t// The id of the principal without prefix. e.g. userId / groupId / etc.\n\tprincipalId: null,\n}, props)\n\n/**\n * converts a dav principal into a vuex object\n *\n * @param {object} dav cdav-library Principal object\n * @return {object}\n */\nconst mapDavToPrincipal = (dav) => {\n\tconst id = btoa(encodeURI(dav.url))\n\tconst calendarUserType = dav.calendarUserType\n\tconst principalScheme = dav.principalScheme\n\tconst emailAddress = dav.email\n\n\tconst displayname = dav.displayname\n\n\tconst isUser = dav.principalScheme.startsWith(PRINCIPAL_PREFIX_USER)\n\tconst isGroup = dav.principalScheme.startsWith(PRINCIPAL_PREFIX_GROUP)\n\tconst isCircle = dav.principalScheme.startsWith(PRINCIPAL_PREFIX_CIRCLE)\n\tconst isCalendarResource = dav.principalScheme.startsWith(PRINCIPAL_PREFIX_CALENDAR_RESOURCE)\n\tconst isCalendarRoom = dav.principalScheme.startsWith(PRINCIPAL_PREFIX_CALENDAR_ROOM)\n\n\tlet principalId = null\n\tif (isUser) {\n\t\tprincipalId = dav.principalScheme.substring(PRINCIPAL_PREFIX_USER.length)\n\t} else if (isGroup) {\n\t\tprincipalId = dav.principalScheme.substring(PRINCIPAL_PREFIX_GROUP.length)\n\t} else if (isCircle) {\n\t\tprincipalId = dav.principalScheme.substring(PRINCIPAL_PREFIX_CIRCLE.length)\n\t} else if (isCalendarResource) {\n\t\tprincipalId = dav.principalScheme.substring(PRINCIPAL_PREFIX_CALENDAR_RESOURCE.length)\n\t} else if (isCalendarRoom) {\n\t\tprincipalId = dav.principalScheme.substring(PRINCIPAL_PREFIX_CALENDAR_ROOM.length)\n\t}\n\n\tconst url = dav.principalUrl\n\tconst userId = dav.userId\n\n\treturn getDefaultPrincipalObject({\n\t\tid,\n\t\tcalendarUserType,\n\t\tprincipalScheme,\n\t\temailAddress,\n\t\tdisplayname,\n\t\turl,\n\t\tdav,\n\t\tisUser,\n\t\tisGroup,\n\t\tisCircle,\n\t\tisCalendarResource,\n\t\tisCalendarRoom,\n\t\tprincipalId,\n\t\tuserId,\n\t})\n}\n\nexport {\n\tgetDefaultPrincipalObject,\n\tmapDavToPrincipal,\n}\n","/**\n * @copyright Copyright (c) 2020 Georg Ehrke\n *\n * @author Georg Ehrke <oc.list@georgehrke.com>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport { getWeekDayFromDate } from '../utils/recurrence.js'\nimport { getDateFromDateTimeValue } from '../utils/date.js'\n\n/**\n * Creates a complete recurrence-rule-object based on given props\n *\n * @param {object} props Recurrence-rule-object-props already provided\n * @return {object}\n */\nconst getDefaultRecurrenceRuleObject = (props = {}) => Object.assign({}, {\n\t// The calendar-js recurrence-rule value\n\trecurrenceRuleValue: null,\n\t// The frequency of the recurrence-rule (DAILY, WEEKLY, ...)\n\tfrequency: 'NONE',\n\t// The interval of the recurrence-rule, must be a positive integer\n\tinterval: 1,\n\t// Positive integer if recurrence-rule limited by count, null otherwise\n\tcount: null,\n\t// Date if recurrence-rule limited by date, null otherwise\n\t// We do not store a timezone here, since we only care about the date part\n\tuntil: null,\n\t// List of byDay components to limit/expand the recurrence-rule\n\tbyDay: [],\n\t// List of byMonth components to limit/expand the recurrence-rule\n\tbyMonth: [],\n\t// List of byMonthDay components to limit/expand the recurrence-rule\n\tbyMonthDay: [],\n\t// A position to limit the recurrence-rule (e.g. -1 for last Friday)\n\tbySetPosition: null,\n\t// Whether or not the rule is not supported for editing\n\tisUnsupported: false,\n}, props)\n\n/**\n * Maps a calendar-js recurrence-rule-value to an recurrence-rule-object\n *\n * @param {RecurValue} recurrenceRuleValue The calendar-js recurrence rule value\n * @param {DateTimeValue} baseDate The base-date used to fill unset values\n * @return {object}\n */\nconst mapRecurrenceRuleValueToRecurrenceRuleObject = (recurrenceRuleValue, baseDate) => {\n\tswitch (recurrenceRuleValue.frequency) {\n\tcase 'DAILY':\n\t\treturn mapDailyRuleValueToRecurrenceRuleObject(recurrenceRuleValue)\n\n\tcase 'WEEKLY':\n\t\treturn mapWeeklyRuleValueToRecurrenceRuleObject(recurrenceRuleValue, baseDate)\n\n\tcase 'MONTHLY':\n\t\treturn mapMonthlyRuleValueToRecurrenceRuleObject(recurrenceRuleValue, baseDate)\n\n\tcase 'YEARLY':\n\t\treturn mapYearlyRuleValueToRecurrenceRuleObject(recurrenceRuleValue, baseDate)\n\n\tdefault: // SECONDLY, MINUTELY, HOURLY\n\t\treturn getDefaultRecurrenceRuleObjectForRecurrenceValue(recurrenceRuleValue, {\n\t\t\tisUnsupported: true,\n\t\t})\n\t}\n}\n\nconst FORBIDDEN_BY_PARTS_DAILY = [\n\t'BYSECOND',\n\t'BYMINUTE',\n\t'BYHOUR',\n\t'BYDAY',\n\t'BYMONTHDAY',\n\t'BYYEARDAY',\n\t'BYWEEKNO',\n\t'BYMONTH',\n\t'BYSETPOS',\n]\nconst FORBIDDEN_BY_PARTS_WEEKLY = [\n\t'BYSECOND',\n\t'BYMINUTE',\n\t'BYHOUR',\n\t'BYMONTHDAY',\n\t'BYYEARDAY',\n\t'BYWEEKNO',\n\t'BYMONTH',\n\t'BYSETPOS',\n]\nconst FORBIDDEN_BY_PARTS_MONTHLY = [\n\t'BYSECOND',\n\t'BYMINUTE',\n\t'BYHOUR',\n\t'BYYEARDAY',\n\t'BYWEEKNO',\n\t'BYMONTH',\n]\nconst FORBIDDEN_BY_PARTS_YEARLY = [\n\t'BYSECOND',\n\t'BYMINUTE',\n\t'BYHOUR',\n\t'BYMONTHDAY',\n\t'BYYEARDAY',\n\t'BYWEEKNO',\n]\n\nconst SUPPORTED_BY_DAY_WEEKLY = [\n\t'SU',\n\t'MO',\n\t'TU',\n\t'WE',\n\t'TH',\n\t'FR',\n\t'SA',\n]\n\n/**\n * Get all numbers between start and end as strings\n *\n * @param {number} start Lower end of range\n * @param {number} end Upper end of range\n * @return {string[]}\n */\nconst getRangeAsStrings = (start, end) => {\n\treturn Array\n\t\t.apply(null, Array((end - start) + 1))\n\t\t.map((_, n) => n + start)\n\t\t.map((s) => s.toString())\n}\n\nconst SUPPORTED_BY_MONTHDAY_MONTHLY = getRangeAsStrings(1, 31)\n\nconst SUPPORTED_BY_MONTH_YEARLY = getRangeAsStrings(1, 12)\n\n/**\n * Maps a daily calendar-js recurrence-rule-value to an recurrence-rule-object\n *\n * @param {RecurValue} recurrenceRuleValue The calendar-js recurrence rule value\n * @return {object}\n */\nconst mapDailyRuleValueToRecurrenceRuleObject = (recurrenceRuleValue) => {\n\t/**\n\t * We only support DAILY rules without any by-parts in the editor.\n\t * If the recurrence-rule contains any by-parts, mark it as unsupported.\n\t */\n\tconst isUnsupported = containsRecurrenceComponent(recurrenceRuleValue, FORBIDDEN_BY_PARTS_DAILY)\n\n\treturn getDefaultRecurrenceRuleObjectForRecurrenceValue(recurrenceRuleValue, {\n\t\tisUnsupported,\n\t})\n}\n\n/**\n * Maps a weekly calendar-js recurrence-rule-value to an recurrence-rule-object\n *\n * @param {RecurValue} recurrenceRuleValue The calendar-js recurrence rule value\n * @param {DateTimeValue} baseDate The base-date used to fill unset values\n * @return {object}\n */\nconst mapWeeklyRuleValueToRecurrenceRuleObject = (recurrenceRuleValue, baseDate) => {\n\t/**\n\t * For WEEKLY recurrences, our editor only allows BYDAY\n\t *\n\t * As defined in RFC5545 3.3.10. Recurrence Rule:\n\t * > Each BYDAY value can also be preceded by a positive (+n) or\n\t * > negative (-n) integer.  If present, this indicates the nth\n\t * > occurrence of a specific day within the MONTHLY or YEARLY \"RRULE\".\n\t *\n\t * RFC 5545 specifies other components, which can be used along WEEKLY.\n\t * Among them are BYMONTH and BYSETPOS. We don't support those.\n\t */\n\tconst containsUnsupportedByParts = containsRecurrenceComponent(recurrenceRuleValue, FORBIDDEN_BY_PARTS_WEEKLY)\n\tconst containsInvalidByDayPart = recurrenceRuleValue.getComponent('BYDAY')\n\t\t.some((weekday) => !SUPPORTED_BY_DAY_WEEKLY.includes(weekday))\n\n\tconst isUnsupported = containsUnsupportedByParts || containsInvalidByDayPart\n\n\tconst byDay = recurrenceRuleValue.getComponent('BYDAY')\n\t\t.filter((weekday) => SUPPORTED_BY_DAY_WEEKLY.includes(weekday))\n\n\t// If the BYDAY is empty, add the day that the event occurs in\n\t// E.g. if the event is on a Wednesday, automatically set BYDAY:WE\n\tif (byDay.length === 0) {\n\t\tbyDay.push(getWeekDayFromDate(baseDate.jsDate))\n\t}\n\n\treturn getDefaultRecurrenceRuleObjectForRecurrenceValue(recurrenceRuleValue, {\n\t\tbyDay,\n\t\tisUnsupported,\n\t})\n}\n\n/**\n * Maps a monthly calendar-js recurrence-rule-value to an recurrence-rule-object\n *\n * @param {RecurValue} recurrenceRuleValue The calendar-js recurrence rule value\n * @param {DateTimeValue} baseDate The base-date used to fill unset values\n * @return {object}\n */\nconst mapMonthlyRuleValueToRecurrenceRuleObject = (recurrenceRuleValue, baseDate) => {\n\t/**\n\t * We only supports BYMONTHDAY, BYDAY, BYSETPOS in order to expand the monthly rule.\n\t * It supports either BYMONTHDAY or the combination of BYDAY and BYSETPOS. They have to be used exclusively\n\t * and cannot be combined.\n\t *\n\t * We do not support other BY-parts like BYMONTH\n\t *\n\t * For monthly recurrence-rules, BYDAY components are allowed to be preceded by positive or negative integers.\n\t * The Nextcloud-editor supports at most one BYDAY component with an integer.\n\t * If it's presented with such a BYDAY component, it will internally be converted to BYDAY without integer and BYSETPOS.\n\t * e.g.\n\t * BYDAY=3WE => BYDAY=WE,BYSETPOS=3\n\t *\n\t * BYSETPOS is limited to -2, -1, 1, 2, 3, 4, 5\n\t * Other values are not supported\n\t *\n\t * BYDAY is limited to \"MO\", \"TU\", \"WE\", \"TH\", \"FR\", \"SA\", \"SU\",\n\t * \"MO,TU,WE,TH,FR,SA,SU\", \"MO,TU,WE,TH,FR\", \"SA,SU\"\n\t *\n\t * BYMONTHDAY is limited to \"1\", \"2\", ..., \"31\"\n\t */\n\tlet isUnsupported = containsRecurrenceComponent(recurrenceRuleValue, FORBIDDEN_BY_PARTS_MONTHLY)\n\n\tlet byDay = []\n\tlet bySetPosition = null\n\tlet byMonthDay = []\n\n\t// This handles the first case, where we have a BYMONTHDAY rule\n\tif (containsRecurrenceComponent(recurrenceRuleValue, ['BYMONTHDAY'])) {\n\t\t// verify there is no BYDAY or BYSETPOS at the same time\n\t\tif (containsRecurrenceComponent(recurrenceRuleValue, ['BYDAY', 'BYSETPOS'])) {\n\t\t\tisUnsupported = true\n\t\t}\n\n\t\tconst containsInvalidByMonthDay = recurrenceRuleValue.getComponent('BYMONTHDAY')\n\t\t\t.some((monthDay) => !SUPPORTED_BY_MONTHDAY_MONTHLY.includes(monthDay.toString()))\n\t\tisUnsupported = isUnsupported || containsInvalidByMonthDay\n\n\t\tbyMonthDay = recurrenceRuleValue.getComponent('BYMONTHDAY')\n\t\t\t.filter((monthDay) => SUPPORTED_BY_MONTHDAY_MONTHLY.includes(monthDay.toString()))\n\t\t\t.map((monthDay) => monthDay.toString())\n\n\t\t// This handles cases where we have both BYDAY and BYSETPOS\n\t} else if (containsRecurrenceComponent(recurrenceRuleValue, ['BYDAY']) && containsRecurrenceComponent(recurrenceRuleValue, ['BYSETPOS'])) {\n\n\t\tif (isAllowedByDay(recurrenceRuleValue.getComponent('BYDAY'))) {\n\t\t\tbyDay = recurrenceRuleValue.getComponent('BYDAY')\n\t\t} else {\n\t\t\tbyDay = ['MO', 'TU', 'WE', 'TH', 'FR', 'SA', 'SU']\n\t\t\tisUnsupported = true\n\t\t}\n\n\t\tconst setPositionArray = recurrenceRuleValue.getComponent('BYSETPOS')\n\t\tif (setPositionArray.length === 1 && isAllowedBySetPos(setPositionArray[0])) {\n\t\t\tbySetPosition = setPositionArray[0]\n\t\t} else {\n\t\t\tbySetPosition = 1\n\t\t\tisUnsupported = true\n\t\t}\n\n\t\t// This handles cases where we only have a BYDAY\n\t} else if (containsRecurrenceComponent(recurrenceRuleValue, ['BYDAY'])) {\n\n\t\tconst byDayArray = recurrenceRuleValue.getComponent('BYDAY')\n\n\t\tif (byDayArray.length > 1) {\n\t\t\tbyMonthDay.push(baseDate.day.toString())\n\t\t\tisUnsupported = true\n\t\t} else {\n\t\t\tconst firstElement = byDayArray[0]\n\n\t\t\tconst match = /^(-?\\d)([A-Z]{2})$/.exec(firstElement)\n\t\t\tif (match) {\n\t\t\t\tconst matchedBySetPosition = match[1]\n\t\t\t\tconst matchedByDay = match[2]\n\n\t\t\t\tif (isAllowedBySetPos(matchedBySetPosition)) {\n\t\t\t\t\tbyDay = [matchedByDay]\n\t\t\t\t\tbySetPosition = parseInt(matchedBySetPosition, 10)\n\t\t\t\t} else {\n\t\t\t\t\tbyDay = [matchedByDay]\n\t\t\t\t\tbySetPosition = 1\n\t\t\t\t\tisUnsupported = true\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tbyMonthDay.push(baseDate.day.toString())\n\t\t\t\tisUnsupported = true\n\t\t\t}\n\t\t}\n\n\t\t// This is a fallback where we just default BYMONTHDAY to the start date of the event\n\t} else {\n\t\tbyMonthDay.push(baseDate.day.toString())\n\t}\n\n\treturn getDefaultRecurrenceRuleObjectForRecurrenceValue(recurrenceRuleValue, {\n\t\tbyDay,\n\t\tbySetPosition,\n\t\tbyMonthDay,\n\t\tisUnsupported,\n\t})\n}\n\n/**\n * Maps a yearly calendar-js recurrence-rule-value to an recurrence-rule-object\n *\n * @param {RecurValue} recurrenceRuleValue The calendar-js recurrence rule value\n * @param {DateTimeValue} baseDate The base-date used to fill unset values\n * @return {object}\n */\nconst mapYearlyRuleValueToRecurrenceRuleObject = (recurrenceRuleValue, baseDate) => {\n\t/**\n\t * We only supports BYMONTH, BYDAY, BYSETPOS in order to expand the yearly rule.\n\t * It supports a combination of them.\n\t *\n\t * We do not support other BY-parts.\n\t *\n\t * For yearly recurrence-rules, BYDAY components are allowed to be preceded by positive or negative integers.\n\t * The Nextcloud-editor supports at most one BYDAY component with an integer.\n\t * If it's presented with such a BYDAY component, it will internally be converted to BYDAY without integer and BYSETPOS.\n\t * e.g.\n\t * BYDAY=3WE => BYDAY=WE,BYSETPOS=3\n\t *\n\t * BYSETPOS is limited to -2, -1, 1, 2, 3, 4, 5\n\t * Other values are not supported\n\t *\n\t * BYDAY is limited to \"MO\", \"TU\", \"WE\", \"TH\", \"FR\", \"SA\", \"SU\",\n\t * \"MO,TU,WE,TH,FR,SA,SU\", \"MO,TU,WE,TH,FR\", \"SA,SU\"\n\t */\n\tlet isUnsupported = containsRecurrenceComponent(recurrenceRuleValue, FORBIDDEN_BY_PARTS_YEARLY)\n\n\tlet byDay = []\n\tlet bySetPosition = null\n\tlet byMonth = []\n\n\tif (containsRecurrenceComponent(recurrenceRuleValue, ['BYMONTH'])) {\n\t\tconst containsInvalidByMonthDay = recurrenceRuleValue.getComponent('BYMONTH')\n\t\t\t.some((month) => !SUPPORTED_BY_MONTH_YEARLY.includes(month.toString()))\n\t\tisUnsupported = isUnsupported || containsInvalidByMonthDay\n\n\t\tbyMonth = recurrenceRuleValue.getComponent('BYMONTH')\n\t\t\t.filter((monthDay) => SUPPORTED_BY_MONTH_YEARLY.includes(monthDay.toString()))\n\t\t\t.map((month) => month.toString())\n\t} else {\n\t\tbyMonth.push(baseDate.month.toString())\n\t}\n\n\tif (containsRecurrenceComponent(recurrenceRuleValue, ['BYDAY']) && containsRecurrenceComponent(recurrenceRuleValue, ['BYSETPOS'])) {\n\n\t\tif (isAllowedByDay(recurrenceRuleValue.getComponent('BYDAY'))) {\n\t\t\tbyDay = recurrenceRuleValue.getComponent('BYDAY')\n\t\t} else {\n\t\t\tbyDay = ['MO', 'TU', 'WE', 'TH', 'FR', 'SA', 'SU']\n\t\t\tisUnsupported = true\n\t\t}\n\n\t\tconst setPositionArray = recurrenceRuleValue.getComponent('BYSETPOS')\n\t\tif (setPositionArray.length === 1 && isAllowedBySetPos(setPositionArray[0])) {\n\t\t\tbySetPosition = setPositionArray[0]\n\t\t} else {\n\t\t\tbySetPosition = 1\n\t\t\tisUnsupported = true\n\t\t}\n\n\t} else if (containsRecurrenceComponent(recurrenceRuleValue, ['BYDAY'])) {\n\n\t\tconst byDayArray = recurrenceRuleValue.getComponent('BYDAY')\n\t\tif (byDayArray.length > 1) {\n\t\t\tisUnsupported = true\n\t\t} else {\n\t\t\tconst firstElement = byDayArray[0]\n\n\t\t\tconst match = /^(-?\\d)([A-Z]{2})$/.exec(firstElement)\n\t\t\tif (match) {\n\t\t\t\tconst matchedBySetPosition = match[1]\n\t\t\t\tconst matchedByDay = match[2]\n\n\t\t\t\tif (isAllowedBySetPos(matchedBySetPosition)) {\n\t\t\t\t\tbyDay = [matchedByDay]\n\t\t\t\t\tbySetPosition = parseInt(matchedBySetPosition, 10)\n\t\t\t\t} else {\n\t\t\t\t\tbyDay = [matchedByDay]\n\t\t\t\t\tbySetPosition = 1\n\t\t\t\t\tisUnsupported = true\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tisUnsupported = true\n\t\t\t}\n\t\t}\n\t}\n\n\treturn getDefaultRecurrenceRuleObjectForRecurrenceValue(recurrenceRuleValue, {\n\t\tbyDay,\n\t\tbySetPosition,\n\t\tbyMonth,\n\t\tisUnsupported,\n\t})\n}\n\n/**\n * Checks if the given parameter is a supported BYDAY value\n *\n * @param {string[]} byDay The byDay component to check\n * @return {boolean}\n */\nconst isAllowedByDay = (byDay) => {\n\treturn [\n\t\t'MO',\n\t\t'TU',\n\t\t'WE',\n\t\t'TH',\n\t\t'FR',\n\t\t'SA',\n\t\t'SU',\n\t\t'FR,MO,SA,SU,TH,TU,WE',\n\t\t'FR,MO,TH,TU,WE',\n\t\t'SA,SU',\n\t].includes(byDay.slice().sort().join(','))\n}\n\n/**\n * Checks if the given parameter is a supported BYSETPOS value\n *\n * @param {string} bySetPos The bySetPos component to check\n * @return {boolean}\n */\nconst isAllowedBySetPos = (bySetPos) => {\n\treturn [\n\t\t'-2',\n\t\t'-1',\n\t\t'1',\n\t\t'2',\n\t\t'3',\n\t\t'4',\n\t\t'5',\n\t].includes(bySetPos.toString())\n}\n\n/**\n * Checks if the recurrence-rule contains any of the given components\n *\n * @param {RecurValue} recurrenceRule The recurrence-rule value to check for the given components\n * @param {string[]} components List of components to check for\n * @return {boolean}\n */\nconst containsRecurrenceComponent = (recurrenceRule, components) => {\n\tfor (const component of components) {\n\t\tconst componentValue = recurrenceRule.getComponent(component)\n\t\tif (componentValue.length > 0) {\n\t\t\treturn true\n\t\t}\n\t}\n\n\treturn false\n}\n\n/**\n * Returns a full recurrence-rule-object with default values derived from recurrenceRuleValue\n * and additional props\n *\n * @param {RecurValue} recurrenceRuleValue The recurrence-rule value to get default values from\n * @param {object} props The properties to provide on top of default one\n * @return {object}\n */\nconst getDefaultRecurrenceRuleObjectForRecurrenceValue = (recurrenceRuleValue, props) => {\n\tconst isUnsupported = recurrenceRuleValue.count !== null && recurrenceRuleValue.until !== null\n\tlet isUnsupportedProps = {}\n\n\tif (isUnsupported) {\n\t\tisUnsupportedProps = {\n\t\t\tisUnsupported,\n\t\t}\n\t}\n\n\treturn getDefaultRecurrenceRuleObject(Object.assign({}, {\n\t\trecurrenceRuleValue,\n\t\tfrequency: recurrenceRuleValue.frequency,\n\t\tinterval: parseInt(recurrenceRuleValue.interval, 10) || 1,\n\t\tcount: recurrenceRuleValue.count,\n\t\tuntil: recurrenceRuleValue.until\n\t\t\t? getDateFromDateTimeValue(recurrenceRuleValue.until)\n\t\t\t: null,\n\t}, props, isUnsupportedProps))\n}\n\nexport {\n\tgetDefaultRecurrenceRuleObject,\n\tmapRecurrenceRuleValueToRecurrenceRuleObject,\n}\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <oc.list@georgehrke.com>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport { translate as t } from '@nextcloud/l10n'\nimport { getDefaultCategories } from '../defaults/defaultCategories.js'\n\n/**\n * Gets all supported RFC properties\n *\n * @return {{color: {readableName: *, icon: string, multiple: boolean, info: *}, timeTransparency: {readableName: *, defaultValue: string, icon: string, multiple: boolean, options: *[], info: *}, description: {readableName: *, icon: string, placeholder: *, defaultNumberOfRows: number}, location: {readableName: *, icon: string, placeholder: *}, categories: {readableName: *, icon: string, multiple: boolean, options: *, tagPlaceholder: *, placeholder: *, info: *}, accessClass: {readableName: *, defaultValue: string, icon: string, options: *[], multiple: boolean, info: *}, status: {readableName: *, defaultValue: string, icon: string, options: *[], multiple: boolean, info: *}}}\n */\nconst getRFCProperties = () => {\n\treturn {\n\t\t/**\n\t\t * https://tools.ietf.org/html/rfc5545#section-3.8.1.3\n\t\t */\n\t\taccessClass: {\n\t\t\treadableName: t('calendar', 'When shared show'),\n\t\t\ticon: 'Eye',\n\t\t\toptions: [\n\t\t\t\t{ value: 'PUBLIC', label: t('calendar', 'When shared show full event') },\n\t\t\t\t{ value: 'CONFIDENTIAL', label: t('calendar', 'When shared show only busy') },\n\t\t\t\t{ value: 'PRIVATE', label: t('calendar', 'When shared hide this event') },\n\t\t\t],\n\t\t\tmultiple: false,\n\t\t\tinfo: t('calendar', 'The visibility of this event in shared calendars.'),\n\t\t\tdefaultValue: 'PUBLIC',\n\t\t},\n\t\t/**\n\t\t * https://tools.ietf.org/html/rfc5545#section-3.8.1.7\n\t\t */\n\t\tlocation: {\n\t\t\treadableName: t('calendar', 'Location'),\n\t\t\tplaceholder: t('calendar', 'Add a location'),\n\t\t\ticon: 'MapMarker',\n\t\t},\n\t\t/**\n\t\t * https://tools.ietf.org/html/rfc5545#section-3.8.1.5\n\t\t */\n\t\tdescription: {\n\t\t\treadableName: t('calendar', 'Description'),\n\t\t\tplaceholder: t('calendar', 'Add a description'),\n\t\t\ticon: 'TextBoxOutline',\n\t\t\tdefaultNumberOfRows: 2,\n\t\t},\n\t\t/**\n\t\t * https://tools.ietf.org/html/rfc5545#section-3.8.1.11\n\t\t */\n\t\tstatus: {\n\t\t\treadableName: t('calendar', 'Status'),\n\t\t\ticon: 'Check',\n\t\t\toptions: [\n\t\t\t\t{ value: 'CONFIRMED', label: t('calendar', 'Confirmed') },\n\t\t\t\t{ value: 'TENTATIVE', label: t('calendar', 'Tentative') },\n\t\t\t\t{ value: 'CANCELLED', label: t('calendar', 'Canceled') },\n\t\t\t],\n\t\t\tmultiple: false,\n\t\t\tinfo: t('calendar', 'Confirmation about the overall status of the event.'),\n\t\t\tdefaultValue: 'CONFIRMED',\n\t\t},\n\t\t/**\n\t\t * https://tools.ietf.org/html/rfc5545#section-3.8.2.7\n\t\t */\n\t\ttimeTransparency: {\n\t\t\treadableName: t('calendar', 'Show as'),\n\t\t\ticon: 'Briefcase',\n\t\t\tmultiple: false,\n\t\t\tinfo: t('calendar', 'Take this event into account when calculating free-busy information.'),\n\t\t\toptions: [\n\t\t\t\t{ value: 'TRANSPARENT', label: t('calendar', 'Free') },\n\t\t\t\t{ value: 'OPAQUE', label: t('calendar', 'Busy') },\n\t\t\t],\n\t\t\tdefaultValue: 'TRANSPARENT',\n\t\t},\n\t\t/**\n\t\t * https://tools.ietf.org/html/rfc5545#section-3.8.1.2\n\t\t */\n\t\tcategories: {\n\t\t\treadableName: t('calendar', 'Categories'),\n\t\t\ticon: 'Tag',\n\t\t\tmultiple: true,\n\t\t\tinfo: t('calendar', 'Categories help you to structure and organize your events.'),\n\t\t\tplaceholder: t('calendar', 'Search or add categories'),\n\t\t\ttagPlaceholder: t('calendar', 'Add this as a new category'),\n\t\t\toptions: getDefaultCategories(),\n\t\t},\n\t\t/**\n\t\t * https://tools.ietf.org/html/rfc7986#section-5.9\n\t\t */\n\t\tcolor: {\n\t\t\treadableName: t('calendar', 'Custom color'),\n\t\t\ticon: 'EyedropperVariant',\n\t\t\tmultiple: false,\n\t\t\tinfo: t('calendar', 'Special color of this event. Overrides the calendar-color.'),\n\t\t},\n\t}\n}\n\nexport {\n\tgetRFCProperties,\n}\n","/**\n * @copyright Copyright (c) 2021 Richard Steinmetz <richard@steinmetz.cloud>\n *\n * @author Richard Steinmetz <richard@steinmetz.cloud>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\nimport { generateUrl } from '@nextcloud/router'\nimport axios from '@nextcloud/axios'\nimport AppointmentConfig from '../models/appointmentConfig.js'\nimport logger from '../utils/logger.js'\n\n/**\n * Create a new appointment config in the backend\n *\n * @param {AppointmentConfig} config The config to save\n * @return {Promise<AppointmentConfig>} Full appointment config with an id\n */\nexport async function createConfig(config) {\n\tlogger.debug('Creating appointment config', { config })\n\tconst url = generateUrl('/apps/calendar/v1/appointment_configs')\n\n\tconst response = await axios.post(url, config)\n\treturn new AppointmentConfig(response.data.data)\n}\n\n/**\n * Delete a stored appointment config from the backend\n *\n * @param {number} id The id of the config\n * @return {Promise<void>}\n */\nexport async function deleteConfig(id) {\n\tlogger.debug('Deleting appointment config', { id })\n\tconst url = generateUrl('/apps/calendar/v1/appointment_configs/{id}', {\n\t\tid,\n\t})\n\n\tawait axios.delete(url)\n}\n\n/**\n * Update an appointment config in the backend\n *\n * @param {AppointmentConfig} config The config to update\n * @return {Promise<AppointmentConfig>} Updated appointment config as stored in the backend\n */\nexport async function updateConfig(config) {\n\tlogger.debug('Updating appointment config', { config })\n\tconst url = generateUrl('/apps/calendar/v1/appointment_configs/{id}', {\n\t\tid: config.id,\n\t})\n\n\tconst response = await axios.put(url, config)\n\treturn new AppointmentConfig(response.data.data)\n}\n","/**\n * @copyright Copyright (c) 2020 Georg Ehrke\n *\n * @author Georg Ehrke <oc.list@georgehrke.com>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport DavClient from '@nextcloud/cdav-library'\nimport { generateRemoteUrl } from '@nextcloud/router'\nimport { getRequestToken } from '@nextcloud/auth'\nimport { CALDAV_BIRTHDAY_CALENDAR } from '../models/consts.js'\n\nconst clients = {}\n\nconst getClientKey = (headers) => JSON.stringify(headers)\n\nconst getClient = (headers = {}) => {\n\tconst clientKey = getClientKey(headers)\n\tif (clients[clientKey]) {\n\t\treturn clients[clientKey]\n\t}\n\n\tclients[clientKey] = new DavClient({\n\t\trootUrl: generateRemoteUrl('dav'),\n\t}, () => {\n\t\tconst mergedHeaders = {\n\t\t\t'X-Requested-With': 'XMLHttpRequest',\n\t\t\trequesttoken: getRequestToken(),\n\t\t\t'X-NC-CalDAV-Webcal-Caching': 'On',\n\t\t\t...headers,\n\t\t}\n\t\tconst xhr = new XMLHttpRequest()\n\t\tconst oldOpen = xhr.open\n\n\t\t// override open() method to add headers\n\t\txhr.open = function() {\n\t\t\tconst result = oldOpen.apply(this, arguments)\n\t\t\tfor (const name in mergedHeaders) {\n\t\t\t\txhr.setRequestHeader(name, mergedHeaders[name])\n\t\t\t}\n\n\t\t\treturn result\n\t\t}\n\n\t\tOC.registerXHRForErrorProcessing(xhr) // eslint-disable-line no-undef\n\t\treturn xhr\n\t})\n\n\treturn clients[clientKey]\n}\n\n/**\n * Initializes the client for use in the user-view\n */\nconst initializeClientForUserView = async () => {\n\tawait getClient().connect({ enableCalDAV: true })\n}\n\n/**\n * Initializes the client for use in the public/embed-view\n */\nconst initializeClientForPublicView = async () => {\n\tawait getClient()._createPublicCalendarHome()\n}\n\n/**\n * Fetch all calendars from the server\n *\n * @param {object} headers\n * @return {Promise<CalendarHome>}\n */\nconst getCalendarHome = (headers) => getClient(headers).calendarHomes[0]\n\n/**\n * Fetch all collections in the calendar home from the server\n *\n * @return {Promise<Collection[]>}\n */\nconst findAll = () => {\n\treturn getCalendarHome().findAllCalDAVCollectionsGrouped()\n}\n\n/**\n * Fetch all subscriptions in the calendar home from the server\n */\nexport const findAllSubscriptions = async () => {\n\tconst headers = {\n\t\t'X-NC-CalDAV-Webcal-Caching': 'Off',\n\t}\n\n\t// Ensure the client is initialized once\n\tawait getClient(headers).connect({ enableCalDAV: true })\n\n\treturn getCalendarHome(headers).findAllSubscriptions()\n}\n\n/**\n * Fetch all deleted calendars from the server\n *\n * @return {Promise<Calendar[]>}\n */\nconst findAllDeletedCalendars = () => {\n\treturn getCalendarHome().findAllDeletedCalendars()\n}\n\n/**\n * Fetch public calendars by their token\n *\n * @param {string[]} tokens List of tokens\n * @return {Promise<Calendar[]>}\n */\nconst findPublicCalendarsByTokens = async (tokens) => {\n\tconst findPromises = []\n\n\tfor (const token of tokens) {\n\t\tconst promise = getClient().publicCalendarHome\n\t\t\t.find(token)\n\t\t\t.catch(() => null) // Catch outdated tokens\n\n\t\tfindPromises.push(promise)\n\t}\n\n\tconst calendars = await Promise.all(findPromises)\n\treturn calendars.filter((calendar) => calendar !== null)\n}\n\n/**\n * Fetches all scheduling inboxes\n *\n * Nitpick detail: Technically, we shouldn't be querying all scheduling inboxes\n * in the calendar-home and just take the first one, but rather query the\n * \"CALDAV:schedule-inbox-URL\" property on the principal URL and take that one.\n * However, it doesn't make any difference for the Nextcloud CalDAV server\n * and saves us extraneous requests here.\n *\n * https://tools.ietf.org/html/rfc6638#section-2.2.1\n *\n * @return {Promise<ScheduleInbox[]>}\n */\nconst findSchedulingInbox = async () => {\n\tconst inboxes = await getCalendarHome().findAllScheduleInboxes()\n\treturn inboxes[0]\n}\n\n/**\n * Fetches all scheduling outboxes\n *\n * Nitpick detail: Technically, we shouldn't be querying all scheduling outboxes\n * in the calendar-home and just take the first one, but rather query the\n * \"CALDAV:schedule-outbox-URL\" property on the principal URL and take that one.\n * However, it doesn't make any difference for the Nextcloud CalDAV server\n * and saves us extraneous requests here.\n *\n * https://tools.ietf.org/html/rfc6638#section-2.1.1\n *\n * @return {Promise<ScheduleOutbox>}\n */\nconst findSchedulingOutbox = async () => {\n\tconst outboxes = await getCalendarHome().findAllScheduleOutboxes()\n\treturn outboxes[0]\n}\n\n/**\n * Creates a calendar\n *\n * @param {string} displayName Visible name\n * @param {string} color Color\n * @param {string[]} components Supported component set\n * @param {number} order Order of calendar in list\n * @param {string} timezoneIcs ICS representation of timezone\n * @return {Promise<Calendar>}\n */\nconst createCalendar = async (displayName, color, components, order, timezoneIcs) => {\n\treturn getCalendarHome().createCalendarCollection(displayName, color, components, order, timezoneIcs)\n}\n\n/**\n * Creates a subscription\n *\n * This function does not return a subscription, but a cached calendar\n *\n * @param {string} displayName Visible name\n * @param {string} color Color\n * @param {string} source Link to WebCAL Source\n * @param {number} order Order of calendar in list\n * @return {Promise<Calendar>}\n */\nconst createSubscription = async (displayName, color, source, order) => {\n\treturn getCalendarHome().createSubscribedCollection(displayName, color, source, order)\n}\n\n/**\n * Enables the birthday calendar\n *\n * @return {Promise<Calendar>}\n */\nconst enableBirthdayCalendar = async () => {\n\tawait getCalendarHome().enableBirthdayCalendar()\n\treturn getBirthdayCalendar()\n}\n\n/**\n * Gets the birthday calendar\n *\n * @return {Promise<Calendar>}\n */\nconst getBirthdayCalendar = async () => {\n\treturn getCalendarHome().find(CALDAV_BIRTHDAY_CALENDAR)\n}\n\n/**\n * Returns the Current User Principal\n *\n * @return {Principal}\n */\nconst getCurrentUserPrincipal = () => {\n\treturn getClient().currentUserPrincipal\n}\n\n/**\n * Finds calendar principals by displayname\n *\n * @param {string} term The search-term\n * @return {Promise<void>}\n */\nconst principalPropertySearchByDisplaynameOrEmail = async (term) => {\n\treturn getClient().principalPropertySearchByDisplaynameOrEmail(term)\n}\n\n/**\n * Performs a principal property search based on multiple advanced filters\n *\n * @param {object} query The destructuring query object\n * @param {string=} query.displayName The display name to search for\n * @param {number=} query.capacity The minimum required seating capacity\n * @param {string[]=} query.features The features to filter by\n * @param {string=} query.roomType The room type to filter by\n * @return {Promise<Principal[]>}\n */\nconst advancedPrincipalPropertySearch = async (query) => {\n\treturn getClient().advancedPrincipalPropertySearch(query)\n}\n\n/**\n * Finds one principal by it's URL\n *\n * @param {string} url The principal-url\n * @return {Promise<Principal>}\n */\nconst findPrincipalByUrl = async (url) => {\n\treturn getClient().findPrincipal(url)\n}\n\nexport {\n\tinitializeClientForUserView,\n\tinitializeClientForPublicView,\n\tfindAll,\n\tfindAllDeletedCalendars,\n\tfindPublicCalendarsByTokens,\n\tfindSchedulingInbox,\n\tfindSchedulingOutbox,\n\tcreateCalendar,\n\tcreateSubscription,\n\tenableBirthdayCalendar,\n\tgetBirthdayCalendar,\n\tgetCurrentUserPrincipal,\n\tprincipalPropertySearchByDisplaynameOrEmail,\n\tadvancedPrincipalPropertySearch,\n\tfindPrincipalByUrl,\n}\n","/**\n * @copyright Copyright (c) 2020 Georg Ehrke\n *\n * @author Georg Ehrke <oc.list@georgehrke.com>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport HttpClient from '@nextcloud/axios'\nimport { getLinkToConfig } from '../utils/settings.js'\n\n/**\n *\n * @param {string} key Config-key to set\n * @param {string | number | boolean} value Config-value to set\n * @return {Promise<void>}\n */\nconst setConfig = async (key, value) => {\n\tawait HttpClient.post(getLinkToConfig(key), { value })\n}\n\nexport {\n\tsetConfig,\n}\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Team Popcorn <teampopcornberlin@gmail.com>\n *\n * @author Georg Ehrke <oc.list@georgehrke.com>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport HTTPClient from '@nextcloud/axios'\nimport { translate as t } from '@nextcloud/l10n'\nimport { generateUrl, generateOcsUrl } from '@nextcloud/router'\nimport { loadState } from '@nextcloud/initial-state'\nimport { getCurrentUser } from '@nextcloud/auth'\nimport logger from '../utils/logger.js'\nimport { removeMailtoPrefix } from '../utils/attendee.js'\n\n/**\n * Creates a new public talk room\n *\n * @param {?string} eventTitle Title of the event\n * @param {?string} eventDescription Description of the event\n * @param {?string[]} attendees Attendees of the event\n *\n * @return {Promise<string>}\n */\nexport async function createTalkRoom(eventTitle = null, eventDescription = null, attendees = []) {\n\tconst apiVersion = loadState('calendar', 'talk_api_version')\n\ttry {\n\t\tconst response = await HTTPClient.post(generateOcsUrl('apps/spreed/api/' + apiVersion + '/', 2) + 'room', {\n\t\t\troomType: 3,\n\t\t\troomName: eventTitle || t('calendar', 'Chat room for event'),\n\t\t})\n\n\t\tconst conversation = response.data.ocs.data\n\t\tconst token = conversation.token\n\t\tif (eventDescription) {\n\t\t\tawait HTTPClient.put(generateOcsUrl('apps/spreed/api/' + apiVersion + '/', 2) + 'room/' + token + '/description', {\n\t\t\t\tdescription: eventDescription,\n\t\t\t})\n\t\t}\n\n\t\treturn generateURLForToken(token)\n\t} catch (error) {\n\t\tconsole.debug(error)\n\t\tthrow error\n\t}\n}\n\n/**\n *\n * @param eventComponent\n */\nexport async function updateTalkParticipants(eventComponent) {\n\tconst apiVersion = loadState('calendar', 'talk_api_version')\n\tconst url = eventComponent.getConferenceList()[0]?.uri ?? eventComponent.location\n\tif (!url || !url.startsWith(window.location.protocol + '//' + window.location.host)) {\n\t\tlogger.debug('Event\\'s conference/location is from another host', url)\n\t\treturn\n\t}\n\tconst token = url.match(/\\/call\\/([a-z0-9]*)$/)[1]\n\tif (!token) {\n\t\tlogger.debug('URL ' + url + ' contains no call token')\n\t\treturn\n\t}\n\ttry {\n\t\tconst participantsResponse = await HTTPClient.get(generateOcsUrl('apps/spreed/api/' + apiVersion + '/', 2) + 'room/' + token + '/participants')\n\t\t// Ignore if the actor isn't owner of the conversation\n\t\tif (!participantsResponse.data.ocs.data.some(participant => participant.actorId === getCurrentUser().uid && participant.participantType <= 2)) {\n\t\t\tlogger.debug('Current user is not a moderator or owner', { currentUser: getCurrentUser().uid, conversation: participantsResponse.data.ocs.data })\n\t\t\treturn\n\t\t}\n\n\t\tfor (const attendee of eventComponent.getAttendeeIterator()) {\n\t\t\tlogger.debug('Processing attendee', { attendee })\n\t\t\tif (['GROUP', 'RESOURCE', 'ROOM'].includes(attendee.userType)) {\n\t\t\t\tcontinue\n\t\t\t}\n\n\t\t\tlet participantId = removeMailtoPrefix(attendee.email)\n\t\t\tlet attendeeSource = 'emails'\n\t\t\ttry {\n\t\t\t\t// Map attendee email to Nextcloud user uid\n\t\t\t\tconst searchResult = await HTTPClient.get(generateOcsUrl('core/autocomplete/', 2) + 'get?search=' + encodeURIComponent(participantId) + '&itemType=&itemId=%20&shareTypes[]=0&limit=2')\n\t\t\t\t// Only map if there is exactly one result. Use email if there are none or more results.\n\t\t\t\tif (searchResult.data.ocs.data.length === 1) {\n\t\t\t\t\tparticipantId = searchResult.data.ocs.data[0].id\n\t\t\t\t\tattendeeSource = 'users'\n\t\t\t\t} else {\n\t\t\t\t\tlogger.debug('Attendee ' + participantId + ' is not a Nextcloud user')\n\t\t\t\t}\n\t\t\t} catch (error) {\n\t\t\t\tlogger.info('Could not find user data for attendee ' + participantId, { error })\n\t\t\t}\n\n\t\t\tif (attendeeSource === 'users' && participantId === getCurrentUser().uid) {\n\t\t\t\tlogger.debug('Skipping organizer')\n\t\t\t\tcontinue\n\t\t\t}\n\t\t\tawait HTTPClient.post(generateOcsUrl('apps/spreed/api/' + apiVersion + '/', 2) + 'room/' + token + '/participants', {\n\t\t\t\tnewParticipant: participantId,\n\t\t\t\tsource: attendeeSource,\n\t\t\t})\n\t\t}\n\t} catch (error) {\n\t\tlogger.warn('Could not update Talk room attendees', { error })\n\t}\n}\n\n/**\n * Checks whether the value contains a talk link\n *\n * @param {?string} text Haystack\n * @return {boolean}\n */\nexport function doesContainTalkLink(text) {\n\tif (!text) {\n\t\treturn false\n\t}\n\n\t// TODO: there is most definitely a more reliable way,\n\t// but this works for now\n\tconst fakeUrl = generateURLForToken()\n\treturn text.includes(fakeUrl)\n}\n\n/**\n * Generates an absolute URL to the talk room based on the token\n *\n * @param {string} token The token to the call room\n * @return {string}\n */\nfunction generateURLForToken(token = '') {\n\treturn window.location.protocol + '//' + window.location.host + generateUrl('/call/' + token)\n}\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <oc.list@georgehrke.com>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport { getTimezoneManager } from '@nextcloud/calendar-js'\n\nconst timezoneManager = getTimezoneManager()\nlet initialized = false\n\n/**\n * Gets the timezone-manager\n * initializes it if necessary\n *\n * @return {TimezoneManager}\n */\nexport default function() {\n\tif (!initialized) {\n\t\ttimezoneManager.registerDefaultTimezones()\n\n\t\tinitialized = true\n\t}\n\n\treturn timezoneManager\n}\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <oc.list@georgehrke.com>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport jstz from 'jstz'\n\n/**\n * Returns the current timezone of the user\n *\n * @return {string} Current timezone of user\n */\nconst detectTimezone = () => {\n\tconst determinedTimezone = jstz.determine()\n\tif (!determinedTimezone) {\n\t\treturn 'UTC'\n\t}\n\n\tconst timezoneName = determinedTimezone.name()\n\tif (!timezoneName) {\n\t\treturn 'UTC'\n\t}\n\n\treturn timezoneName\n}\n\nexport default detectTimezone\nexport {\n\tdetectTimezone,\n}\n","/**\n * @copyright Copyright (c) 2021 Richard Steinmetz <richard@steinmetz.cloud>\n *\n * @author Richard Steinmetz <richard@steinmetz.cloud>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\nimport Vue from 'vue'\nimport { createConfig, deleteConfig, updateConfig } from '../services/appointmentConfigService.js'\nimport logger from '../utils/logger.js'\n\nconst state = {\n\tconfigs: {},\n}\n\nconst mutations = {\n\taddInitialConfigs(state, configs) {\n\t\tfor (const config of configs) {\n\t\t\tVue.set(state.configs, config.id, config)\n\t\t}\n\t},\n\tupdateConfig(state, { config }) {\n\t\tif (!state.configs[config.id]) {\n\t\t\treturn\n\t\t}\n\n\t\tVue.set(state.configs, config.id, config.clone())\n\t},\n\taddConfig(state, { config }) {\n\t\tVue.set(state.configs, config.id, config)\n\t},\n\tdeleteConfig(state, { id }) {\n\t\tif (!state.configs[id]) {\n\t\t\treturn\n\t\t}\n\n\t\tVue.delete(state.configs, id)\n\t},\n}\n\nconst getters = {\n\tallConfigs(state) {\n\t\treturn Object.values(state.configs)\n\t},\n}\n\nconst actions = {\n\tasync updateConfig({ commit }, { config }) {\n\t\ttry {\n\t\t\tconst updatedConfig = await updateConfig(config)\n\t\t\tcommit('updateConfig', { config: updatedConfig })\n\t\t\treturn updatedConfig\n\t\t} catch (error) {\n\t\t\tlogger.error('Failed to update config', { error })\n\t\t\tthrow error\n\t\t}\n\t},\n\tasync createConfig({ commit }, { config }) {\n\t\ttry {\n\t\t\tconst fullConfig = await createConfig(config)\n\t\t\tcommit('addConfig', { config: fullConfig })\n\t\t\treturn fullConfig\n\t\t} catch (error) {\n\t\t\tlogger.error('Failed to create config', { error })\n\t\t\tthrow error\n\t\t}\n\t},\n\tasync deleteConfig({ commit }, { id }) {\n\t\ttry {\n\t\t\tawait deleteConfig(id)\n\t\t\tcommit('deleteConfig', { id })\n\t\t} catch (error) {\n\t\t\tlogger.error('Failed to delete config', { error })\n\t\t\tthrow error\n\t\t}\n\t},\n}\n\nexport default { state, mutations, getters, actions }\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n * @copyright Copyright (c) 2023 Jonas Heinrich\n *\n * @author Georg Ehrke <oc.list@georgehrke.com>\n * @author Jonas Heinrich <heinrich@synyx.net>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport Vue from 'vue'\nimport getTimezoneManager from '../services/timezoneDataProviderService.js'\nimport {\n\tgetDateFromDateTimeValue,\n} from '../utils/date.js'\nimport { AttendeeProperty, Property, DateTimeValue, DurationValue, RecurValue, AttachmentProperty, Parameter } from '@nextcloud/calendar-js'\nimport { getBySetPositionAndBySetFromDate, getWeekDayFromDate } from '../utils/recurrence.js'\nimport {\n\tcopyCalendarObjectInstanceIntoEventComponent,\n\tgetDefaultEventObject,\n\tmapEventComponentToEventObject,\n} from '../models/event.js'\nimport {\n\tgetAmountAndUnitForTimedEvents,\n\tgetAmountHoursMinutesAndUnitForAllDayEvents,\n\tgetTotalSecondsFromAmountAndUnitForTimedEvents,\n\tgetTotalSecondsFromAmountHourMinutesAndUnitForAllDayEvents,\n\tupdateEmailAlarms,\n} from '../utils/alarms.js'\nimport {\n\tgetClosestCSS3ColorNameForHex,\n\tgetHexForColorName,\n} from '../utils/color.js'\nimport { mapAlarmComponentToAlarmObject } from '../models/alarm.js'\nimport { getObjectAtRecurrenceId } from '../utils/calendarObject.js'\nimport logger from '../utils/logger.js'\nimport settings from './settings.js'\nimport { getRFCProperties } from '../models/rfcProps.js'\nimport { generateUrl } from '@nextcloud/router'\nimport { updateTalkParticipants } from '../services/talkService.js'\n\nconst state = {\n\tisNew: null,\n\tcalendarObject: null,\n\tcalendarObjectInstance: null,\n\texistingEvent: {\n\t\tobjectId: null,\n\t\trecurrenceId: null,\n\t},\n}\n\nconst mutations = {\n\n\t/**\n\t * Set a calendar-object-instance that will be opened in the editor (existing event)\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} data The destructuring object\n\t * @param {object} data.calendarObject The calendar-object currently being edited\n\t * @param {object} data.calendarObjectInstance The calendar-object-instance currently being edited\n\t * @param {string} data.objectId The objectId of the calendar-object\n\t * @param {number} data.recurrenceId The recurrence-id of the calendar-object-instance\n\t */\n\tsetCalendarObjectInstanceForExistingEvent(state, { calendarObject, calendarObjectInstance, objectId, recurrenceId }) {\n\t\tstate.isNew = false\n\t\tstate.calendarObject = calendarObject\n\t\tstate.calendarObjectInstance = calendarObjectInstance\n\t\tstate.existingEvent.objectId = objectId\n\t\tstate.existingEvent.recurrenceId = recurrenceId\n\t},\n\n\t/**\n\t * Set a calendar-object-instance that will be opened in the editor (new event)\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} data The destructuring object\n\t * @param {object} data.calendarObject The calendar-object currently being created\n\t * @param {object} data.calendarObjectInstance The calendar-object-instance currently being crated\n\t */\n\tsetCalendarObjectInstanceForNewEvent(state, { calendarObject, calendarObjectInstance }) {\n\t\tstate.isNew = true\n\t\tstate.calendarObject = calendarObject\n\t\tstate.calendarObjectInstance = calendarObjectInstance\n\t\tstate.existingEvent.objectId = null\n\t\tstate.existingEvent.recurrenceId = null\n\t},\n\n\t/**\n\t *\n\t * @param {object} state The Vuex state\n\t */\n\tresetCalendarObjectInstanceObjectIdAndRecurrenceId(state) {\n\t\tstate.isNew = false\n\t\tstate.calendarObject = null\n\t\tstate.calendarObjectInstance = null\n\t\tstate.existingEvent.objectId = null\n\t\tstate.existingEvent.recurrenceId = null\n\t},\n\n\t/**\n\t * Change the title of the event\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} data The destructuring object\n\t * @param {object} data.calendarObjectInstance The calendarObjectInstance object\n\t * @param {string} data.title The new Title\n\t */\n\tchangeTitle(state, { calendarObjectInstance, title }) {\n\t\tcalendarObjectInstance.eventComponent.title = title\n\t\tcalendarObjectInstance.title = title\n\t},\n\n\t/**\n\t * Change the event's start\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} data The destructuring object\n\t * @param {object} data.calendarObjectInstance The calendarObjectInstance object\n\t * @param {Date} data.startDate New start date to set\n\t */\n\tchangeStartDate(state, { calendarObjectInstance, startDate }) {\n\t\tcalendarObjectInstance.eventComponent.startDate.year = startDate.getFullYear()\n\t\tcalendarObjectInstance.eventComponent.startDate.month = startDate.getMonth() + 1\n\t\tcalendarObjectInstance.eventComponent.startDate.day = startDate.getDate()\n\t\tcalendarObjectInstance.eventComponent.startDate.hour = startDate.getHours()\n\t\tcalendarObjectInstance.eventComponent.startDate.minute = startDate.getMinutes()\n\t\tcalendarObjectInstance.eventComponent.startDate.second = 0\n\n\t\tconst isAllDay = calendarObjectInstance.eventComponent.isAllDay()\n\t\tconst endDateObj = calendarObjectInstance.eventComponent.endDate.clone()\n\t\tconst startDateObj = calendarObjectInstance.eventComponent.startDate.clone()\n\n\t\tif (isAllDay) {\n\t\t\tendDateObj.addDuration(DurationValue.fromSeconds(-1 * 60 * 60 * 24))\n\n\t\t\tif (endDateObj.compare(startDateObj) === -1) {\n\t\t\t\tconst timezone = getTimezoneManager().getTimezoneForId(endDateObj.timezoneId)\n\t\t\t\tcalendarObjectInstance.eventComponent.endDate\n\t\t\t\t\t= calendarObjectInstance.eventComponent.startDate.getInTimezone(timezone)\n\t\t\t\tcalendarObjectInstance.endDate = getDateFromDateTimeValue(calendarObjectInstance.eventComponent.endDate)\n\t\t\t\tcalendarObjectInstance.eventComponent.endDate.addDuration(DurationValue.fromSeconds(60 * 60 * 24))\n\t\t\t}\n\t\t} else {\n\t\t\tif (endDateObj.compare(startDateObj) === -1) {\n\t\t\t\tconst timezone = getTimezoneManager().getTimezoneForId(endDateObj.timezoneId)\n\t\t\t\tcalendarObjectInstance.eventComponent.endDate\n\t\t\t\t\t= calendarObjectInstance.eventComponent.startDate.getInTimezone(timezone)\n\t\t\t\tcalendarObjectInstance.endDate = getDateFromDateTimeValue(calendarObjectInstance.eventComponent.endDate)\n\t\t\t}\n\t\t}\n\n\t\tcalendarObjectInstance.startDate = startDate\n\t},\n\n\t/**\n\t * Change the timezone of the event's start\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} data The destructuring object\n\t * @param {object} data.calendarObjectInstance The calendarObjectInstance object\n\t * @param {string} data.startTimezone New timezone to set for start\n\t */\n\tchangeStartTimezone(state, { calendarObjectInstance, startTimezone }) {\n\t\tconst timezone = getTimezoneManager().getTimezoneForId(startTimezone)\n\t\tcalendarObjectInstance.eventComponent.startDate.replaceTimezone(timezone)\n\t\tcalendarObjectInstance.startTimezoneId = startTimezone\n\n\t\t// Either both are floating or both have a timezone, but it can't be mixed\n\t\tif (startTimezone === 'floating' || calendarObjectInstance.endTimezoneId === 'floating') {\n\t\t\tcalendarObjectInstance.eventComponent.endDate.replaceTimezone(timezone)\n\t\t\tcalendarObjectInstance.endTimezoneId = startTimezone\n\t\t}\n\t},\n\n\t/**\n\t * Change the event's end\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} data The destructuring object\n\t * @param {object} data.calendarObjectInstance The calendarObjectInstance object\n\t * @param {Date} data.endDate New end date to set\n\t */\n\tchangeEndDate(state, { calendarObjectInstance, endDate }) {\n\t\t// If the event is using DURATION, endDate is dynamically generated.\n\t\t// In order to alter it, we need to explicitly set DTEND\n\t\tconst endDateObject = calendarObjectInstance.eventComponent.endDate\n\t\tcalendarObjectInstance.eventComponent.endDate = endDateObject\n\n\t\tcalendarObjectInstance.eventComponent.endDate.year = endDate.getFullYear()\n\t\tcalendarObjectInstance.eventComponent.endDate.month = endDate.getMonth() + 1\n\t\tcalendarObjectInstance.eventComponent.endDate.day = endDate.getDate()\n\t\tcalendarObjectInstance.eventComponent.endDate.hour = endDate.getHours()\n\t\tcalendarObjectInstance.eventComponent.endDate.minute = endDate.getMinutes()\n\t\tcalendarObjectInstance.eventComponent.endDate.second = 0\n\n\t\tconst isAllDay = calendarObjectInstance.eventComponent.isAllDay()\n\t\tconst endDateObj = calendarObjectInstance.eventComponent.endDate.clone()\n\t\tconst startDateObj = calendarObjectInstance.eventComponent.startDate.clone()\n\n\t\tif (isAllDay) {\n\t\t\tif (endDateObj.compare(startDateObj) === -1) {\n\t\t\t\tconst timezone = getTimezoneManager().getTimezoneForId(startDateObj.timezoneId)\n\t\t\t\tcalendarObjectInstance.eventComponent.startDate\n\t\t\t\t\t= calendarObjectInstance.eventComponent.endDate.getInTimezone(timezone)\n\t\t\t\tcalendarObjectInstance.startDate = getDateFromDateTimeValue(calendarObjectInstance.eventComponent.startDate)\n\t\t\t}\n\n\t\t\t// endDate is inclusive, but DTEND needs to be exclusive, so always add one day\n\t\t\tcalendarObjectInstance.eventComponent.endDate.addDuration(DurationValue.fromSeconds(60 * 60 * 24))\n\t\t} else {\n\t\t\t// Is end before start?\n\t\t\tif (endDateObj.compare(startDateObj) === -1) {\n\t\t\t\t// Is end more than one day before start?\n\t\t\t\tendDateObj.addDuration(DurationValue.fromSeconds(60 * 60 * 24))\n\t\t\t\tif (endDateObj.compare(startDateObj) === -1) {\n\t\t\t\t\tconst timezone = getTimezoneManager().getTimezoneForId(startDateObj.timezoneId)\n\t\t\t\t\tcalendarObjectInstance.eventComponent.startDate\n\t\t\t\t\t\t= calendarObjectInstance.eventComponent.endDate.getInTimezone(timezone)\n\t\t\t\t\tcalendarObjectInstance.startDate = getDateFromDateTimeValue(calendarObjectInstance.eventComponent.startDate)\n\t\t\t\t} else {\n\t\t\t\t\t// add one day to endDate if the endDate is before the startDate which allows to easily create events that reach over or to 0:00\n\t\t\t\t\tcalendarObjectInstance.eventComponent.endDate.addDuration(DurationValue.fromSeconds(60 * 60 * 24))\n\t\t\t\t\tendDate = new Date(endDate.getTime() + 24 * 60 * 60 * 1000)\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tcalendarObjectInstance.endDate = endDate\n\t},\n\n\t/**\n\t * Change the timezone of the event's end\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} data The destructuring object\n\t * @param {object} data.calendarObjectInstance The calendarObjectInstance object\n\t * @param {string} data.endTimezone New timezone to set for end\n\t */\n\tchangeEndTimezone(state, { calendarObjectInstance, endTimezone }) {\n\t\tconst timezone = getTimezoneManager().getTimezoneForId(endTimezone)\n\t\tcalendarObjectInstance.eventComponent.endDate.replaceTimezone(timezone)\n\t\tcalendarObjectInstance.endTimezoneId = endTimezone\n\n\t\t// Either both are floating or both have a timezone, but it can't be mixed\n\t\tif (endTimezone === 'floating' || calendarObjectInstance.startTimezoneId === 'floating') {\n\t\t\tcalendarObjectInstance.eventComponent.startDate.replaceTimezone(timezone)\n\t\t\tcalendarObjectInstance.startTimezoneId = endTimezone\n\t\t}\n\t},\n\n\t/**\n\t * Switch from a timed event to allday or vice versa\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} data The destructuring object\n\t * @param {object} data.calendarObjectInstance The calendarObjectInstance object\n\t */\n\ttoggleAllDay(state, { calendarObjectInstance }) {\n\t\tif (!calendarObjectInstance.eventComponent.canModifyAllDay()) {\n\t\t\treturn\n\t\t}\n\n\t\tconst isAllDay = calendarObjectInstance.eventComponent.isAllDay()\n\t\tcalendarObjectInstance.eventComponent.startDate.isDate = !isAllDay\n\t\tcalendarObjectInstance.eventComponent.endDate.isDate = !isAllDay\n\t\tcalendarObjectInstance.isAllDay = calendarObjectInstance.eventComponent.isAllDay()\n\n\t\t// isAllDay = old value\n\t\tif (isAllDay) {\n\t\t\tcalendarObjectInstance.eventComponent.endDate.addDuration(DurationValue.fromSeconds(-1 * 60 * 60 * 24))\n\t\t} else {\n\t\t\tcalendarObjectInstance.eventComponent.endDate.addDuration(DurationValue.fromSeconds(60 * 60 * 24))\n\t\t}\n\t},\n\n\t/**\n\t * Changes the time of a timed event to the default values\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} data The destructuring object\n\t * @param {object} data.calendarObjectInstance The calendarObjectInstance object\n\t */\n\tchangeTimeToDefaultForTimedEvents(state, { calendarObjectInstance }) {\n\t\tconst startDate = calendarObjectInstance.eventComponent.startDate\n\t\tconst endDate = calendarObjectInstance.eventComponent.endDate\n\t\tif (startDate.hour === 0 && startDate.minute === 0 && endDate.hour === 0 && endDate.minute === 0) {\n\t\t\tstartDate.hour = 10\n\t\t\tendDate.hour = 11\n\n\t\t\tcalendarObjectInstance.startDate = getDateFromDateTimeValue(startDate)\n\t\t\tcalendarObjectInstance.endDate = getDateFromDateTimeValue(endDate)\n\t\t}\n\t},\n\n\t/**\n\t * Change the location of an event\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} data The destructuring object\n\t * @param {object} data.calendarObjectInstance The calendarObjectInstance object\n\t * @param {string} data.location New location to set\n\t */\n\tchangeLocation(state, { calendarObjectInstance, location }) {\n\t\t// Special case: delete Apple-specific location property to avoid inconsistencies\n\t\tcalendarObjectInstance.eventComponent.deleteAllProperties('X-APPLE-STRUCTURED-LOCATION')\n\n\t\tcalendarObjectInstance.eventComponent.location = location\n\t\tcalendarObjectInstance.location = location\n\t},\n\n\t/**\n\t * Change the description of an event\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} data The destructuring object\n\t * @param {object} data.calendarObjectInstance The calendarObjectInstance object\n\t * @param {string} data.description New description to set\n\t */\n\tchangeDescription(state, { calendarObjectInstance, description }) {\n\t\t// To avoid inconsistencies (bug #3863), remove all parameters (e.g., ALTREP) upon modification\n\t\tconst descriptionProperty = calendarObjectInstance.eventComponent.getFirstProperty('Description')\n\t\tif (descriptionProperty) {\n\t\t\tfor (const parameter of descriptionProperty.getParametersIterator()) {\n\t\t\t\tdescriptionProperty.deleteParameter(parameter.name)\n\t\t\t}\n\t\t}\n\n\t\t// Delete custom description properties\n\t\tcalendarObjectInstance.eventComponent.deleteAllProperties('X-ALT-DESC')\n\n\t\tcalendarObjectInstance.eventComponent.description = description\n\t\tcalendarObjectInstance.description = description\n\t},\n\n\t/**\n\t * Change the access class of an event\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} data The destructuring object\n\t * @param {object} data.calendarObjectInstance The calendarObjectInstance object\n\t * @param {string} data.accessClass New access class to set\n\t */\n\tchangeAccessClass(state, { calendarObjectInstance, accessClass }) {\n\t\tcalendarObjectInstance.eventComponent.accessClass = accessClass\n\t\tcalendarObjectInstance.accessClass = accessClass\n\t},\n\n\t/**\n\t * Change the status of an event\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} data The destructuring object\n\t * @param {object} data.calendarObjectInstance The calendarObjectInstance object\n\t * @param {string} data.status New status to set\n\t */\n\tchangeStatus(state, { calendarObjectInstance, status }) {\n\t\tcalendarObjectInstance.eventComponent.status = status\n\t\tcalendarObjectInstance.status = status\n\t},\n\n\t/**\n\t * Change the time-transparency of an event\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} data The destructuring object\n\t * @param {object} data.calendarObjectInstance The calendarObjectInstance object\n\t * @param {string} data.timeTransparency New time-transparency to set\n\t */\n\tchangeTimeTransparency(state, { calendarObjectInstance, timeTransparency }) {\n\t\tcalendarObjectInstance.eventComponent.timeTransparency = timeTransparency\n\t\tcalendarObjectInstance.timeTransparency = timeTransparency\n\t},\n\n\t/**\n\t * Change the customized color of an event\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} data The destructuring object\n\t * @param {object} data.calendarObjectInstance The calendarObjectInstance object\n\t * @param {string | null} data.customColor New color to set\n\t */\n\tchangeCustomColor(state, { calendarObjectInstance, customColor }) {\n\t\tif (customColor === null) {\n\t\t\tcalendarObjectInstance.eventComponent.deleteAllProperties('COLOR')\n\t\t\tVue.set(calendarObjectInstance, 'customColor', null)\n\t\t\treturn\n\t\t}\n\n\t\tconst cssColorName = getClosestCSS3ColorNameForHex(customColor)\n\t\tconst hexColorOfCssName = getHexForColorName(cssColorName)\n\n\t\t// Abort if either is undefined\n\t\tif (!cssColorName || !hexColorOfCssName) {\n\t\t\tconsole.error('Setting custom color failed')\n\t\t\tconsole.error('customColor: ', customColor)\n\t\t\tconsole.error('cssColorName: ', cssColorName)\n\t\t\tconsole.error('hexColorOfCssName: ', hexColorOfCssName)\n\t\t\treturn\n\t\t}\n\n\t\tcalendarObjectInstance.eventComponent.color = cssColorName\n\t\tVue.set(calendarObjectInstance, 'customColor', hexColorOfCssName)\n\t},\n\n\t/**\n\t * Adds an attendee to the event and sets the organizer if not present already\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} data The destructuring object\n\t * @param {object} data.calendarObjectInstance The calendarObjectInstance object\n\t * @param {string} data.commonName Displayname of attendee\n\t * @param {string} data.uri Email address of attendee\n\t * @param {string} data.calendarUserType Calendar-user-type of attendee (INDIVIDUAL, GROUP, RESOURCE, ROOM)\n\t * @param {string} data.participationStatus Participation Status of attendee\n\t * @param {string} data.role Role of Attendee\n\t * @param {boolean} data.rsvp Whether or not to request a response from the attendee\n\t * @param {string=} data.language Preferred language of the attendee\n\t * @param {string=} data.timezoneId Preferred timezone of the attendee\n\t * @param {object=} data.organizer Principal of the organizer to be set if not present\n\t */\n\taddAttendee(state, { calendarObjectInstance, commonName, uri, calendarUserType = null, participationStatus = null, role = null, rsvp = null, language = null, timezoneId = null, organizer = null }) {\n\t\tconst attendee = AttendeeProperty.fromNameAndEMail(commonName, uri)\n\n\t\tif (calendarUserType !== null) {\n\t\t\tattendee.userType = calendarUserType\n\t\t}\n\t\tif (participationStatus !== null) {\n\t\t\tattendee.participationStatus = participationStatus\n\t\t}\n\t\tif (role !== null) {\n\t\t\tattendee.role = role\n\t\t}\n\t\tif (rsvp !== null) {\n\t\t\tattendee.rsvp = rsvp\n\t\t}\n\t\tif (language !== null) {\n\t\t\tattendee.language = language\n\t\t}\n\t\tif (timezoneId !== null) {\n\t\t\tattendee.updateParameterIfExist('TZID', timezoneId)\n\t\t}\n\n\t\t// TODO - use real addAttendeeFrom method\n\t\tcalendarObjectInstance.eventComponent.addProperty(attendee)\n\t\tcalendarObjectInstance.attendees.push({\n\t\t\tcommonName,\n\t\t\tparticipationStatus,\n\t\t\trole,\n\t\t\trsvp,\n\t\t\turi,\n\t\t\tattendeeProperty: attendee,\n\t\t})\n\n\t\tif (!calendarObjectInstance.organizer && organizer) {\n\t\t\tthis.commit('setOrganizer', {\n\t\t\t\tcalendarObjectInstance,\n\t\t\t\tcommonName: organizer.displayname,\n\t\t\t\temail: organizer.emailAddress,\n\t\t\t})\n\t\t}\n\t},\n\n\t/**\n\t * Removes an attendee from the event\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} data The destructuring object\n\t * @param {object} data.calendarObjectInstance The calendarObjectInstance object\n\t * @param {object} data.attendee The attendee object to remove\n\t */\n\tremoveAttendee(state, { calendarObjectInstance, attendee }) {\n\t\tcalendarObjectInstance.eventComponent.removeAttendee(attendee.attendeeProperty)\n\n\t\t// Also remove members if attendee is a group\n\t\tif (attendee.attendeeProperty.userType === 'GROUP') {\n\t\t\tattendee.members.forEach(function(member) {\n\t\t\t\tcalendarObjectInstance.eventComponent.removeAttendee(member.attendeeProperty)\n\t\t\t\tconst index = calendarObjectInstance.attendees.indexOf(member)\n\t\t\t\tif (index !== -1) {\n\t\t\t\t\tcalendarObjectInstance.attendees.splice(index, 1)\n\t\t\t\t}\n\t\t\t})\n\t\t}\n\n\t\tconst index = calendarObjectInstance.attendees.indexOf(attendee)\n\t\tif (index !== -1) {\n\t\t\tcalendarObjectInstance.attendees.splice(index, 1)\n\t\t}\n\t},\n\n\t/**\n\t * Changes an attendees' participation status\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} data The destructuring object\n\t * @param {object} data.attendee The attendee object\n\t * @param {string} data.participationStatus New Participation Status of attendee\n\t */\n\tchangeAttendeesParticipationStatus(state, { attendee, participationStatus }) {\n\t\tattendee.attendeeProperty.participationStatus = participationStatus\n\t\tattendee.participationStatus = participationStatus\n\t},\n\n\t/**\n\t * Changes an attendees' role\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} data The destructuring object\n\t * @param {object} data.attendee The attendee object\n\t * @param {string} data.role New role of attendee\n\t */\n\tchangeAttendeesRole(state, { attendee, role }) {\n\t\tattendee.attendeeProperty.role = role\n\t\tattendee.role = role\n\t},\n\n\t/**\n\t * Changes an attendees' RVSP\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} data The destructuring object\n\t * @param {object} data.attendee The attendee object\n\t */\n\ttoggleAttendeeRSVP(state, { attendee }) {\n\t\tconst oldRSVP = attendee.attendeeProperty.rsvp\n\t\tattendee.attendeeProperty.rsvp = !oldRSVP\n\t\tattendee.rsvp = !oldRSVP\n\t},\n\n\t/**\n\t * Set the event's organizer\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} data The destructuring object\n\t * @param {object} data.calendarObjectInstance The calendarObjectInstance object\n\t * @param {string=} data.commonName Displayname of organizer\n\t * @param {string} data.email Email-address of organizer\n\t */\n\tsetOrganizer(state, { calendarObjectInstance, commonName = null, email }) {\n\t\tcalendarObjectInstance.eventComponent.setOrganizerFromNameAndEMail(commonName, email)\n\t\tVue.set(calendarObjectInstance, 'organizer', {})\n\t\tVue.set(calendarObjectInstance.organizer, 'commonName', commonName)\n\t\tVue.set(calendarObjectInstance.organizer, 'uri', email)\n\t\tVue.set(calendarObjectInstance.organizer, 'attendeeProperty', calendarObjectInstance.eventComponent.getFirstProperty('ORGANIZER'))\n\t},\n\n\t/**\n\t * Adds a category to the event\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} data The destructuring object\n\t * @param {object} data.calendarObjectInstance The calendarObjectInstance object\n\t * @param {string} data.category Category to add\n\t */\n\taddCategory(state, { calendarObjectInstance, category }) {\n\t\tcalendarObjectInstance.eventComponent.addCategory(category)\n\t\tcalendarObjectInstance.categories.push(category)\n\t},\n\n\t/**\n\t * Removes a category from the event\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} data The destructuring object\n\t * @param {object} data.calendarObjectInstance The calendarObjectInstance object\n\t * @param {string} data.category Category to remove\n\t */\n\tremoveCategory(state, { calendarObjectInstance, category }) {\n\t\tcalendarObjectInstance.eventComponent.removeCategory(category)\n\n\t\tconst index = calendarObjectInstance.categories.indexOf(category)\n\t\tif (index !== -1) {\n\t\t\tcalendarObjectInstance.categories.splice(index, 1)\n\t\t}\n\t},\n\n\t/**\n\t * Change the interval of the recurrence-rule\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} data The destructuring object\n\t * @param {object} data.calendarObjectInstance The calendarObjectInstance object\n\t * @param {object} data.recurrenceRule The recurrenceRule object to modify\n\t * @param {string} data.interval The new interval to set\n\t */\n\tchangeRecurrenceInterval(state, { calendarObjectInstance, recurrenceRule, interval }) {\n\t\tif (recurrenceRule.recurrenceRuleValue) {\n\t\t\trecurrenceRule.recurrenceRuleValue.interval = interval\n\t\t\trecurrenceRule.interval = interval\n\n\t\t\tconsole.debug(recurrenceRule.recurrenceRuleValue._innerValue.toString())\n\t\t}\n\t},\n\n\t/**\n\t * Change the frequency of the recurrence-rule\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} data The destructuring object\n\t * @param {object} data.calendarObjectInstance The calendarObjectInstance object\n\t * @param {object} data.recurrenceRule The recurrenceRule object to modify\n\t * @param {string} data.frequency The new frequency to set\n\t */\n\tchangeRecurrenceFrequency(state, { calendarObjectInstance, recurrenceRule, frequency }) {\n\t\tif (recurrenceRule.recurrenceRuleValue) {\n\t\t\trecurrenceRule.recurrenceRuleValue.frequency = frequency\n\t\t\trecurrenceRule.frequency = frequency\n\n\t\t\tconsole.debug(recurrenceRule.recurrenceRuleValue._innerValue.toString())\n\t\t}\n\t},\n\n\t/**\n\t * Change the count limit of the recurrence-rule\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} data The destructuring object\n\t * @param {object} data.calendarObjectInstance The calendarObjectInstance object\n\t * @param {object} data.recurrenceRule The recurrenceRule object to modify\n\t * @param {string} data.count The new count to set\n\t */\n\tchangeRecurrenceCount(state, { calendarObjectInstance, recurrenceRule, count }) {\n\t\tif (recurrenceRule.recurrenceRuleValue) {\n\t\t\trecurrenceRule.recurrenceRuleValue.count = count\n\t\t\trecurrenceRule.count = count\n\t\t\trecurrenceRule.until = null\n\n\t\t\tconsole.debug(recurrenceRule.recurrenceRuleValue._innerValue.toString())\n\t\t}\n\t},\n\n\t/**\n\t * Change the until limit of the recurrence-rule\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} data The destructuring object\n\t * @param {object} data.calendarObjectInstance The calendarObjectInstance object\n\t * @param {object} data.recurrenceRule The recurrenceRule object to modify\n\t * @param {Date} data.until The new until to set\n\t */\n\tchangeRecurrenceUntil(state, { calendarObjectInstance, recurrenceRule, until }) {\n\t\tif (recurrenceRule.recurrenceRuleValue) {\n\t\t\t// RFC 5545, setion 3.3.10: until must be in UTC if the start time is timezone-aware\n\t\t\tif (calendarObjectInstance.startTimezoneId !== 'floating') {\n\t\t\t\trecurrenceRule.recurrenceRuleValue.until = DateTimeValue.fromJSDate(until, { zone: 'utc' })\n\t\t\t} else {\n\t\t\t\trecurrenceRule.recurrenceRuleValue.until = DateTimeValue.fromJSDate(until)\n\t\t\t}\n\t\t\trecurrenceRule.until = until\n\t\t\trecurrenceRule.count = null\n\n\t\t\tconsole.debug(recurrenceRule.recurrenceRuleValue._innerValue.toString())\n\t\t}\n\t},\n\n\t/**\n\t * Changes the recurrence-rule to never end\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} data The destructuring object\n\t * @param {object} data.calendarObjectInstance The calendarObjectInstance object\n\t * @param {object} data.recurrenceRule The recurrenceRule object to modify\n\t */\n\tchangeRecurrenceToInfinite(state, { calendarObjectInstance, recurrenceRule }) {\n\t\tif (recurrenceRule.recurrenceRuleValue) {\n\t\t\trecurrenceRule.recurrenceRuleValue.setToInfinite()\n\t\t\trecurrenceRule.until = null\n\t\t\trecurrenceRule.count = null\n\n\t\t\tconsole.debug(recurrenceRule.recurrenceRuleValue._innerValue.toString())\n\t\t}\n\t},\n\n\t/**\n\t * Reset the By-parts of the recurrence rule\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} data The destructuring object\n\t * @param {object} data.calendarObjectInstance The calendarObjectInstance object\n\t * @param {object} data.recurrenceRule The recurrenceRule object to modify\n\t */\n\tresetRecurrenceByParts(state, { calendarObjectInstance, recurrenceRule }) {\n\t\tif (recurrenceRule.recurrenceRuleValue) {\n\t\t\tconst parts = [\n\t\t\t\t'BYSECOND',\n\t\t\t\t'BYMINUTE',\n\t\t\t\t'BYHOUR',\n\t\t\t\t'BYDAY',\n\t\t\t\t'BYMONTHDAY',\n\t\t\t\t'BYYEARDAY',\n\t\t\t\t'BYWEEKNO',\n\t\t\t\t'BYMONTH',\n\t\t\t\t'BYSETPOS',\n\t\t\t]\n\n\t\t\tfor (const part of parts) {\n\t\t\t\trecurrenceRule.recurrenceRuleValue.setComponent(part, [])\n\t\t\t}\n\n\t\t\tVue.set(recurrenceRule, 'byDay', [])\n\t\t\tVue.set(recurrenceRule, 'byMonth', [])\n\t\t\tVue.set(recurrenceRule, 'byMonthDay', [])\n\t\t\tVue.set(recurrenceRule, 'bySetPosition', null)\n\n\t\t\tconsole.debug(recurrenceRule.recurrenceRuleValue._innerValue.toString())\n\t\t}\n\t},\n\n\t/**\n\t * Reset the By-parts of the recurrence rule\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} data The destructuring object\n\t * @param {object} data.calendarObjectInstance The calendarObjectInstance object\n\t * @param {object} data.recurrenceRule The recurrenceRule object to modify\n\t */\n\tsetDefaultRecurrenceByPartsForWeekly(state, { calendarObjectInstance, recurrenceRule }) {\n\t\tif (recurrenceRule.recurrenceRuleValue) {\n\t\t\tconst byDay = getWeekDayFromDate(calendarObjectInstance.startDate)\n\t\t\trecurrenceRule.recurrenceRuleValue.setComponent('BYDAY', [byDay])\n\t\t\trecurrenceRule.byDay.push(byDay)\n\n\t\t\tconsole.debug(recurrenceRule.recurrenceRuleValue._innerValue.toString())\n\t\t}\n\t},\n\n\t/**\n\t * Reset the By-parts of the recurrence rule\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} data The destructuring object\n\t * @param {object} data.calendarObjectInstance The calendarObjectInstance object\n\t * @param {object} data.recurrenceRule The recurrenceRule object to modify\n\t */\n\tsetDefaultRecurrenceByPartsForMonthly(state, { calendarObjectInstance, recurrenceRule }) {\n\t\tif (recurrenceRule.recurrenceRuleValue) {\n\t\t\tconst byMonthDay = calendarObjectInstance.startDate.getDate().toString()\n\t\t\trecurrenceRule.recurrenceRuleValue.setComponent('BYMONTHDAY', [byMonthDay])\n\t\t\trecurrenceRule.byMonthDay.push(byMonthDay)\n\n\t\t\tconsole.debug(recurrenceRule.recurrenceRuleValue._innerValue.toString())\n\t\t}\n\t},\n\n\t/**\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} data The destructuring object\n\t * @param {object} data.calendarObjectInstance The calendarObjectInstance object\n\t * @param {object} data.recurrenceRule The recurrenceRule object to modify\n\t */\n\tsetDefaultRecurrenceByPartsForMonthlyBySetPosition(state, { calendarObjectInstance, recurrenceRule }) {\n\t\tif (recurrenceRule.recurrenceRuleValue) {\n\t\t\tconst {\n\t\t\t\tbyDay,\n\t\t\t\tbySetPosition,\n\t\t\t} = getBySetPositionAndBySetFromDate(calendarObjectInstance.startDate)\n\t\t\trecurrenceRule.recurrenceRuleValue.setComponent('BYDAY', [byDay])\n\t\t\trecurrenceRule.recurrenceRuleValue.setComponent('BYSETPOS', [bySetPosition])\n\n\t\t\trecurrenceRule.byDay.push(byDay)\n\t\t\trecurrenceRule.bySetPosition = bySetPosition\n\n\t\t\tconsole.debug(recurrenceRule.recurrenceRuleValue._innerValue.toString())\n\t\t}\n\t},\n\n\t/**\n\t * Reset the By-parts of the recurrence rule\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} data The destructuring object\n\t * @param {object} data.calendarObjectInstance The calendarObjectInstance object\n\t * @param {object} data.recurrenceRule The recurrenceRule object to modify\n\t */\n\tsetDefaultRecurrenceByPartsForYearly(state, { calendarObjectInstance, recurrenceRule }) {\n\t\tif (recurrenceRule.recurrenceRuleValue) {\n\t\t\tconst byMonth = calendarObjectInstance.startDate.getMonth() + 1 // Javascript months are zero-based\n\t\t\trecurrenceRule.recurrenceRuleValue.setComponent('BYMONTH', [byMonth])\n\t\t\trecurrenceRule.byMonth.push(byMonth)\n\n\t\t\tconsole.debug(recurrenceRule.recurrenceRuleValue._innerValue.toString())\n\t\t}\n\t},\n\n\t/**\n\t * Change the until limit of the recurrence-rule\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} data The destructuring object\n\t * @param {object} data.calendarObjectInstance The calendarObjectInstance object\n\t * @param {object} data.recurrenceRule The recurrenceRule object to modify\n\t * @param {string} data.byDay The new until to set\n\t */\n\taddByDayToRecurrenceRule(state, { calendarObjectInstance, recurrenceRule, byDay }) {\n\t\tif (recurrenceRule.recurrenceRuleValue) {\n\t\t\tconst byDayList = recurrenceRule.recurrenceRuleValue.getComponent('BYDAY')\n\t\t\tconst index = byDayList.indexOf(byDay)\n\t\t\tif (index === -1) {\n\t\t\t\tbyDayList.push(byDay)\n\t\t\t\trecurrenceRule.recurrenceRuleValue.setComponent('BYDAY', byDayList)\n\t\t\t}\n\n\t\t\tconst index2 = recurrenceRule.byDay.indexOf(byDay)\n\t\t\tif (index2 === -1) {\n\t\t\t\trecurrenceRule.byDay.push(byDay)\n\t\t\t}\n\n\t\t\tconsole.debug(recurrenceRule.recurrenceRuleValue._innerValue.toString())\n\t\t}\n\t},\n\n\t/**\n\t * Change the until limit of the recurrence-rule\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} data The destructuring object\n\t * @param {object} data.calendarObjectInstance The calendarObjectInstance object\n\t * @param {object} data.recurrenceRule The recurrenceRule object to modify\n\t * @param {string} data.byDay The new until to set\n\t */\n\tremoveByDayFromRecurrenceRule(state, { calendarObjectInstance, recurrenceRule, byDay }) {\n\t\tif (recurrenceRule.recurrenceRuleValue) {\n\t\t\tconst byDayList = recurrenceRule.recurrenceRuleValue.getComponent('BYDAY')\n\t\t\tconst index = byDayList.indexOf(byDay)\n\t\t\tif (index !== -1) {\n\t\t\t\tbyDayList.splice(index, 1)\n\t\t\t\trecurrenceRule.recurrenceRuleValue.setComponent('BYDAY', byDayList)\n\t\t\t}\n\n\t\t\tconst index2 = recurrenceRule.byDay.indexOf(byDay)\n\t\t\tif (index2 !== -1) {\n\t\t\t\trecurrenceRule.byDay.splice(index2, 1)\n\t\t\t}\n\n\t\t\tconsole.debug(recurrenceRule.recurrenceRuleValue._innerValue.toString())\n\t\t}\n\t},\n\n\t/**\n\t * Change the until limit of the recurrence-rule\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} data The destructuring object\n\t * @param {object} data.calendarObjectInstance The calendarObjectInstance object\n\t * @param {object} data.recurrenceRule The recurrenceRule object to modify\n\t * @param {string} data.byMonthDay The new until to set\n\t */\n\taddByMonthDayToRecurrenceRule(state, { calendarObjectInstance, recurrenceRule, byMonthDay }) {\n\t\tif (recurrenceRule.recurrenceRuleValue) {\n\t\t\tconst byMonthDayList = recurrenceRule.recurrenceRuleValue.getComponent('BYMONTHDAY')\n\t\t\tconst index = byMonthDayList.indexOf(byMonthDay)\n\t\t\tif (index === -1) {\n\t\t\t\tbyMonthDayList.push(byMonthDay)\n\t\t\t\trecurrenceRule.recurrenceRuleValue.setComponent('BYMONTHDAY', byMonthDayList)\n\t\t\t}\n\n\t\t\tconst index2 = recurrenceRule.byMonthDay.indexOf(byMonthDay)\n\t\t\tif (index2 === -1) {\n\t\t\t\trecurrenceRule.byMonthDay.push(byMonthDay)\n\t\t\t}\n\n\t\t\tconsole.debug(recurrenceRule.recurrenceRuleValue._innerValue.toString())\n\t\t}\n\t},\n\n\t/**\n\t * Change the until limit of the recurrence-rule\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} data The destructuring object\n\t * @param {object} data.calendarObjectInstance The calendarObjectInstance object\n\t * @param {object} data.recurrenceRule The recurrenceRule object to modify\n\t * @param {string} data.byMonthDay The new until to set\n\t */\n\tremoveByMonthDayFromRecurrenceRule(state, { calendarObjectInstance, recurrenceRule, byMonthDay }) {\n\t\tif (recurrenceRule.recurrenceRuleValue) {\n\t\t\tconst byMonthDayList = recurrenceRule.recurrenceRuleValue.getComponent('BYMONTHDAY')\n\t\t\tconst index = byMonthDayList.indexOf(byMonthDay)\n\t\t\tif (index !== -1) {\n\t\t\t\tbyMonthDayList.splice(index, 1)\n\t\t\t\trecurrenceRule.recurrenceRuleValue.setComponent('BYMONTHDAY', byMonthDayList)\n\t\t\t}\n\n\t\t\tconst index2 = recurrenceRule.byMonthDay.indexOf(byMonthDay)\n\t\t\tif (index2 !== -1) {\n\t\t\t\trecurrenceRule.byMonthDay.splice(index2, 1)\n\t\t\t}\n\n\t\t\tconsole.debug(recurrenceRule.recurrenceRuleValue._innerValue.toString())\n\t\t}\n\t},\n\n\t/**\n\t * Change the until limit of the recurrence-rule\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} data The destructuring object\n\t * @param {object} data.calendarObjectInstance The calendarObjectInstance object\n\t * @param {object} data.recurrenceRule The recurrenceRule object to modify\n\t * @param {string} data.byMonth The new until to set\n\t */\n\taddByMonthToRecurrenceRule(state, { calendarObjectInstance, recurrenceRule, byMonth }) {\n\t\tif (recurrenceRule.recurrenceRuleValue) {\n\t\t\tconsole.debug('addByMonthToRecurrenceRule', byMonth)\n\n\t\t\tconst byMonthList = recurrenceRule.recurrenceRuleValue.getComponent('BYMONTH')\n\t\t\tconst index = byMonthList.indexOf(byMonth)\n\t\t\tif (index === -1) {\n\t\t\t\tbyMonthList.push(byMonth)\n\t\t\t\trecurrenceRule.recurrenceRuleValue.setComponent('BYMONTH', byMonthList)\n\t\t\t}\n\n\t\t\tconst index2 = recurrenceRule.byMonth.indexOf(byMonth)\n\t\t\tif (index2 === -1) {\n\t\t\t\trecurrenceRule.byMonth.push(byMonth)\n\t\t\t}\n\n\t\t\tconsole.debug(recurrenceRule.recurrenceRuleValue._innerValue.toString())\n\t\t}\n\t},\n\n\t/**\n\t * Change the until limit of the recurrence-rule\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} data The destructuring object\n\t * @param {object} data.calendarObjectInstance The calendarObjectInstance object\n\t * @param {object} data.recurrenceRule The recurrenceRule object to modify\n\t * @param {string} data.byMonth The new until to set\n\t */\n\tremoveByMonthFromRecurrenceRule(state, { calendarObjectInstance, recurrenceRule, byMonth }) {\n\t\tif (recurrenceRule.recurrenceRuleValue) {\n\t\t\tconsole.debug('removeByMonthFromRecurrenceRule', byMonth)\n\n\t\t\tconst byMonthList = recurrenceRule.recurrenceRuleValue.getComponent('BYMONTH')\n\t\t\tconst index = byMonthList.indexOf(byMonth)\n\t\t\tif (index !== -1) {\n\t\t\t\tbyMonthList.splice(index, 1)\n\t\t\t\trecurrenceRule.recurrenceRuleValue.setComponent('BYMONTH', byMonthList)\n\t\t\t}\n\n\t\t\tconst index2 = recurrenceRule.byMonth.indexOf(byMonth)\n\t\t\tif (index2 !== -1) {\n\t\t\t\trecurrenceRule.byMonth.splice(index2, 1)\n\t\t\t}\n\n\t\t\tconsole.debug(recurrenceRule.recurrenceRuleValue._innerValue.toString())\n\t\t}\n\t},\n\n\t/**\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} data The destructuring object\n\t * @param {object} data.calendarObjectInstance The calendarObjectInstance object\n\t * @param {object} data.recurrenceRule The recurrenceRule object to modify\n\t * @param {string[]} data.byDay The new until to set\n\t */\n\tchangeRecurrenceByDay(state, { calendarObjectInstance, recurrenceRule, byDay }) {\n\t\tif (recurrenceRule.recurrenceRuleValue) {\n\t\t\trecurrenceRule.recurrenceRuleValue.setComponent('BYDAY', byDay)\n\t\t\tVue.set(recurrenceRule, 'byDay', byDay)\n\n\t\t\tconsole.debug(recurrenceRule.recurrenceRuleValue._innerValue.toString())\n\t\t}\n\t},\n\n\t/**\n\t * Change the until limit of the recurrence-rule\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} data The destructuring object\n\t * @param {object} data.calendarObjectInstance The calendarObjectInstance object\n\t * @param {object} data.recurrenceRule The recurrenceRule object to modify\n\t * @param {string} data.bySetPosition The new until to set\n\t */\n\tchangeRecurrenceBySetPosition(state, { calendarObjectInstance, recurrenceRule, bySetPosition }) {\n\t\tif (recurrenceRule.recurrenceRuleValue) {\n\t\t\trecurrenceRule.recurrenceRuleValue.setComponent('BYSETPOS', [bySetPosition])\n\t\t\tVue.set(recurrenceRule, 'bySetPosition', bySetPosition)\n\n\t\t\tconsole.debug(recurrenceRule.recurrenceRuleValue._innerValue.toString())\n\t\t}\n\t},\n\n\t/**\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} data The destructuring object\n\t * @param {object} data.calendarObjectInstance The calendarObjectInstance object\n\t * @param {object} data.recurrenceRule The recurrenceRule object to modify\n\t */\n\tunsetRecurrenceBySetPosition(state, { calendarObjectInstance, recurrenceRule }) {\n\t\tif (recurrenceRule.recurrenceRuleValue) {\n\t\t\trecurrenceRule.recurrenceRuleValue.setComponent('BYSETPOS', [])\n\t\t\tVue.set(recurrenceRule, 'bySetPosition', null)\n\n\t\t\tconsole.debug(recurrenceRule.recurrenceRuleValue._innerValue.toString())\n\t\t}\n\t},\n\n\t/**\n\t * Remove the recurrence-rule from the calendarObjectInstance\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} data The destructuring object\n\t * @param {object} data.calendarObjectInstance The calendarObjectInstance object\n\t * @param {object} data.recurrenceRule The recurrenceRule object to modify\n\t */\n\tremoveRecurrenceRuleFromCalendarObjectInstance(state, { calendarObjectInstance, recurrenceRule }) {\n\t\tif (recurrenceRule.recurrenceRuleValue) {\n\t\t\tcalendarObjectInstance.eventComponent.deleteAllProperties('RRULE')\n\t\t\tVue.set(calendarObjectInstance, 'recurrenceRule', getDefaultEventObject().recurrenceRule)\n\n\t\t\tconsole.debug(calendarObjectInstance)\n\t\t\tconsole.debug(recurrenceRule)\n\t\t}\n\t},\n\n\t/**\n\t * Add a new recurrence-rule to the calendarObjectInstance\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} data The destructuring object\n\t * @param {object} data.calendarObjectInstance The calendarObjectInstance object\n\t */\n\taddRecurrenceRuleFromCalendarObjectInstance(state, { calendarObjectInstance }) {\n\t\tconst recurrenceValue = RecurValue.fromData({})\n\t\tconst recurrenceProperty = new Property('RRULE', recurrenceValue)\n\t\tcalendarObjectInstance.eventComponent.addProperty(recurrenceProperty)\n\t\tcalendarObjectInstance.recurrenceRule.recurrenceRuleValue = recurrenceValue\n\t},\n\n\t/**\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} data The destructuring object\n\t * @param {object} data.calendarObjectInstance The calendarObjectInstance object\n\t * @param {object} data.recurrenceRule The recurrenceRule object to modify\n\t */\n\tmarkRecurrenceRuleAsSupported(state, { calendarObjectInstance, recurrenceRule }) {\n\t\trecurrenceRule.isUnsupported = false\n\t},\n\n\t/**\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} data The destructuring object\n\t * @param {object} data.calendarObjectInstance The calendarObjectInstance object\n\t * @param {object} data.alarm The alarm object\n\t * @param {string} data.type New type of alarm\n\t */\n\tchangeAlarmType(state, { calendarObjectInstance, alarm, type }) {\n\t\tif (alarm.alarmComponent) {\n\t\t\talarm.alarmComponent.action = type\n\t\t\talarm.type = type\n\n\t\t\tconsole.debug(alarm.alarmComponent.toICALJs().toString())\n\t\t}\n\t},\n\n\t/**\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} data The destructuring object\n\t * @param {object} data.calendarObjectInstance The calendarObjectInstance object\n\t * @param {object} data.alarm The alarm object\n\t * @param {number} data.amount New amount of timed event\n\t */\n\tchangeAlarmAmountTimed(state, { calendarObjectInstance, alarm, amount }) {\n\t\tif (alarm.alarmComponent) {\n\t\t\talarm.alarmComponent.trigger.value.totalSeconds\n\t\t\t\t= getTotalSecondsFromAmountAndUnitForTimedEvents(amount, alarm.relativeUnitTimed, alarm.relativeIsBefore)\n\n\t\t\talarm.relativeAmountTimed = amount\n\t\t\talarm.relativeTrigger = alarm.alarmComponent.trigger.value.totalSeconds\n\n\t\t\tconsole.debug(alarm.alarmComponent.toICALJs().toString())\n\t\t}\n\n\t},\n\n\t/**\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} data The destructuring object\n\t * @param {object} data.calendarObjectInstance The calendarObjectInstance object\n\t * @param {object} data.alarm The alarm object\n\t * @param {string} data.unit New unit of timed event\n\t */\n\tchangeAlarmUnitTimed(state, { calendarObjectInstance, alarm, unit }) {\n\t\tif (alarm.alarmComponent) {\n\t\t\talarm.alarmComponent.trigger.value.totalSeconds\n\t\t\t\t= getTotalSecondsFromAmountAndUnitForTimedEvents(alarm.relativeAmountTimed, unit, alarm.relativeIsBefore)\n\n\t\t\talarm.relativeUnitTimed = unit\n\t\t\talarm.relativeTrigger = alarm.alarmComponent.trigger.value.totalSeconds\n\n\t\t\tconsole.debug(alarm.alarmComponent.toICALJs().toString())\n\t\t}\n\t},\n\n\t/**\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} data The destructuring object\n\t * @param {object} data.calendarObjectInstance The calendarObjectInstance object\n\t * @param {object} data.alarm The alarm object\n\t * @param {number} data.amount New amount of all-day event\n\t */\n\tchangeAlarmAmountAllDay(state, { calendarObjectInstance, alarm, amount }) {\n\t\tif (alarm.alarmComponent) {\n\t\t\talarm.alarmComponent.trigger.value.totalSeconds\n\t\t\t\t= getTotalSecondsFromAmountHourMinutesAndUnitForAllDayEvents(amount,\n\t\t\t\t\talarm.relativeHoursAllDay, alarm.relativeMinutesAllDay, alarm.relativeUnitAllDay)\n\n\t\t\talarm.relativeAmountAllDay = amount\n\t\t\talarm.relativeTrigger = alarm.alarmComponent.trigger.value.totalSeconds\n\n\t\t\tconsole.debug(alarm.alarmComponent.toICALJs().toString())\n\t\t}\n\t},\n\n\t/**\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} data The destructuring object\n\t * @param {object} data.calendarObjectInstance The calendarObjectInstance object\n\t * @param {object} data.alarm The alarm object\n\t * @param {string} data.unit New Unit of all-day event\n\t */\n\tchangeAlarmUnitAllDay(state, { calendarObjectInstance, alarm, unit }) {\n\t\tif (alarm.alarmComponent) {\n\t\t\talarm.alarmComponent.trigger.value.totalSeconds\n\t\t\t\t= getTotalSecondsFromAmountHourMinutesAndUnitForAllDayEvents(alarm.relativeAmountAllDay,\n\t\t\t\t\talarm.relativeHoursAllDay, alarm.relativeMinutesAllDay, unit)\n\n\t\t\talarm.relativeUnitAllDay = unit\n\t\t\talarm.relativeTrigger = alarm.alarmComponent.trigger.value.totalSeconds\n\n\t\t\tconsole.debug(alarm.alarmComponent.toICALJs().toString())\n\t\t}\n\t},\n\n\t/**\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} data The destructuring object\n\t * @param {object} data.calendarObjectInstance The calendarObjectInstance object\n\t * @param {object} data.alarm The alarm object\n\t * @param {number} data.hours New Hour\n\t * @param {number} data.minutes New Minutes\n\t */\n\tchangeAlarmHoursMinutesAllDay(state, { calendarObjectInstance, alarm, hours, minutes }) {\n\t\tif (alarm.alarmComponent) {\n\t\t\talarm.alarmComponent.trigger.value.totalSeconds\n\t\t\t\t= getTotalSecondsFromAmountHourMinutesAndUnitForAllDayEvents(alarm.relativeAmountAllDay,\n\t\t\t\t\thours, minutes, alarm.relativeUnitAllDay)\n\n\t\t\talarm.relativeHoursAllDay = hours\n\t\t\talarm.relativeMinutesAllDay = minutes\n\t\t\talarm.relativeTrigger = alarm.alarmComponent.trigger.value.totalSeconds\n\n\t\t\tconsole.debug(alarm.alarmComponent.toICALJs().toString())\n\t\t}\n\t},\n\n\t/**\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} data The destructuring object\n\t * @param {object} data.calendarObjectInstance The calendarObjectInstance object\n\t * @param {object} data.alarm The alarm object\n\t * @param {Date} data.date New date object\n\t */\n\tchangeAlarmAbsoluteDate(state, { calendarObjectInstance, alarm, date }) {\n\t\tif (alarm.alarmComponent) {\n\t\t\talarm.alarmComponent.trigger.value.year = date.getFullYear()\n\t\t\talarm.alarmComponent.trigger.value.month = date.getMonth() + 1\n\t\t\talarm.alarmComponent.trigger.value.day = date.getDate()\n\t\t\talarm.alarmComponent.trigger.value.hour = date.getHours()\n\t\t\talarm.alarmComponent.trigger.value.minute = date.getMinutes()\n\t\t\talarm.alarmComponent.trigger.value.second = 0\n\n\t\t\talarm.absoluteDate = date\n\n\t\t\tconsole.debug(alarm.alarmComponent.toICALJs().toString())\n\t\t}\n\t},\n\n\t/**\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} data The destructuring object\n\t * @param {object} data.calendarObjectInstance The calendarObjectInstance object\n\t * @param {object} data.alarm The alarm object\n\t * @param {string} data.timezoneId New timezoneId\n\t */\n\tchangeAlarmAbsoluteTimezoneId(state, { calendarObjectInstance, alarm, timezoneId }) {\n\t\tif (alarm.alarmComponent) {\n\t\t\tconst timezone = getTimezoneManager().getTimezoneForId(timezoneId)\n\t\t\talarm.alarmComponent.trigger.value.replaceTimezone(timezone)\n\n\t\t\talarm.absoluteTimezoneId = timezoneId\n\n\t\t\tconsole.debug(alarm.alarmComponent.toICALJs().toString())\n\t\t}\n\t},\n\n\t/**\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} data The destructuring object\n\t * @param {object} data.calendarObjectInstance The calendarObjectInstance object\n\t * @param {object} data.alarm The alarm object\n\t */\n\tchangeAlarmFromRelativeToAbsolute(state, { calendarObjectInstance, alarm }) {\n\t\tif (alarm.alarmComponent) {\n\t\t\tconst triggerDateTime = calendarObjectInstance.eventComponent.startDate.clone()\n\t\t\t// The trigger of an alarm must be DATE-TIME, startDate can be either.\n\t\t\ttriggerDateTime.isDate = false\n\n\t\t\ttriggerDateTime.addDuration(alarm.alarmComponent.trigger.value)\n\n\t\t\talarm.alarmComponent.setTriggerFromAbsolute(triggerDateTime)\n\n\t\t\talarm.absoluteDate = getDateFromDateTimeValue(alarm.alarmComponent.trigger.value)\n\t\t\talarm.absoluteTimezoneId = alarm.alarmComponent.trigger.value.timezoneId\n\n\t\t\tconsole.debug(alarm.alarmComponent.toICALJs().toString())\n\t\t}\n\t},\n\n\t/**\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} data The destructuring object\n\t * @param {object} data.calendarObjectInstance The calendarObjectInstance object\n\t * @param {object} data.alarm The alarm object\n\t */\n\tchangeAlarmFromAbsoluteToRelative(state, { calendarObjectInstance, alarm }) {\n\t\tif (alarm.alarmComponent) {\n\t\t\tconst duration = alarm.alarmComponent.trigger.value\n\t\t\t\t.subtractDateWithTimezone(calendarObjectInstance.eventComponent.startDate)\n\n\t\t\talarm.alarmComponent.setTriggerFromRelative(duration)\n\t\t\talarm.relativeIsBefore = alarm.alarmComponent.trigger.value.isNegative\n\t\t\talarm.relativeIsRelatedToStart = true\n\t\t\talarm.relativeTrigger = duration.totalSeconds\n\t\t}\n\t},\n\n\t/**\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} data The destructuring object\n\t * @param {object} data.alarm The alarm object\n\t */\n\tresetAlarmRelativeParts(state, { alarm }) {\n\t\talarm.relativeIsBefore = null\n\t\talarm.relativeIsRelatedToStart = null\n\t\talarm.relativeUnitTimed = null\n\t\talarm.relativeAmountTimed = null\n\t\talarm.relativeUnitAllDay = null\n\t\talarm.relativeAmountAllDay = null\n\t\talarm.relativeHoursAllDay = null\n\t\talarm.relativeMinutesAllDay = null\n\t\talarm.relativeTrigger = null\n\t},\n\n\t/**\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} data The destructuring object\n\t * @param {object} data.alarm The alarm object\n\t */\n\tresetAlarmAbsoluteParts(state, { alarm }) {\n\t\talarm.absoluteDate = null\n\t\talarm.absoluteTimezoneId = null\n\t},\n\n\t/**\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} data The destructuring object\n\t * @param {object} data.calendarObjectInstance The calendarObjectInstance object\n\t * @param {object} data.alarm The alarm object\n\t */\n\tupdateAlarmAllDayParts(state, { calendarObjectInstance, alarm }) {\n\t\tif (alarm.alarmComponent) {\n\t\t\tconst totalSeconds = alarm.alarmComponent.trigger.value.totalSeconds\n\t\t\tconst allDayParts = getAmountHoursMinutesAndUnitForAllDayEvents(totalSeconds)\n\n\t\t\talarm.relativeUnitAllDay = allDayParts.unit\n\t\t\talarm.relativeAmountAllDay = allDayParts.amount\n\t\t\talarm.relativeHoursAllDay = allDayParts.hours\n\t\t\talarm.relativeMinutesAllDay = allDayParts.minutes\n\t\t}\n\t},\n\n\t/**\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} data The destructuring object\n\t * @param {object} data.calendarObjectInstance The calendarObjectInstance object\n\t * @param {object} data.alarm The alarm object\n\t */\n\tupdateAlarmTimedParts(state, { calendarObjectInstance, alarm }) {\n\t\tif (alarm.alarmComponent) {\n\t\t\tconst totalSeconds = alarm.alarmComponent.trigger.value.totalSeconds\n\t\t\tconst timedParts = getAmountAndUnitForTimedEvents(totalSeconds)\n\n\t\t\talarm.relativeUnitTimed = timedParts.unit\n\t\t\talarm.relativeAmountTimed = timedParts.amount\n\n\t\t\tconsole.debug(alarm.alarmComponent.toICALJs().toString())\n\t\t}\n\t},\n\n\t/**\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} data The destructuring object\n\t * @param {object} data.calendarObjectInstance The calendarObjectInstance object\n\t * @param {string} data.type Type of alarm\n\t * @param {number} data.totalSeconds Total amount of seconds for new alarm\n\t */\n\taddAlarmToCalendarObjectInstance(state, { calendarObjectInstance, type, totalSeconds }) {\n\t\tif (calendarObjectInstance.eventComponent) {\n\t\t\tconst eventComponent = calendarObjectInstance.eventComponent\n\n\t\t\tconst duration = DurationValue.fromSeconds(totalSeconds)\n\t\t\tconst alarmComponent = eventComponent.addRelativeAlarm(type, duration)\n\n\t\t\tconst alarmObject = mapAlarmComponentToAlarmObject(alarmComponent)\n\n\t\t\tcalendarObjectInstance.alarms.push(alarmObject)\n\n\t\t\tconsole.debug(alarmObject.alarmComponent.toICALJs().toString())\n\t\t}\n\t},\n\n\t/**\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} data The destructuring object\n\t * @param {object} data.calendarObjectInstance The calendarObjectInstance object\n\t * @param {object} data.alarm The alarm object\n\t */\n\tremoveAlarmFromCalendarObjectInstance(state, { calendarObjectInstance, alarm }) {\n\t\tif (alarm.alarmComponent) {\n\t\t\tcalendarObjectInstance.eventComponent.removeAlarm(alarm.alarmComponent)\n\n\t\t\tconst index = calendarObjectInstance.alarms.indexOf(alarm)\n\t\t\tif (index !== -1) {\n\t\t\t\tcalendarObjectInstance.alarms.splice(index, 1)\n\t\t\t}\n\t\t}\n\t},\n\n\t/**\n\t * @deprecated\n\t * @param state\n\t * @param calendarObjectInstance.calendarObjectInstance\n\t * @param calendarObjectInstance\n\t * @param calendarObjectInstance.sharedData\n\t * @param sharedData\n\t */\n\taddAttachmentBySharedData(state, { calendarObjectInstance, sharedData }) {\n\t\tconst attachment = AttachmentProperty.fromLink(sharedData.url)\n\t\tconst fileName = sharedData.fileName\n\n\t\t// hot-fix needed temporary, becase calendar-js has no fileName get-setter\n\t\tconst parameterFileName = new Parameter('FILENAME', fileName)\n\t\t// custom has-preview parameter from dav file\n\t\tconst xNcHasPreview = new Parameter('X-NC-HAS-PREVIEW', sharedData['has-preview'].toString())\n\t\t// custom file id parameter from dav file\n\t\tconst xNcFileId = new Parameter('X-NC-FILE-ID', sharedData.fileid.toString())\n\t\t// custom share-types parameter from dav file\n\t\tconst xNcSharedTypes = new Parameter('X-NC-SHARED-TYPES', sharedData['share-types']['share-type']\n\t\t\t? sharedData['share-types']['share-type'].join(',')\n\t\t\t: '')\n\t    attachment.setParameter(parameterFileName)\n\t    attachment.setParameter(xNcFileId)\n\t    attachment.setParameter(xNcHasPreview)\n\t    attachment.setParameter(xNcSharedTypes)\n\t\tattachment.isNew = true\n\t\tattachment.shareTypes = sharedData['share-types']['share-type']\n\t\t\t? sharedData['share-types']['share-type'].join(',')\n\t\t\t: ''\n\t\tattachment.fileName = fileName\n\t\tattachment.xNcFileId = sharedData.fileid\n\t\tattachment.xNcHasPreview = sharedData['has-preview']\n\t\tattachment.formatType = sharedData.getcontenttype\n\t\tattachment.uri = sharedData.url ? sharedData.url : generateUrl(`/f/${sharedData.fileid}`)\n\n\t\tcalendarObjectInstance.eventComponent.addProperty(attachment)\n\t\tcalendarObjectInstance.attachments.push(attachment)\n\n\t\t// console.log(attachment)\n\t},\n\n\taddAttachmentWithProperty(state, { calendarObjectInstance, sharedData }) {\n\t\tconst attachment = {}\n\t\tconst fileName = sharedData.fileName\n\t\tattachment.isNew = true\n\t\tattachment.shareTypes = (typeof sharedData?.['share-types']?.['share-type'] === 'number'\n\t\t\t? sharedData?.['share-types']?.['share-type']?.toString()\n\t\t\t: sharedData?.['share-types']?.['share-type']?.join(',')) ?? null\n\t\tattachment.fileName = fileName\n\t\tattachment.xNcFileId = sharedData.fileid\n\t\tattachment.xNcHasPreview = sharedData['has-preview']\n\t\tattachment.formatType = sharedData.getcontenttype\n\t\tattachment.uri = sharedData.url ? sharedData.url : generateUrl(`/f/${sharedData.fileid}`)\n\n\t\tconst attachmentProperty = AttachmentProperty.fromLink(attachment.uri, attachment.formatType)\n\t\tconst parameterFileName = new Parameter('FILENAME', fileName)\n\t\tconst xNcHasPreview = new Parameter('X-NC-HAS-PREVIEW', attachment.xNcHasPreview.toString())\n\t\tconst xNcFileId = new Parameter('X-NC-FILE-ID', attachment.xNcFileId.toString())\n\t\t// ADD X-NC-SHARED-TYPES only if sharet-type not empty\n\t\tif (attachment.shareTypes !== null) {\n\t\t\tconst xNcSharedTypes = new Parameter('X-NC-SHARED-TYPES', attachment.shareTypes)\n\t\t\tattachmentProperty.setParameter(xNcSharedTypes)\n\t\t}\n\n\t\tattachmentProperty.setParameter(parameterFileName)\n\t\tattachmentProperty.setParameter(xNcFileId)\n\t\tattachmentProperty.setParameter(xNcHasPreview)\n\t\tattachmentProperty.uri = attachment.uri\n\n\t\tattachment.attachmentProperty = attachmentProperty\n\n\t\tcalendarObjectInstance.eventComponent.addProperty(attachmentProperty)\n\t\tcalendarObjectInstance.attachments.push(attachment)\n\t},\n\n\t/**\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} data The destructuring object\n\t * @param {object} data.calendarObjectInstance The calendarObjectInstance object\n\t * @param {object} data.attachment The attachment object\n\t */\n\tdeleteAttachment(state, { calendarObjectInstance, attachment }) {\n\t\ttry {\n\t\t\tconst index = calendarObjectInstance.attachments.indexOf(attachment)\n\t\t\tif (index !== -1) {\n\t\t\t\t calendarObjectInstance.attachments.splice(index, 1)\n\t\t\t}\n\t\t\tcalendarObjectInstance.eventComponent.removeAttachment(attachment.attachmentProperty)\n\t\t} catch {\n\t\t}\n\n\t},\n}\n\nconst getters = {}\n\nconst actions = {\n\n\t/**\n\t * Returns the closest existing recurrence-id of a calendar-object\n\t * close to the given date.\n\t * This is either the next occurrence in the future or\n\t * in case there are no more future occurrences the closest\n\t * occurrence in the past\n\t *\n\t * @param {object} vuex The vuex destructuring object\n\t * @param {object} vuex.state The Vuex state\n\t * @param {Function} vuex.dispatch The Vuex dispatch function\n\t * @param {Function} vuex.commit The Vuex commit function\n\t * @param {object} data The destructuring object\n\t * @param {string} data.objectId The objectId of the calendar-object to edit\n\t * @param {Date} data.closeToDate The date to get a close occurrence to\n\t * @return {Promise<number>}\n\t */\n\tasync resolveClosestRecurrenceIdForCalendarObject({ state, dispatch, commit }, { objectId, closeToDate }) {\n\t\tconst calendarObject = await dispatch('getEventByObjectId', { objectId })\n\t\tconst iterator = calendarObject.calendarComponent.getVObjectIterator()\n\t\tconst firstVObject = iterator.next().value\n\n\t\tconst d = DateTimeValue.fromJSDate(closeToDate, true)\n\t\treturn firstVObject\n\t\t\t.recurrenceManager\n\t\t\t.getClosestOccurrence(d)\n\t\t\t.getReferenceRecurrenceId()\n\t\t\t.unixTime\n\t},\n\n\t/**\n\t * Gets the calendar-object and calendar-object-instance\n\t * for a given objectId and recurrenceId.\n\t *\n\t * If the recurrenceId does not represent a valid instance,\n\t * an error will be thrown.\n\t *\n\t * @param {object} vuex The vuex destructuring object\n\t * @param {object} vuex.state The Vuex state\n\t * @param {Function} vuex.dispatch The Vuex dispatch function\n\t * @param {Function} vuex.commit The Vuex commit function\n\t * @param {object} data The destructuring object\n\t * @param {string} data.objectId The objectId of the calendar-object to edit\n\t * @param {number} data.recurrenceId The recurrence-id to edit\n\t * @return {Promise<{calendarObject: object, calendarObjectInstance: object}>}\n\t */\n\tasync getCalendarObjectInstanceByObjectIdAndRecurrenceId({ state, dispatch, commit }, { objectId, recurrenceId }) {\n\t\tif (state.existingEvent.objectId === objectId && state.existingEvent.recurrenceId === recurrenceId) {\n\t\t\treturn Promise.resolve({\n\t\t\t\tcalendarObject: state.calendarObject,\n\t\t\t\tcalendarObjectInstance: state.calendarObjectInstance,\n\t\t\t})\n\t\t}\n\n\t\tconst recurrenceIdDate = new Date(recurrenceId * 1000)\n\t\tconst calendarObject = await dispatch('getEventByObjectId', { objectId })\n\t\tconst eventComponent = getObjectAtRecurrenceId(calendarObject, recurrenceIdDate)\n\t\tif (eventComponent === null) {\n\t\t\tthrow new Error('Not a valid recurrence-id')\n\t\t}\n\n\t\tconst calendarObjectInstance = mapEventComponentToEventObject(eventComponent)\n\t\tcommit('setCalendarObjectInstanceForExistingEvent', {\n\t\t\tcalendarObject,\n\t\t\tcalendarObjectInstance,\n\t\t\tobjectId,\n\t\t\trecurrenceId,\n\t\t})\n\n\t\treturn {\n\t\t\tcalendarObject,\n\t\t\tcalendarObjectInstance,\n\t\t}\n\t},\n\n\t/**\n\t * Gets the new calendar-object-instance.\n\t *\n\t * @param {object} vuex The vuex destructuring object\n\t * @param {object} vuex.state The Vuex state\n\t * @param {Function} vuex.dispatch The Vuex dispatch function\n\t * @param {Function} vuex.commit The Vuex commit function\n\t * @param {object} data The destructuring object\n\t * @param {boolean} data.isAllDay Whether or not the new event is supposed to be all-day\n\t * @param {number} data.start The start of the new event (unixtime)\n\t * @param {number} data.end The end of the new event (unixtime)\n\t * @param {string} data.timezoneId The timezoneId of the new event\n\t * @return {Promise<{calendarObject: object, calendarObjectInstance: object}>}\n\t */\n\tasync getCalendarObjectInstanceForNewEvent({ state, dispatch, commit }, { isAllDay, start, end, timezoneId }) {\n\t\tif (state.isNew === true) {\n\t\t\treturn Promise.resolve({\n\t\t\t\tcalendarObject: state.calendarObject,\n\t\t\t\tcalendarObjectInstance: state.calendarObjectInstance,\n\t\t\t})\n\t\t}\n\n\t\tconst calendarObject = await dispatch('createNewEvent', { start, end, isAllDay, timezoneId })\n\t\tconst startDate = new Date(start * 1000)\n\t\tconst eventComponent = getObjectAtRecurrenceId(calendarObject, startDate)\n\t\tconst calendarObjectInstance = mapEventComponentToEventObject(eventComponent)\n\n\t\t// Add an alarm if the user set a default one in the settings. If\n\t\t// not, defaultReminder will not be a number (rather the string \"none\").\n\t\tconst defaultReminder = parseInt(settings.state.defaultReminder)\n\t\tif (!isNaN(defaultReminder)) {\n\t\t\tcommit('addAlarmToCalendarObjectInstance', {\n\t\t\t\tcalendarObjectInstance,\n\t\t\t\ttype: 'DISPLAY',\n\t\t\t\ttotalSeconds: defaultReminder,\n\t\t\t})\n\t\t\tlogger.debug(`Added defaultReminder (${defaultReminder}s) to newly created event`)\n\t\t}\n\n\t\t// Add default status\n\t\tconst rfcProps = getRFCProperties()\n\t\tconst status = rfcProps.status.defaultValue\n\t\tcommit('changeStatus', {\n\t\t\tcalendarObjectInstance,\n\t\t\tstatus,\n\t\t})\n\n\t\tcommit('setCalendarObjectInstanceForNewEvent', {\n\t\t\tcalendarObject,\n\t\t\tcalendarObjectInstance,\n\t\t})\n\n\t\treturn {\n\t\t\tcalendarObject,\n\t\t\tcalendarObjectInstance,\n\t\t}\n\t},\n\n\t/**\n\t * Updates the existing calendar-object-instance.\n\t *\n\t * @param {object} vuex The vuex destructuring object\n\t * @param {object} vuex.state The Vuex state\n\t * @param {Function} vuex.dispatch The Vuex dispatch function\n\t * @param {Function} vuex.commit The Vuex commit function\n\t * @param {object} data The destructuring object\n\t * @param {boolean} data.isAllDay Whether or not the new event is supposed to be all-day\n\t * @param {number} data.start The start of the new event (unixtime)\n\t * @param {number} data.end The end of the new event (unixtime)\n\t * @param {string} data.timezoneId The timezoneId of the new event\n\t * @return {Promise<{calendarObject: object, calendarObjectInstance: object}>}\n\t */\n\tasync updateCalendarObjectInstanceForNewEvent({ state, dispatch, commit }, { isAllDay, start, end, timezoneId }) {\n\t\tawait dispatch('updateTimeOfNewEvent', {\n\t\t\tcalendarObjectInstance: state.calendarObjectInstance,\n\t\t\tstart,\n\t\t\tend,\n\t\t\tisAllDay,\n\t\t\ttimezoneId,\n\t\t})\n\t\tcommit('setCalendarObjectInstanceForNewEvent', {\n\t\t\tcalendarObject: state.calendarObject,\n\t\t\tcalendarObjectInstance: state.calendarObjectInstance,\n\t\t})\n\n\t\treturn {\n\t\t\tcalendarObject: state.calendarObject,\n\t\t\tcalendarObjectInstance: state.calendarObjectInstance,\n\t\t}\n\t},\n\n\t/**\n\t * Saves changes made to a single calendar-object-instance\n\t *\n\t * @param {object} vuex The vuex destructuring object\n\t * @param {object} vuex.state The Vuex state\n\t * @param {Function} vuex.dispatch The Vuex dispatch function\n\t * @param {Function} vuex.commit The Vuex commit function\n\t * @param {object} data The destructuring object\n\t * @param {boolean} data.thisAndAllFuture Whether or not to save changes for all future occurrences or just this one\n\t * @param {string} data.calendarId The new calendar-id to store it in\n\t * @return {Promise<void>}\n\t */\n\tasync saveCalendarObjectInstance({ state, dispatch, commit }, { thisAndAllFuture, calendarId }) {\n\t\tconst eventComponent = state.calendarObjectInstance.eventComponent\n\t\tconst calendarObject = state.calendarObject\n\n\t\tupdateEmailAlarms(eventComponent)\n\t\tupdateTalkParticipants(eventComponent)\n\n\t\tif (eventComponent.isDirty()) {\n\t\t\tconst isForkedItem = eventComponent.primaryItem !== null\n\t\t\tlet original = null\n\t\t\tlet fork = null\n\n\t\t\t// We check if two things apply:\n\t\t\t// - primaryItem !== null -> Is this a fork or not?\n\t\t\t// - eventComponent.canCreateRecurrenceExceptions() - Can we create a recurrence-exception for this item\n\t\t\tif (isForkedItem && eventComponent.canCreateRecurrenceExceptions()) {\n\t\t\t\t[original, fork] = eventComponent.createRecurrenceException(thisAndAllFuture)\n\t\t\t}\n\n\t\t\tawait dispatch('updateCalendarObject', { calendarObject })\n\n\t\t\tif (original !== null && fork !== null && original.root !== fork.root) {\n\t\t\t\tawait dispatch('createCalendarObjectFromFork', {\n\t\t\t\t\teventComponent: fork,\n\t\t\t\t\tcalendarId,\n\t\t\t\t})\n\t\t\t}\n\t\t}\n\n\t\tif (calendarId !== state.calendarObject.calendarId) {\n\t\t\tawait dispatch('moveCalendarObject', {\n\t\t\t\tcalendarObject,\n\t\t\t\tnewCalendarId: calendarId,\n\t\t\t})\n\t\t}\n\t},\n\n\t/**\n\t * Duplicate calendar-object-instance\n\t *\n\t * @param {object} vuex The vuex destructuring object\n\t * @param {object} vuex.state The Vuex state\n\t * @param {Function} vuex.dispatch The Vuex dispatch function\n\t * @param {Function} vuex.commit The Vuex commit function\n\t * @return {Promise<void>}\n\t */\n\tasync duplicateCalendarObjectInstance({ state, dispatch, commit }) {\n\t\tconst oldCalendarObjectInstance = state.calendarObjectInstance\n\t\tconst oldEventComponent = oldCalendarObjectInstance.eventComponent\n\t\tconst startDate = oldEventComponent.startDate.getInUTC()\n\t\tconst endDate = oldEventComponent.endDate.getInUTC()\n\t\tconst calendarObject = await dispatch('createNewEvent', {\n\t\t\tstart: startDate.unixTime,\n\t\t\tend: endDate.unixTime,\n\t\t\ttimezoneId: oldEventComponent.startDate.timezoneId,\n\t\t\tisAllDay: oldEventComponent.isAllDay(),\n\t\t})\n\t\tconst eventComponent = getObjectAtRecurrenceId(calendarObject, startDate.jsDate)\n\t\tcopyCalendarObjectInstanceIntoEventComponent(oldCalendarObjectInstance, eventComponent)\n\t\tconst calendarObjectInstance = mapEventComponentToEventObject(eventComponent)\n\n\t\tawait commit('setCalendarObjectInstanceForNewEvent', { calendarObject, calendarObjectInstance })\n\t},\n\n\t/**\n\t * Deletes a calendar-object-instance\n\t *\n\t * @param {object} vuex The vuex destructuring object\n\t * @param {object} vuex.state The Vuex state\n\t * @param {Function} vuex.dispatch The Vuex dispatch function\n\t * @param {Function} vuex.commit The Vuex commit function\n\t * @param {object} data The destructuring object\n\t * @param {boolean} data.thisAndAllFuture Whether or not to delete all future occurrences or just this one\n\t * @return {Promise<void>}\n\t */\n\tasync deleteCalendarObjectInstance({ state, dispatch, commit }, { thisAndAllFuture }) {\n\t\tconst eventComponent = state.calendarObjectInstance.eventComponent\n\t\tconst isRecurrenceSetEmpty = eventComponent.removeThisOccurrence(thisAndAllFuture)\n\t\tconst calendarObject = state.calendarObject\n\n\t\tif (isRecurrenceSetEmpty) {\n\t\t\tawait dispatch('deleteCalendarObject', { calendarObject })\n\t\t} else {\n\t\t\tawait dispatch('updateCalendarObject', { calendarObject })\n\t\t}\n\t},\n\n\t/**\n\t *\n\t * @param {object} data The destructuring object for Vuex\n\t * @param {Function} data.commit The Vuex commit function\n\t * @param {object} data2 The destructuring object for data\n\t * @param {object} data2.calendarObjectInstance The calendarObjectInstance object\n\t * @param {Date} data2.startDate The new start-date\n\t */\n\tchangeStartDate({ commit }, { calendarObjectInstance, startDate }) {\n\t\tconst difference = startDate.getTime() - calendarObjectInstance.startDate.getTime()\n\t\tconst endDate = new Date(calendarObjectInstance.endDate.getTime() + difference)\n\n\t\tcommit('changeStartDate', {\n\t\t\tcalendarObjectInstance,\n\t\t\tstartDate,\n\t\t})\n\t\tcommit('changeEndDate', {\n\t\t\tcalendarObjectInstance,\n\t\t\tendDate,\n\t\t})\n\t},\n\n\t/**\n\t * Change the timezone of the event's start\n\t *\n\t * @param {object} data The destructuring object for Vuex\n\t * @param {Function} data.commit The Vuex commit function\n\t * @param {object} data2 The destructuring object for data\n\t * @param {object} data2.calendarObjectInstance The calendarObjectInstance object\n\t * @param {string} data2.startTimezone New timezone to set for start\n\t */\n\tchangeStartTimezone({ commit }, { calendarObjectInstance, startTimezone }) {\n\t\tcommit('changeStartTimezone', { calendarObjectInstance, startTimezone })\n\n\t\t// Simulate a change of the start time to trigger the comparison\n\t\t// of start and end and trigger an update of end if necessary\n\t\tcommit('changeStartDate', {\n\t\t\tcalendarObjectInstance,\n\t\t\tstartDate: calendarObjectInstance.startDate,\n\t\t})\n\t},\n\n\t/**\n\t * Change the timezone of the event's end\n\t *\n\t * @param {object} data The destructuring object for Vuex\n\t * @param {Function} data.commit The Vuex commit function\n\t * @param {object} data2 The destructuring object for data\n\t * @param {object} data2.calendarObjectInstance The calendarObjectInstance object\n\t * @param {string} data2.endTimezone New timezone to set for end\n\t */\n\tchangeEndTimezone({ commit }, { calendarObjectInstance, endTimezone }) {\n\t\tcommit('changeEndTimezone', { calendarObjectInstance, endTimezone })\n\n\t\t// Simulate a change of the end time to trigger the comparison\n\t\t// of start and end and trigger an update of start if necessary\n\t\tcommit('changeEndDate', {\n\t\t\tcalendarObjectInstance,\n\t\t\tendDate: calendarObjectInstance.endDate,\n\t\t})\n\t},\n\n\t/**\n\t *\n\t * @param {object} data The destructuring object for Vuex\n\t * @param {Function} data.commit The Vuex commit function\n\t * @param {Function} data.dispatch The Vuex dispatch function\n\t * @param {object} data2 The destructuring object for data\n\t * @param {object} data2.calendarObjectInstance The calendarObjectInstance object\n\t * @param {object} data2.recurrenceRule The recurrenceRule object to modify\n\t * @param {string} data2.frequency The new frequency to set\n\t */\n\tchangeRecurrenceFrequency({ commit, dispatch }, { calendarObjectInstance, recurrenceRule, frequency }) {\n\n\t\tconsole.debug(calendarObjectInstance)\n\t\tconsole.debug(recurrenceRule)\n\t\tconsole.debug(frequency)\n\n\t\tif (recurrenceRule.frequency === 'NONE' && frequency !== 'NONE') {\n\t\t\t// Add a new recurrence-rule\n\t\t\tcommit('addRecurrenceRuleFromCalendarObjectInstance', { calendarObjectInstance })\n\t\t\tcommit('resetRecurrenceByParts', { calendarObjectInstance, recurrenceRule })\n\t\t\tcommit('changeRecurrenceFrequency', {\n\t\t\t\tcalendarObjectInstance,\n\t\t\t\trecurrenceRule: calendarObjectInstance.recurrenceRule,\n\t\t\t\tfrequency,\n\t\t\t})\n\t\t\tcommit('changeRecurrenceInterval', {\n\t\t\t\tcalendarObjectInstance,\n\t\t\t\trecurrenceRule: calendarObjectInstance.recurrenceRule,\n\t\t\t\tinterval: 1,\n\t\t\t})\n\t\t\tcommit('changeRecurrenceToInfinite', {\n\t\t\t\tcalendarObjectInstance,\n\t\t\t\trecurrenceRule: calendarObjectInstance.recurrenceRule,\n\t\t\t})\n\t\t\tdispatch('setDefaultRecurrenceByParts', { calendarObjectInstance, recurrenceRule, frequency })\n\n\t\t\tconsole.debug(`changed from none to ${frequency}`)\n\t\t} else if (recurrenceRule.frequency !== 'NONE' && frequency === 'NONE') {\n\t\t\tconsole.debug('calling removeRecurrenceRuleFromCalendarObjectInstance')\n\t\t\t// Remove the recurrence-rule\n\t\t\tcommit('removeRecurrenceRuleFromCalendarObjectInstance', { calendarObjectInstance, recurrenceRule })\n\t\t} else {\n\t\t\t// Change frequency of existing recurrence-rule\n\t\t\tcommit('resetRecurrenceByParts', { calendarObjectInstance, recurrenceRule })\n\t\t\tcommit('changeRecurrenceFrequency', {\n\t\t\t\tcalendarObjectInstance,\n\t\t\t\trecurrenceRule: calendarObjectInstance.recurrenceRule,\n\t\t\t\tfrequency,\n\t\t\t})\n\t\t\tdispatch('setDefaultRecurrenceByParts', { calendarObjectInstance, recurrenceRule, frequency })\n\t\t}\n\t},\n\n\t/**\n\t *\n\t * @param {object} data The destructuring object for Vuex\n\t * @param {Function} data.commit The Vuex commit function\n\t * @param {object} data2 The destructuring object for data\n\t * @param {object} data2.calendarObjectInstance The calendarObjectInstance object\n\t * @param {object} data2.recurrenceRule The recurrenceRule object to modify\n\t * @param {string} data2.frequency The new frequency to set\n\t */\n\tsetDefaultRecurrenceByParts({ commit }, { calendarObjectInstance, recurrenceRule, frequency }) {\n\t\tswitch (frequency) {\n\t\tcase 'WEEKLY':\n\t\t\tcommit('setDefaultRecurrenceByPartsForWeekly', { calendarObjectInstance, recurrenceRule })\n\t\t\tbreak\n\n\t\tcase 'MONTHLY':\n\t\t\tcommit('setDefaultRecurrenceByPartsForMonthly', { calendarObjectInstance, recurrenceRule })\n\t\t\tbreak\n\n\t\tcase 'YEARLY':\n\t\t\tcommit('setDefaultRecurrenceByPartsForYearly', { calendarObjectInstance, recurrenceRule })\n\t\t\tbreak\n\t\t}\n\t},\n\n\t/**\n\t *\n\t * @param {object} data The destructuring object for Vuex\n\t * @param {Function} data.commit The Vuex commit function\n\t * @param {object} data2 The destructuring object for data\n\t * @param {object} data2.calendarObjectInstance The calendarObjectInstance object\n\t * @param {object} data2.recurrenceRule The recurrenceRule object to modify\n\t */\n\tsetRecurrenceToInfinite({ commit }, { calendarObjectInstance, recurrenceRule }) {\n\t\tcommit('changeRecurrenceToInfinite', {\n\t\t\tcalendarObjectInstance,\n\t\t\trecurrenceRule,\n\t\t})\n\t},\n\n\t/**\n\t *\n\t * @param {object} data The destructuring object for Vuex\n\t * @param {Function} data.commit The Vuex commit function\n\t * @param {object} data2 The destructuring object for data\n\t * @param {object} data2.calendarObjectInstance The calendarObjectInstance object\n\t * @param {object} data2.recurrenceRule The recurrenceRule object to modify\n\t */\n\tchangeMonthlyRecurrenceFromByDayToBySetPosition({ commit }, { calendarObjectInstance, recurrenceRule }) {\n\t\tconsole.debug('changeMonthlyRecurrenceFromByDayToBySetPosition')\n\t\tcommit('resetRecurrenceByParts', { calendarObjectInstance, recurrenceRule })\n\t\tcommit('setDefaultRecurrenceByPartsForMonthlyBySetPosition', { calendarObjectInstance, recurrenceRule })\n\t},\n\n\t/**\n\t *\n\t * @param {object} data The destructuring object for Vuex\n\t * @param {Function} data.commit The Vuex commit function\n\t * @param {object} data2 The destructuring object for data\n\t * @param {object} data2.calendarObjectInstance The calendarObjectInstance object\n\t * @param {object} data2.recurrenceRule The recurrenceRule object to modify\n\t */\n\tchangeMonthlyRecurrenceFromBySetPositionToByDay({ commit }, { calendarObjectInstance, recurrenceRule }) {\n\t\tconsole.debug('changeMonthlyRecurrenceFromBySetPositionToByDay')\n\t\tcommit('resetRecurrenceByParts', { calendarObjectInstance, recurrenceRule })\n\t\tcommit('setDefaultRecurrenceByPartsForMonthly', { calendarObjectInstance, recurrenceRule })\n\t},\n\n\t/**\n\t *\n\t * @param {object} data The destructuring object for Vuex\n\t * @param {Function} data.commit The Vuex commit function\n\t * @param {object} data2 The destructuring object for data\n\t * @param {object} data2.calendarObjectInstance The calendarObjectInstance object\n\t * @param {object} data2.recurrenceRule The recurrenceRule object to modify\n\t */\n\tenableYearlyRecurrenceBySetPosition({ commit }, { calendarObjectInstance, recurrenceRule }) {\n\t\tcommit('setDefaultRecurrenceByPartsForMonthlyBySetPosition', {\n\t\t\tcalendarObjectInstance,\n\t\t\trecurrenceRule,\n\t\t})\n\t},\n\n\t/**\n\t *\n\t * @param {object} data The destructuring object for Vuex\n\t * @param {Function} data.commit The Vuex commit function\n\t * @param {object} data2 The destructuring object for data\n\t * @param {object} data2.calendarObjectInstance The calendarObjectInstance object\n\t * @param {object} data2.recurrenceRule The recurrenceRule object to modify\n\t */\n\tdisableYearlyRecurrenceBySetPosition({ commit }, { calendarObjectInstance, recurrenceRule }) {\n\t\tcommit('changeRecurrenceByDay', {\n\t\t\tcalendarObjectInstance,\n\t\t\trecurrenceRule,\n\t\t\tbyDay: [],\n\t\t})\n\t\tcommit('unsetRecurrenceBySetPosition', {\n\t\t\tcalendarObjectInstance,\n\t\t\trecurrenceRule,\n\t\t})\n\t},\n\n\t/**\n\t *\n\t * @param {object} data The destructuring object for Vuex\n\t * @param {Function} data.commit The Vuex commit function\n\t * @param {object} data2 The destructuring object for data\n\t * @param {object} data2.calendarObjectInstance The calendarObjectInstance object\n\t * @param {object} data2.recurrenceRule The recurrenceRule object to modify\n\t */\n\tenableRecurrenceLimitByUntil({ commit }, { calendarObjectInstance, recurrenceRule }) {\n\t\tlet until\n\t\tswitch (recurrenceRule.frequency) {\n\t\t// Defaults to 7 days\n\t\tcase 'DAILY':\n\t\t\tuntil = new Date(calendarObjectInstance.startDate.getTime() + 7 * 24 * 60 * 60 * 1000)\n\t\t\tbreak\n\n\t\t// Defaults to 4 weeks\n\t\tcase 'WEEKLY':\n\t\t\tuntil = new Date(calendarObjectInstance.startDate.getTime() + 4 * 7 * 24 * 60 * 60 * 1000)\n\t\t\tbreak\n\n\t\t// Defaults to 10 year\n\t\tcase 'YEARLY':\n\t\t\tuntil = new Date(\n\t\t\t\tcalendarObjectInstance.startDate.getFullYear() + 10,\n\t\t\t\tcalendarObjectInstance.startDate.getMonth(),\n\t\t\t\tcalendarObjectInstance.startDate.getDate(),\n\t\t\t\t23,\n\t\t\t\t59,\n\t\t\t\t59\n\t\t\t)\n\t\t\tbreak\n\n\t\t// Defaults to 12 months\n\t\tcase 'MONTHLY':\n\t\tdefault:\n\t\t\tuntil = new Date(\n\t\t\t\tcalendarObjectInstance.startDate.getFullYear() + 1,\n\t\t\t\tcalendarObjectInstance.startDate.getMonth(),\n\t\t\t\tcalendarObjectInstance.startDate.getDate(),\n\t\t\t\t23,\n\t\t\t\t59,\n\t\t\t\t59\n\t\t\t)\n\t\t\tbreak\n\t\t}\n\n\t\tcommit('changeRecurrenceToInfinite', { calendarObjectInstance, recurrenceRule })\n\t\tcommit('changeRecurrenceUntil', {\n\t\t\tcalendarObjectInstance,\n\t\t\trecurrenceRule,\n\t\t\tuntil,\n\t\t})\n\t},\n\n\t/**\n\t *\n\t * @param {object} data The destructuring object for Vuex\n\t * @param {Function} data.commit The Vuex commit function\n\t * @param {object} data2 The destructuring object for data\n\t * @param {object} data2.calendarObjectInstance The calendarObjectInstance object\n\t * @param {object} data2.recurrenceRule The recurrenceRule object to modify\n\t */\n\tenableRecurrenceLimitByCount({ commit }, { calendarObjectInstance, recurrenceRule }) {\n\t\tcommit('changeRecurrenceToInfinite', { calendarObjectInstance, recurrenceRule })\n\t\tcommit('changeRecurrenceCount', {\n\t\t\tcalendarObjectInstance,\n\t\t\trecurrenceRule,\n\t\t\tcount: 2, // Default value is two\n\t\t})\n\t},\n\n\tchangeAlarmAmountTimed({ commit }, { calendarObjectInstance, alarm, amount }) {\n\t\tcommit('changeAlarmAmountTimed', { calendarObjectInstance, alarm, amount })\n\t\tcommit('updateAlarmAllDayParts', { calendarObjectInstance, alarm })\n\t},\n\n\tchangeAlarmUnitTimed({ commit }, { calendarObjectInstance, alarm, unit }) {\n\t\tcommit('changeAlarmUnitTimed', { calendarObjectInstance, alarm, unit })\n\t\tcommit('updateAlarmAllDayParts', { calendarObjectInstance, alarm })\n\t},\n\n\tchangeAlarmAmountAllDay({ commit }, { calendarObjectInstance, alarm, amount }) {\n\t\tcommit('changeAlarmAmountAllDay', { calendarObjectInstance, alarm, amount })\n\t\tcommit('updateAlarmTimedParts', { calendarObjectInstance, alarm })\n\t},\n\n\tchangeAlarmUnitAllDay({ commit }, { calendarObjectInstance, alarm, unit }) {\n\t\tcommit('changeAlarmUnitAllDay', { calendarObjectInstance, alarm, unit })\n\t\tcommit('updateAlarmTimedParts', { calendarObjectInstance, alarm })\n\t},\n\n\tchangeAlarmHoursMinutesAllDay({ commit }, { calendarObjectInstance, alarm, hours, minutes }) {\n\t\tcommit('changeAlarmHoursMinutesAllDay', { calendarObjectInstance, alarm, hours, minutes })\n\t\tcommit('updateAlarmTimedParts', { calendarObjectInstance, alarm })\n\t},\n\n\tchangeAlarmFromRelativeToAbsolute({ commit }, { calendarObjectInstance, alarm }) {\n\t\tcommit('changeAlarmFromRelativeToAbsolute', { calendarObjectInstance, alarm })\n\t\tcommit('resetAlarmRelativeParts', { alarm })\n\t},\n\n\tchangeAlarmFromAbsoluteToRelative({ commit }, { calendarObjectInstance, alarm }) {\n\t\tcommit('changeAlarmFromAbsoluteToRelative', { calendarObjectInstance, alarm })\n\t\tcommit('updateAlarmAllDayParts', { calendarObjectInstance, alarm })\n\t\tcommit('updateAlarmTimedParts', { calendarObjectInstance, alarm })\n\t\tcommit('resetAlarmAbsoluteParts', { alarm })\n\t},\n\n\ttoggleAllDay({ commit, getters }, { calendarObjectInstance }) {\n\t\tcommit('toggleAllDay', { calendarObjectInstance })\n\n\t\tif (!calendarObjectInstance.isAllDay) {\n\t\t\tif (calendarObjectInstance.startTimezoneId === 'floating') {\n\t\t\t\tconst startTimezone = getters.getResolvedTimezone\n\t\t\t\tcommit('changeStartTimezone', { calendarObjectInstance, startTimezone })\n\t\t\t}\n\n\t\t\tcommit('changeTimeToDefaultForTimedEvents', { calendarObjectInstance })\n\t\t}\n\t},\n\n}\n\nexport default { state, mutations, getters, actions }\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <oc.list@georgehrke.com>\n *\n * @author John Molakvo <skjnldsv@protonmail.com>\n *\n * @author Thomas Citharel <tcit@tcit.fr>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport Vue from 'vue'\nimport { mapCalendarJsToCalendarObject } from '../models/calendarObject.js'\nimport logger from '../utils/logger.js'\nimport {\n\tcreateEvent,\n\tgetParserManager,\n\tgetTimezoneManager,\n\tDateTimeValue,\n} from '@nextcloud/calendar-js'\n\nconst state = {\n\tcalendarObjects: {},\n\tmodificationCount: 0,\n}\n\nconst mutations = {\n\n\t/**\n\t * Adds an array of calendar-objects to the store\n\t *\n\t * @param {object} state The store data\n\t * @param {object} data The destructuring object\n\t * @param {object[]} data.calendarObjects Calendar-objects to add\n\t */\n\tappendCalendarObjects(state, { calendarObjects = [] }) {\n\t\tfor (const calendarObject of calendarObjects) {\n\t\t\tif (!state.calendarObjects[calendarObject.id]) {\n\t\t\t\tVue.set(state.calendarObjects, calendarObject.id, calendarObject)\n\t\t\t}\n\t\t}\n\t},\n\n\t/**\n\t * Adds one calendar-object to the store\n\t *\n\t * @param {object} state The store data\n\t * @param {object} data The destructuring object\n\t * @param {object} data.calendarObject Calendar-object to add\n\t */\n\tappendCalendarObject(state, { calendarObject }) {\n\t\tif (!state.calendarObjects[calendarObject.id]) {\n\t\t\tVue.set(state.calendarObjects, calendarObject.id, calendarObject)\n\t\t}\n\t},\n\n\t/**\n\t * Updates a calendar-object id\n\t *\n\t * @param {object} state The store data\n\t * @param {object} data The destructuring object\n\t * @param {object} data.calendarObject Calendar-object to update\n\t */\n\tupdateCalendarObjectId(state, { calendarObject }) {\n\t\tif (calendarObject.dav === null) {\n\t\t\tcalendarObject.id = null\n\t\t} else {\n\t\t\tcalendarObject.id = btoa(calendarObject.dav.url)\n\t\t}\n\t},\n\n\t/**\n\t * Updates a calendar-object's calendarId\n\t *\n\t * @param {object} state The store data\n\t * @param {object} data The destructuring object\n\t * @param {string} data.calendarObjectId Id of calendar-object to update\n\t * @param {string} data.calendarId New calendarId\n\t */\n\tupdateCalendarObjectIdCalendarId(state, { calendarObjectId, calendarId }) {\n\t\tstate.calendarObjects[calendarObjectId].calendarId = calendarId\n\t},\n\n\t/**\n\t * Resets a calendar-object to it's original server state\n\t *\n\t * @param {object} state The store data\n\t * @param {object} data The destructuring object\n\t * @param {object} data.calendarObject Calendar-object to reset\n\t */\n\tresetCalendarObjectToDav(state, { calendarObject }) {\n\t\tcalendarObject = state.calendarObjects[calendarObject.id]\n\n\t\t// If this object does not exist on the server yet, there is nothing to do\n\t\tif (!calendarObject || !calendarObject.existsOnServer) {\n\t\t\treturn\n\t\t}\n\n\t\tconst parserManager = getParserManager()\n\t\tconst parser = parserManager.getParserForFileType('text/calendar')\n\t\tparser.parse(calendarObject.dav.data)\n\n\t\tconst itemIterator = parser.getItemIterator()\n\t\tconst firstVCalendar = itemIterator.next().value\n\t\tif (firstVCalendar) {\n\t\t\tcalendarObject.calendarComponent = firstVCalendar\n\t\t}\n\t},\n\n\t/**\n\t * Removes a calendar-object from the store\n\t *\n\t * @param {object} state The store data\n\t * @param {object} data The destructuring object\n\t * @param {object} data.calendarObject Calendar-object to delete\n\t */\n\tdeleteCalendarObject(state, { calendarObject }) {\n\t\tVue.delete(state.calendarObjects, calendarObject.id)\n\t},\n\n\t/**\n\t * Increments the modification count\n\t *\n\t * @param {object} state The store data\n\t */\n\tincrementModificationCount(state) {\n\t\tstate.modificationCount++\n\t},\n}\n\nconst getters = {\n\n\t/**\n\t * Gets a calendar-object based on its id\n\t *\n\t * @param {object} state The store data\n\t * @return {function({String}): CalendarObject}\n\t */\n\tgetCalendarObjectById: (state) => (id) => state.calendarObjects[id],\n}\n\nconst actions = {\n\n\t/**\n\t * Moves a calendar-object to a different calendar\n\t *\n\t * @param {object} context the store mutations\n\t * @param {object} data destructuring object\n\t * @param {CalendarObject} data.calendarObject Calendar-object to delete\n\t * @param {string} data.newCalendarId Calendar-Id of calendar to move this calendar-object to\n\t * @return {Promise<void>}\n\t */\n\tasync moveCalendarObject(context, { calendarObject, newCalendarId }) {\n\t\tif (!calendarObject.existsOnServer) {\n\t\t\treturn\n\t\t}\n\n\t\tconst oldCalendarObjectId = calendarObject.id\n\t\tconst oldCalendarId = calendarObject.calendarId\n\n\t\tif (oldCalendarId === newCalendarId) {\n\t\t\tlogger.error('Old calendar Id and new calendar Id are the same, nothing to move')\n\t\t\treturn\n\t\t}\n\n\t\tconst newCalendar = context.getters.getCalendarById(newCalendarId)\n\t\tif (!newCalendar) {\n\t\t\tlogger.error('Calendar to move to not found, aborting')\n\t\t\treturn\n\t\t}\n\n\t\tawait calendarObject.dav.move(newCalendar.dav)\n\t\t// Update calendarId in calendarObject manually as it is not stored in dav\n\t\tcontext.commit('updateCalendarObjectIdCalendarId', {\n\t\t\tcalendarObjectId: calendarObject.id,\n\t\t\tcalendarId: newCalendarId,\n\t\t})\n\n\t\tcontext.commit('addCalendarObjectToCalendar', {\n\t\t\tcalendar: {\n\t\t\t\tid: newCalendarId,\n\t\t\t},\n\t\t\tcalendarObjectId: calendarObject.id,\n\t\t})\n\t\tcontext.commit('addCalendarObjectIdToAllTimeRangesOfCalendar', {\n\t\t\tcalendarId: newCalendarId,\n\t\t\tcalendarObjectId: calendarObject.id,\n\t\t})\n\n\t\tcontext.commit('deleteCalendarObjectFromCalendar', {\n\t\t\tcalendar: {\n\t\t\t\tid: oldCalendarId,\n\t\t\t},\n\t\t\tcalendarObjectId: oldCalendarObjectId,\n\t\t})\n\t\tcontext.commit('removeCalendarObjectIdFromAllTimeRangesOfCalendar', {\n\t\t\tcalendarId: oldCalendarId,\n\t\t\tcalendarObjectId: oldCalendarObjectId,\n\t\t})\n\n\t\tcontext.commit('incrementModificationCount')\n\t},\n\n\t/**\n\t * Updates a calendar-object\n\t *\n\t * @param {object} context the store mutations\n\t * @param {object} data destructuring object\n\t * @param {CalendarObject} data.calendarObject Calendar-object to delete\n\t * @return {Promise<void>}\n\t */\n\tasync updateCalendarObject(context, { calendarObject }) {\n\t\tif (calendarObject.existsOnServer) {\n\t\t\tcalendarObject.dav.data = calendarObject.calendarComponent.toICS()\n\t\t\tawait calendarObject.dav.update()\n\n\t\t\tcontext.commit('addCalendarObjectIdToAllTimeRangesOfCalendar', {\n\t\t\t\tcalendarId: calendarObject.calendarId,\n\t\t\t\tcalendarObjectId: calendarObject.id,\n\t\t\t})\n\t\t\tcontext.commit('incrementModificationCount')\n\n\t\t\treturn\n\n\t\t\t// TODO - catch conflicts\n\t\t}\n\n\t\tconst calendar = context.getters.getCalendarById(calendarObject.calendarId)\n\t\tcalendarObject.dav = await calendar.dav.createVObject(calendarObject.calendarComponent.toICS())\n\t\tcalendarObject.existsOnServer = true\n\t\tcontext.commit('updateCalendarObjectId', { calendarObject })\n\n\t\tcontext.commit('appendCalendarObject', { calendarObject })\n\t\tcontext.commit('addCalendarObjectToCalendar', {\n\t\t\tcalendar: {\n\t\t\t\tid: calendarObject.calendarId,\n\t\t\t},\n\t\t\tcalendarObjectId: calendarObject.id,\n\t\t})\n\t\tcontext.commit('addCalendarObjectIdToAllTimeRangesOfCalendar', {\n\t\t\tcalendarId: calendarObject.calendarId,\n\t\t\tcalendarObjectId: calendarObject.id,\n\t\t})\n\t\tcontext.commit('resetCalendarObjectToDav', { calendarObject })\n\t\tcontext.commit('incrementModificationCount')\n\t},\n\n\t/**\n\t * Creates a new calendar-object from an recurrence-exception fork\n\t *\n\t * @param {object} context The Vuex context\n\t * @param {object} data destructuring object\n\t * @param {EventComponent} data.eventComponent EventComponent to store\n\t * @param {string} data.calendarId The calendar-id to store it in\n\t * @return {Promise<void>}\n\t */\n\tasync createCalendarObjectFromFork(context, { eventComponent, calendarId }) {\n\t\tconst calendar = context.getters.getCalendarById(calendarId)\n\t\tconst calendarObject = mapCalendarJsToCalendarObject(eventComponent.root, calendar.id)\n\t\tcalendarObject.dav = await calendar.dav.createVObject(calendarObject.calendarComponent.toICS())\n\t\tcalendarObject.existsOnServer = true\n\t\tcontext.commit('updateCalendarObjectId', { calendarObject })\n\n\t\tcontext.commit('appendCalendarObject', { calendarObject })\n\t\tcontext.commit('addCalendarObjectToCalendar', {\n\t\t\tcalendar: {\n\t\t\t\tid: calendarObject.calendarId,\n\t\t\t},\n\t\t\tcalendarObjectId: calendarObject.id,\n\t\t})\n\t\tcontext.commit('addCalendarObjectIdToAllTimeRangesOfCalendar', {\n\t\t\tcalendarId: calendar.id,\n\t\t\tcalendarObjectId: calendarObject.id,\n\t\t})\n\t\tcontext.commit('incrementModificationCount')\n\t},\n\n\t/**\n\t * Deletes a calendar-object\n\t *\n\t * @param {object} context the store mutations\n\t * @param {object} data destructuring object\n\t * @param {CalendarObject} data.calendarObject Calendar-object to delete\n\t * @return {Promise<void>}\n\t */\n\tasync deleteCalendarObject(context, { calendarObject }) {\n\t\t// If this calendar-object was not created on the server yet,\n\t\t// no need to send requests to the server\n\t\tif (calendarObject.existsOnServer) {\n\t\t\tawait calendarObject.dav.delete()\n\t\t}\n\n\t\tcontext.commit('deleteCalendarObject', { calendarObject })\n\t\tcontext.commit('deleteCalendarObjectFromCalendar', {\n\t\t\tcalendar: {\n\t\t\t\tid: calendarObject.calendarId,\n\t\t\t},\n\t\t\tcalendarObjectId: calendarObject.id,\n\t\t})\n\t\tcontext.commit('removeCalendarObjectIdFromAnyTimeRange', {\n\t\t\tcalendarObjectId: calendarObject.id,\n\t\t})\n\t\tcontext.commit('incrementModificationCount')\n\t},\n\n\t/**\n\t * Creates a new calendar object based on start, end, timezone and isAllDay\n\t *\n\t * @param {object} context the store mutations\n\t * @param {object} data destructuring object\n\t * @param {number} data.start Timestamp for start of new event\n\t * @param {number} data.end Timestamp for end of new event\n\t * @param {string} data.timezoneId asd\n\t * @param {boolean} data.isAllDay foo\n\t * @return {Promise<CalendarObject>}\n\t */\n\tcreateNewEvent(context, { start, end, timezoneId, isAllDay }) {\n\t\tconst timezoneManager = getTimezoneManager()\n\t\tconst timezone = timezoneManager.getTimezoneForId(timezoneId)\n\n\t\tconst startDate = new Date(start * 1000)\n\t\tconst endDate = new Date(end * 1000)\n\n\t\tconst startDateTime = DateTimeValue\n\t\t\t.fromJSDate(startDate, true)\n\t\t\t.getInTimezone(timezone)\n\t\tconst endDateTime = DateTimeValue\n\t\t\t.fromJSDate(endDate, true)\n\t\t\t.getInTimezone(timezone)\n\n\t\tif (isAllDay) {\n\t\t\tstartDateTime.isDate = true\n\t\t\tendDateTime.isDate = true\n\t\t}\n\n\t\tconst calendar = createEvent(startDateTime, endDateTime)\n\t\tfor (const vObject of calendar.getVObjectIterator()) {\n\t\t\tvObject.undirtify()\n\t\t}\n\n\t\tconst firstCalendar = context.getters.sortedCalendars[0].id\n\t\treturn Promise.resolve(mapCalendarJsToCalendarObject(calendar, firstCalendar))\n\t},\n\n\t/**\n\t * Updates the time of the new calendar object\n\t *\n\t * @param {object} data The destructuring object for Vuex\n\t * @param {Function} data.commit The Vuex commit function\n\t * @param {Function} data.dispatch The Vuex dispatch function\n\t * @param {object} data2 destructuring object\n\t * @param {CalendarObject} data2.calendarObjectInstance Calendar-object to\n\t * @param {number} data2.start Timestamp for start of new event\n\t * @param {number} data2.end Timestamp for end of new event\n\t * @param {string} data2.timezoneId asd\n\t * @param {boolean} data2.isAllDay foo\n\t */\n\tupdateTimeOfNewEvent({ commit, dispatch }, { calendarObjectInstance, start, end, timezoneId, isAllDay }) {\n\t\tconst isDirty = calendarObjectInstance.eventComponent.isDirty()\n\t\tconst startDate = new Date(start * 1000)\n\t\tconst endDate = new Date(end * 1000)\n\n\t\tif (calendarObjectInstance.isAllDay !== isAllDay) {\n\t\t\tcommit('toggleAllDay', { calendarObjectInstance })\n\t\t}\n\n\t\tdispatch('changeStartTimezone', {\n\t\t\tcalendarObjectInstance,\n\t\t\tstartTimezone: timezoneId,\n\t\t})\n\t\tdispatch('changeEndTimezone', {\n\t\t\tcalendarObjectInstance,\n\t\t\tendTimezone: timezoneId,\n\t\t})\n\n\t\tcommit('changeStartDate', {\n\t\t\tcalendarObjectInstance,\n\t\t\tstartDate,\n\t\t})\n\n\t\tif (isAllDay) {\n\t\t\t// The full-calendar end date is exclusive, but the end-date\n\t\t\t// that changeEndDate expects is inclusive, so we have to deduct one day.\n\t\t\tcommit('changeEndDate', {\n\t\t\t\tcalendarObjectInstance,\n\t\t\t\tendDate: new Date(endDate.getTime() - 24 * 60 * 60 * 1000),\n\t\t\t})\n\t\t} else {\n\t\t\tcommit('changeEndDate', {\n\t\t\t\tcalendarObjectInstance,\n\t\t\t\tendDate,\n\t\t\t})\n\t\t}\n\n\t\tif (!isDirty) {\n\t\t\tcalendarObjectInstance.eventComponent.undirtify()\n\t\t}\n\t},\n}\n\nexport default { state, mutations, getters, actions }\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @copyright Copyright (c) 2019 John Molakvo\n *\n * @copyright Copyright (c) 2019 Thomas Citharel\n *\n * @author Georg Ehrke <oc.list@georgehrke.com>\n *\n * @author John Molakvo <skjnldsv@protonmail.com>\n *\n * @author Thomas Citharel <tcit@tcit.fr>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport Vue from 'vue'\nimport {\n\tcreateCalendar,\n\tcreateSubscription,\n\tfindAll,\n\tfindAllDeletedCalendars,\n\tfindPublicCalendarsByTokens,\n} from '../services/caldavService.js'\nimport { mapCDavObjectToCalendarObject } from '../models/calendarObject.js'\nimport { dateFactory, getUnixTimestampFromDate } from '../utils/date.js'\nimport { getDefaultCalendarObject, mapDavCollectionToCalendar } from '../models/calendar.js'\nimport pLimit from 'p-limit'\nimport { uidToHexColor } from '../utils/color.js'\nimport { translate as t } from '@nextcloud/l10n'\nimport getTimezoneManager from '../services/timezoneDataProviderService.js'\nimport { CalendarComponent, Timezone, TimezoneComponent } from '@nextcloud/calendar-js'\nimport {\n\tCALDAV_BIRTHDAY_CALENDAR,\n\tIMPORT_STAGE_IMPORTING,\n\tIMPORT_STAGE_PROCESSING,\n} from '../models/consts.js'\nimport { showError } from '@nextcloud/dialogs'\n\nconst state = {\n\tcalendars: [],\n\ttrashBin: undefined,\n\tscheduleInbox: undefined,\n\tdeletedCalendars: [],\n\tdeletedCalendarObjects: [],\n\tcalendarsById: {},\n\tinitialCalendarsLoaded: false,\n\teditCalendarModal: undefined,\n}\n\nconst mutations = {\n\n\t/**\n\t * Adds calendar into state\n\t *\n\t * @param {object} state the store data\n\t * @param {object} data destructuring object\n\t * @param {object} data.calendar the calendar to add\n\t */\n\taddCalendar(state, { calendar }) {\n\t\tconst object = getDefaultCalendarObject(calendar)\n\n\t\tif (!state.calendars.some(existing => existing.id === object.id)) {\n\t\t\tstate.calendars.push(object)\n\t\t}\n\t\tVue.set(state.calendarsById, object.id, object)\n\t},\n\n\taddTrashBin(state, { trashBin }) {\n\t\tstate.trashBin = trashBin\n\t},\n\n\taddScheduleInbox(state, { scheduleInbox }) {\n\t\tstate.scheduleInbox = scheduleInbox\n\t},\n\n\t/**\n\t * Adds deleted calendar into state\n\t *\n\t * @param {object} state the store data\n\t * @param {object} data destructuring object\n\t * @param {object} data.calendar calendar the calendar to add\n\t */\n\taddDeletedCalendar(state, { calendar }) {\n\t\tif (state.deletedCalendars.some(c => c.url === calendar.url)) {\n\t\t\t// This calendar is already known\n\t\t\treturn\n\t\t}\n\t\tstate.deletedCalendars.push(calendar)\n\t},\n\n\t/**\n\t * Removes a deleted calendar\n\t *\n\t * @param {object} state the store data\n\t * @param {object} data destructuring object\n\t * @param {object} data.calendar the deleted calendar to remove\n\t */\n\tremoveDeletedCalendar(state, { calendar }) {\n\t\tstate.deletedCalendars = state.deletedCalendars.filter(c => c !== calendar)\n\t},\n\n\t/**\n\t * Removes a deleted calendar object\n\t *\n\t * @param {object} state the store data\n\t * @param {object} data destructuring object\n\t * @param {object} data.vobject the deleted calendar object to remove\n\t */\n\tremoveDeletedCalendarObject(state, { vobject }) {\n\t\tstate.deletedCalendarObjects = state.deletedCalendarObjects.filter(vo => vo.id !== vobject.id)\n\t},\n\n\t/**\n\t * Adds a deleted vobject into state\n\t *\n\t * @param {object} state the store data\n\t * @param {object} data destructuring object\n\t * @param {object} data.vobject the calendar vobject to add\n\t */\n\taddDeletedCalendarObject(state, { vobject }) {\n\t\tif (state.deletedCalendarObjects.some(c => c.uri === vobject.uri)) {\n\t\t\t// This vobject is already known\n\t\t\treturn\n\t\t}\n\t\tstate.deletedCalendarObjects.push(vobject)\n\t},\n\n\t/**\n\t * Deletes a calendar\n\t *\n\t * @param {object} state the store data\n\t * @param {object} data destructuring object\n\t * @param {object} data.calendar the calendar to delete\n\t */\n\tdeleteCalendar(state, { calendar }) {\n\t\tstate.calendars.splice(state.calendars.indexOf(calendar), 1)\n\t\tVue.delete(state.calendarsById, calendar.id)\n\t},\n\n\t/**\n\t * Toggles a calendar's visibility\n\t *\n\t * @param {object} state the store mutations\n\t * @param {object} data destructuring object\n\t * @param {object} data.calendar the calendar to toggle\n\t */\n\ttoggleCalendarEnabled(state, { calendar }) {\n\t\tstate.calendarsById[calendar.id].enabled = !state.calendarsById[calendar.id].enabled\n\t},\n\n\t/**\n\t * Renames a calendar\n\t *\n\t * @param {object} state the store mutations\n\t * @param {object} data destructuring object\n\t * @param {object} data.calendar the calendar to rename\n\t * @param {string} data.newName the new name of the calendar\n\t */\n\trenameCalendar(state, { calendar, newName }) {\n\t\tstate.calendarsById[calendar.id].displayName = newName\n\t},\n\n\t/**\n\t * Changes calendar's color\n\t *\n\t * @param {object} state the store mutations\n\t * @param {object} data destructuring object\n\t * @param {object} data.calendar the calendar to rename\n\t * @param {string} data.newColor the new color of the calendar\n\t */\n\tchangeCalendarColor(state, { calendar, newColor }) {\n\t\tstate.calendarsById[calendar.id].color = newColor\n\t},\n\n\t/**\n\t * Changes calendar's order\n\t *\n\t * @param {object} state the store mutations\n\t * @param {object} data destructuring object\n\t * @param {object} data.calendar the calendar to rename\n\t * @param {string} data.newOrder the new order of the calendar\n\t */\n\tchangeCalendarOrder(state, { calendar, newOrder }) {\n\t\tstate.calendarsById[calendar.id].order = newOrder\n\t},\n\n\t/**\n\t * Adds multiple calendar-objects to calendar\n\t *\n\t * @param {object} state the store mutations\n\t * @param {object} data destructuring object\n\t * @param {object} data.calendar The calendar to append objects to\n\t * @param {string[]} data.calendarObjectIds The calendar object ids to append\n\t */\n\tappendCalendarObjectsToCalendar(state, { calendar, calendarObjectIds }) {\n\t\tfor (const calendarObjectId of calendarObjectIds) {\n\t\t\tif (state.calendarsById[calendar.id].calendarObjects.indexOf(calendarObjectId) === -1) {\n\t\t\t\tstate.calendarsById[calendar.id].calendarObjects.push(calendarObjectId)\n\t\t\t}\n\t\t}\n\t},\n\n\t/**\n\t * Adds calendar-object to calendar\n\t *\n\t * @param {object} state the store mutations\n\t * @param {object} data destructuring object\n\t * @param {object} data.calendar The calendar to append objects to\n\t * @param {string} data.calendarObjectId The calendar object id to append\n\t */\n\taddCalendarObjectToCalendar(state, { calendar, calendarObjectId }) {\n\t\tif (state.calendarsById[calendar.id].calendarObjects.indexOf(calendarObjectId) === -1) {\n\t\t\tstate.calendarsById[calendar.id].calendarObjects.push(calendarObjectId)\n\t\t}\n\t},\n\n\t/**\n\t * Removes calendar-object from calendar\n\t *\n\t * @param {object} state the store mutations\n\t * @param {object} data destructuring object\n\t * @param {object} data.calendar The calendar to delete objects from\n\t * @param {string} data.calendarObjectId The calendar object ids to delete\n\t */\n\tdeleteCalendarObjectFromCalendar(state, { calendar, calendarObjectId }) {\n\t\tconst index = state.calendarsById[calendar.id].calendarObjects.indexOf(calendarObjectId)\n\n\t\tif (index !== -1) {\n\t\t\tstate.calendarsById[calendar.id].calendarObjects.slice(index, 1)\n\t\t}\n\t},\n\n\t/**\n\t * Adds fetched time-range to calendar\n\t *\n\t * @param {object} state the store mutations\n\t * @param {object} data destructuring object\n\t * @param {object} data.calendar The calendar to append a time-range to\n\t * @param {number} data.fetchedTimeRangeId The time-range-id to append\n\t */\n\taddFetchedTimeRangeToCalendar(state, { calendar, fetchedTimeRangeId }) {\n\t\tstate.calendarsById[calendar.id].fetchedTimeRanges.push(fetchedTimeRangeId)\n\n\t},\n\n\t/**\n\t * Removes fetched time-range from calendar\n\t *\n\t * @param {object} state the store mutations\n\t * @param {object} data destructuring object\n\t * @param {object} data.calendar The calendar to remove a time-range from\n\t * @param {number} data.fetchedTimeRangeId The time-range-id to remove\n\t */\n\tdeleteFetchedTimeRangeFromCalendar(state, { calendar, fetchedTimeRangeId }) {\n\t\tconst index = state.calendarsById[calendar.id].fetchedTimeRanges.indexOf(fetchedTimeRangeId)\n\n\t\tif (index !== -1) {\n\t\t\tstate.calendarsById[calendar.id].fetchedTimeRanges.slice(index, 1)\n\t\t}\n\t},\n\n\t/**\n\t * Shares calendar with a user or group\n\t *\n\t * @param {object} state the store data\n\t * @param {object} data destructuring object\n\t * @param {object} data.calendar the calendar\n\t * @param {string} data.user the userId\n\t * @param {string} data.displayName the displayName\n\t * @param {string} data.uri the sharing principalScheme uri\n\t * @param {boolean} data.isGroup is this a group?\n\t * @param {boolean} data.isCircle is this a circle?\n\t */\n\tshareCalendar(state, { calendar, user, displayName, uri, isGroup, isCircle }) {\n\t\tconst newSharee = {\n\t\t\tdisplayName,\n\t\t\tid: user,\n\t\t\twriteable: false,\n\t\t\tisGroup,\n\t\t\tisCircle,\n\t\t\turi,\n\t\t}\n\t\tstate.calendarsById[calendar.id].shares.push(newSharee)\n\t},\n\n\t/**\n\t * Removes Sharee from calendar shares list\n\t *\n\t * @param {object} state the store data\n\t * @param {object} data destructuring object\n\t * @param {object} data.calendar the calendar\n\t * @param {string} data.uri the sharee uri\n\t */\n\tunshareCalendar(state, { calendar, uri }) {\n\t\tcalendar = state.calendars.find(search => search.id === calendar.id)\n\t\tconst shareIndex = calendar.shares.findIndex(sharee => sharee.uri === uri)\n\t\tcalendar.shares.splice(shareIndex, 1)\n\t},\n\n\t/**\n\t * Toggles sharee's writable permission\n\t *\n\t * @param {object} state the store data\n\t * @param {object} data destructuring object\n\t * @param {object} data.calendar the calendar\n\t * @param {string} data.uri the sharee uri\n\t */\n\ttoggleCalendarShareWritable(state, { calendar, uri }) {\n\t\tcalendar = state.calendars.find(search => search.id === calendar.id)\n\t\tconst sharee = calendar.shares.find(sharee => sharee.uri === uri)\n\t\tsharee.writeable = !sharee.writeable\n\t},\n\n\t/**\n\t * Publishes a calendar calendar\n\t *\n\t * @param {object} state the store data\n\t * @param {object} data destructuring object\n\t * @param {object} data.calendar the calendar to publish\n\t * @param {string} data.publishURL published URL of calendar\n\t */\n\tpublishCalendar(state, { calendar, publishURL }) {\n\t\tcalendar = state.calendars.find(search => search.id === calendar.id)\n\t\tcalendar.publishURL = publishURL\n\t},\n\n\t/**\n\t * Unpublishes a calendar\n\t *\n\t * @param {object} state the store data\n\t * @param {object} data destructuring object\n\t * @param {object} data.calendar the calendar to unpublish\n\t */\n\tunpublishCalendar(state, { calendar }) {\n\t\tcalendar = state.calendars.find(search => search.id === calendar.id)\n\t\tcalendar.publishURL = null\n\t},\n\n\t/**\n\t * Marks initial loading of calendars as complete\n\t *\n\t * @param {object} state the store data\n\t */\n\tinitialCalendarsLoaded(state) {\n\t\tstate.initialCalendarsLoaded = true\n\t},\n\n\t/**\n\t * Marks a calendar as loading\n\t *\n\t * @param {object} state the store data\n\t * @param {object} data destructuring object\n\t * @param {object} data.calendar the calendar to mark as loading\n\t */\n\tmarkCalendarAsLoading(state, { calendar }) {\n\t\tstate.calendarsById[calendar.id].loading = true\n\t},\n\n\t/**\n\t * Marks a calendar as finished loading\n\t *\n\t * @param {object} state the store data\n\t * @param {object} data destructuring object\n\t * @param {object} data.calendar the calendar to mark as finished loading\n\t */\n\tmarkCalendarAsNotLoading(state, { calendar }) {\n\t\tstate.calendarsById[calendar.id].loading = false\n\t},\n\n\tshowEditCalendarModal(state, { calendarId }) {\n\t\tstate.editCalendarModal = {\n\t\t\tcalendarId,\n\t\t}\n\t},\n\n\thideEditCalendarModal(state) {\n\t\tstate.editCalendarModal = undefined\n\t},\n\n\tsetCalendarDeleteCountdown(state, { calendar, countdown }) {\n\t\tVue.set(state.calendarsById[calendar.id], 'countdown', countdown)\n\t},\n\n\tsetCalendarDeleteHandles(state, { calendar, deleteTimeout, deleteInterval }) {\n\t\tVue.set(state.calendarsById[calendar.id], 'deleteTimeout', deleteTimeout)\n\t\tVue.set(state.calendarsById[calendar.id], 'deleteInterval', deleteInterval)\n\t},\n}\n\nconst getters = {\n\n\t/**\n\t * List of sorted calendars and subscriptions\n\t *\n\t * @param {object} state the store data\n\t * @param {object} store the store\n\t * @param {object} rootState the rootState\n\t * @return {Array}\n\t */\n\tsortedCalendarsSubscriptions(state, store, rootState) {\n\t\treturn state.calendars\n\t\t\t.filter(calendar => calendar.supportsEvents || (rootState.settings.showTasks && calendar.supportsTasks))\n\t\t\t.sort((a, b) => a.order - b.order)\n\t},\n\n\t/**\n\t * List of sorted calendars\n\t *\n\t * @param {object} state the store data\n\t * @return {Array}\n\t */\n\tsortedCalendars(state) {\n\t\treturn state.calendars\n\t\t\t.filter(calendar => calendar.supportsEvents)\n\t\t\t.filter(calendar => !calendar.readOnly)\n\t\t\t.sort((a, b) => a.order - b.order)\n\t},\n\n\t/**\n\t * List of sorted calendars owned by the principal\n\t *\n\t * @param {object} state the store data\n\t * @return {Array}\n\t */\n\townSortedCalendars(state) {\n\t\treturn state.calendars\n\t\t\t.filter(calendar => calendar.supportsEvents)\n\t\t\t.filter(calendar => !calendar.readOnly)\n\t\t\t.filter(calendar => !calendar.isSharedWithMe)\n\t\t\t.sort((a, b) => a.order - b.order)\n\t},\n\n\thasTrashBin(state) {\n\t\treturn state.trashBin !== undefined && state.trashBin.retentionDuration !== 0\n\t},\n\n\ttrashBin(state) {\n\t\treturn state.trashBin\n\t},\n\n\tscheduleInbox: (state) => {\n\t\treturn state.scheduleInbox\n\t},\n\n\t/**\n\t * List of deleted sorted calendars\n\t *\n\t * @param {object} state the store data\n\t * @return {Array}\n\t */\n\tsortedDeletedCalendars(state) {\n\t\treturn state.deletedCalendars\n\t\t\t.sort((a, b) => a.deletedAt - b.deletedAt)\n\t},\n\n\t/**\n\t * List of deleted calendars objects\n\t *\n\t * @param {object} state the store data\n\t * @return {Array}\n\t */\n\tdeletedCalendarObjects(state) {\n\t\tconst calendarUriMap = {}\n\t\tstate.calendars.forEach(calendar => {\n\t\t\tconst withoutTrail = calendar.url.replace(/\\/$/, '')\n\t\t\tconst uri = withoutTrail.slice(withoutTrail.lastIndexOf('/') + 1)\n\t\t\tcalendarUriMap[uri] = calendar\n\t\t})\n\n\t\treturn state.deletedCalendarObjects.map(obj => ({\n\t\t\tcalendar: calendarUriMap[obj.dav._props['{http://nextcloud.com/ns}calendar-uri']],\n\t\t\t...obj,\n\t\t}))\n\t},\n\n\t/**\n\t * List of sorted subscriptions\n\t *\n\t * @param {object} state the store data\n\t * @return {Array}\n\t */\n\tsortedSubscriptions(state) {\n\t\treturn state.calendars\n\t\t\t.filter(calendar => calendar.supportsEvents)\n\t\t\t.filter(calendar => calendar.readOnly)\n\t\t\t.sort((a, b) => a.order - b.order)\n\t},\n\n\t/**\n\t * List of enabled calendars and subscriptions\n\t *\n\t * @param {object} state the store data\n\t * @param {object} store the store\n\t * @param {object} rootState the rootState\n\t * @return {Array}\n\t */\n\tenabledCalendars(state, store, rootState) {\n\t\treturn state.calendars\n\t\t\t.filter(calendar => calendar.supportsEvents || (rootState.settings.showTasks && calendar.supportsTasks))\n\t\t\t.filter(calendar => calendar.enabled)\n\t},\n\n\t/**\n\t * Gets a calendar by it's Id\n\t *\n\t * @param {object} state the store data\n\t * @return {function({String}): {Object}}\n\t */\n\tgetCalendarById: (state) => (calendarId) => state.calendarsById[calendarId],\n\n\t/**\n\t * Gets the contact's birthday calendar or null\n\t *\n\t * @param {object} state the store data\n\t * @return {object | null}\n\t */\n\tgetBirthdayCalendar: (state) => {\n\t\tfor (const calendar of state.calendars) {\n\t\t\tconst url = calendar.url.slice(0, -1)\n\t\t\tconst lastSlash = url.lastIndexOf('/')\n\t\t\tconst uri = url.slice(lastSlash + 1)\n\n\t\t\tif (uri === CALDAV_BIRTHDAY_CALENDAR) {\n\t\t\t\treturn calendar\n\t\t\t}\n\t\t}\n\n\t\treturn null\n\t},\n\n\t/**\n\t * Whether or not a birthday calendar exists\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} getters the vuex getters\n\t * @return {boolean}\n\t */\n\thasBirthdayCalendar: (state, getters) => {\n\t\treturn !!getters.getBirthdayCalendar\n\t},\n\n\t/**\n\t *\n\t * @param {object} state the store data\n\t * @param {object} getters the store getters\n\t * @return {function({Boolean}, {Boolean}, {Boolean}): {Object}[]}\n\t */\n\tsortedCalendarFilteredByComponents: (state, getters) => (vevent, vjournal, vtodo) => {\n\t\treturn getters.sortedCalendars.filter((calendar) => {\n\t\t\tif (vevent && !calendar.supportsEvents) {\n\t\t\t\treturn false\n\t\t\t}\n\n\t\t\tif (vjournal && !calendar.supportsJournals) {\n\t\t\t\treturn false\n\t\t\t}\n\n\t\t\tif (vtodo && !calendar.supportsTasks) {\n\t\t\t\treturn false\n\t\t\t}\n\n\t\t\treturn true\n\t\t})\n\t},\n\n\teditCalendarModal: (state) => state.editCalendarModal,\n}\n\nconst actions = {\n\n\t/**\n\t * Retrieve and commit calendars and other collections\n\t *\n\t * @param {object} context the store object\n\t * @param {object} context.commit the store mutations\n\t * @param {object} context.state the store state\n\t * @param {object} context.getters the store getters\n\t * @return {Promise<object>} the results\n\t */\n\tasync loadCollections({ commit, state, getters }) {\n\t\tconst { calendars, trashBins, scheduleInboxes, subscriptions } = await findAll()\n\t\tconsole.info('calendar home scanned', calendars, trashBins, subscriptions)\n\t\tcalendars.map((calendar) => mapDavCollectionToCalendar(calendar, getters.getCurrentUserPrincipal)).forEach(calendar => {\n\t\t\tcommit('addCalendar', { calendar })\n\t\t})\n\t\tif (trashBins.length) {\n\t\t\tcommit('addTrashBin', { trashBin: trashBins[0] })\n\t\t}\n\t\tif (scheduleInboxes.length) {\n\t\t\tcommit('addScheduleInbox', { scheduleInbox: scheduleInboxes[0] })\n\t\t}\n\n\t\tcommit('initialCalendarsLoaded')\n\t\treturn {\n\t\t\tcalendars: state.calendars,\n\t\t\ttrashBin: state.trashBin,\n\t\t}\n\t},\n\n\t/**\n\t * Retrieve and commit deleted calendars\n\t *\n\t * @param {object} context the store object\n\t * @param {object} context.commit the store mutations\n\t * @return {Promise<Array>} the calendars\n\t */\n\tasync loadDeletedCalendars({ commit }) {\n\t\tconst calendars = await findAllDeletedCalendars()\n\n\t\tcalendars.forEach(calendar => commit('addDeletedCalendar', { calendar }))\n\t},\n\n\t/**\n\t * Retrieve and commit deleted calendar objects\n\t *\n\t * @param {object} context the store object\n\t * @param {object} context.commit the store mutations\n\t * @param {object} context.state the store state\n\t */\n\tasync loadDeletedCalendarObjects({ commit, state }) {\n\t\tconst vobjects = await state.trashBin.findDeletedObjects()\n\t\tconsole.info('vobjects loaded', { vobjects })\n\n\t\tvobjects.forEach(vobject => {\n\t\t\ttry {\n\t\t\t\tconst calendarObject = mapCDavObjectToCalendarObject(vobject, undefined)\n\t\t\t\tcommit('addDeletedCalendarObject', { vobject: calendarObject })\n\t\t\t} catch (error) {\n\t\t\t\tconsole.error('could not convert calendar object', vobject, error)\n\t\t\t}\n\t\t})\n\t},\n\n\t/**\n\t *\n\t * @param {object} context the store object\n\t * @param {object} context.commit the store mutations\n\t * @param {object} data The data destructuring object\n\t * @param {string[]} data.tokens The tokens to load\n\t * @return {Promise<object[]>}\n\t */\n\tasync getPublicCalendars({ commit }, { tokens }) {\n\t\tconst calendars = await findPublicCalendarsByTokens(tokens)\n\t\tconst calendarObjects = []\n\t\tfor (const davCalendar of calendars) {\n\t\t\tconst calendar = mapDavCollectionToCalendar(davCalendar)\n\t\t\tcommit('addCalendar', { calendar })\n\t\t\tcalendarObjects.push(calendar)\n\t\t}\n\n\t\tcommit('initialCalendarsLoaded')\n\t\treturn calendarObjects\n\t},\n\n\t/**\n\t * Append a new calendar to array of existing calendars\n\t *\n\t * @param {object} context the store mutations\n\t * @param {object} data destructuring object\n\t * @param {object} data.displayName The name of the new calendar\n\t * @param {object} data.color The color of the new calendar\n\t * @param {object} data.order The order of the new calendar\n\t * @param {string[]} data.components The supported components of the calendar\n\t * @param {string=} data.timezone The timezoneId\n\t * @return {Promise}\n\t */\n\tasync appendCalendar(context, { displayName, color, order, components = ['VEVENT'], timezone = null }) {\n\t\tif (timezone === null) {\n\t\t\ttimezone = context.getters.getResolvedTimezone\n\t\t}\n\n\t\tlet timezoneIcs = null\n\t\tconst timezoneObject = getTimezoneManager().getTimezoneForId(timezone)\n\t\tif (timezoneObject !== Timezone.utc && timezoneObject !== Timezone.floating) {\n\t\t\tconst calendar = CalendarComponent.fromEmpty()\n\t\t\tcalendar.addComponent(TimezoneComponent.fromICALJs(timezoneObject.toICALJs()))\n\t\t\ttimezoneIcs = calendar.toICS(false)\n\t\t}\n\n\t\tconst response = await createCalendar(displayName, color, components, order, timezoneIcs)\n\t\tconst calendar = mapDavCollectionToCalendar(response, context.getters.getCurrentUserPrincipal)\n\t\tcontext.commit('addCalendar', { calendar })\n\t},\n\n\t/**\n\t * Append a new subscription to array of existing calendars\n\t *\n\t * @param {object} context the store mutations\n\t * @param {object} data destructuring object\n\t * @param {string} data.displayName Name of new subscription\n\t * @param {string} data.color Color of new subscription\n\t * @param {string} data.order Order of new subscription\n\t * @param {string} data.source Source of new subscription\n\t * @return {Promise}\n\t */\n\tasync appendSubscription(context, { displayName, color, order, source }) {\n\t\tconst response = await createSubscription(displayName, color, source, order)\n\t\tconst calendar = mapDavCollectionToCalendar(response, context.getters.getCurrentUserPrincipal)\n\t\tcontext.commit('addCalendar', { calendar })\n\t},\n\n\t/**\n\t * Delete a calendar\n\t *\n\t * @param {object} context the store mutations Current context\n\t * @param {object} data destructuring object\n\t * @param {object} data.calendar the calendar to delete\n\t * @return {Promise}\n\t */\n\tasync deleteCalendar(context, { calendar }) {\n\t\tawait calendar.dav.delete()\n\t\tcontext.commit('deleteCalendar', { calendar })\n\t},\n\n\t/**\n\t * Delete a calendar in the trash bin\n\t *\n\t * @param {object} context the store mutations Current context\n\t * @param {object} data destructuring object\n\t * @param {object} data.calendar the calendar to delete\n\t * @return {Promise}\n\t */\n\tasync deleteCalendarPermanently(context, { calendar }) {\n\t\tawait calendar.delete({\n\t\t\t'X-NC-CalDAV-No-Trashbin': 1,\n\t\t})\n\n\t\tcontext.commit('removeDeletedCalendar', { calendar })\n\t},\n\n\tdeleteCalendarAfterTimeout(context, { calendar, countdown = 7 }) {\n\t\tcontext.commit('setCalendarDeleteCountdown', { calendar, countdown })\n\t\tconst deleteInterval = setInterval(() => {\n\t\t\tcountdown--\n\n\t\t\tif (countdown < 0) {\n\t\t\t\tcountdown = 0\n\t\t\t}\n\n\t\t\tcontext.commit('setCalendarDeleteCountdown', { calendar, countdown })\n\t\t}, 1000)\n\t\tconst deleteTimeout = setTimeout(async () => {\n\t\t\ttry {\n\t\t\t\tawait context.dispatch('deleteCalendar', { calendar })\n\t\t\t} catch (error) {\n\t\t\t\tshowError(t('calendar', 'An error occurred, unable to delete the calendar.'))\n\t\t\t\tconsole.error(error)\n\t\t\t} finally {\n\t\t\t\tclearInterval(deleteInterval)\n\t\t\t}\n\t\t}, 7000)\n\t\tcontext.commit('setCalendarDeleteHandles', {\n\t\t\tcalendar,\n\t\t\tdeleteInterval,\n\t\t\tdeleteTimeout,\n\t\t})\n\t},\n\n\tcancelCalendarDeletion(context, { calendar }) {\n\t\tif (calendar.deleteInterval) clearInterval(calendar.deleteInterval)\n\t\tif (calendar.deleteTimeout) clearTimeout(calendar.deleteTimeout)\n\t\tcontext.commit('setCalendarDeleteHandles', {\n\t\t\tcalendar,\n\t\t\tdeleteInterval: undefined,\n\t\t\tdeleteTimeout: undefined,\n\t\t})\n\t},\n\n\tasync restoreCalendar({ commit, state }, { calendar }) {\n\t\tawait state.trashBin.restore(calendar.url)\n\n\t\tcommit('removeDeletedCalendar', { calendar })\n\t},\n\n\tasync restoreCalendarObject({ commit, state, getters }, { vobject }) {\n\t\tawait state.trashBin.restore(vobject.uri)\n\n\t\t// Clean up the data locally\n\t\tcommit('removeDeletedCalendarObject', { vobject })\n\n\t\t// Delete cached time range that includes the restored event\n\t\tconst calendarObject = mapCDavObjectToCalendarObject(vobject.dav, undefined)\n\t\tconst component = calendarObject.calendarComponent.getFirstComponent(vobject.objectType)\n\t\tconst timeRange = getters.getTimeRangeForCalendarCoveringRange(\n\t\t\tvobject.calendar.id,\n\t\t\tcomponent.startDate?.unixTime,\n\t\t\tcomponent.endDate?.unixTime,\n\t\t)\n\t\tif (timeRange) {\n\t\t\tcommit('deleteFetchedTimeRangeFromCalendar', {\n\t\t\t\tcalendar: vobject.calendar,\n\t\t\t\tfetchedTimeRangeId: timeRange.id,\n\t\t\t})\n\t\t\tcommit('removeTimeRange', {\n\t\t\t\ttimeRangeId: timeRange.id,\n\t\t\t})\n\t\t}\n\n\t\t// Trigger calendar refresh\n\t\tcommit('incrementModificationCount')\n\t},\n\n\t/**\n\t * Deletes a calendar-object permanently\n\t *\n\t * @param {object} context the store mutations\n\t * @param {object} data destructuring object\n\t * @param {vobject} data.vobject Calendar-object to delete\n\t * @return {Promise<void>}\n\t */\n\tasync deleteCalendarObjectPermanently(context, { vobject }) {\n\t\tawait vobject.dav.delete({\n\t\t\t'X-NC-CalDAV-No-Trashbin': 1,\n\t\t})\n\n\t\tcontext.commit('removeDeletedCalendarObject', { vobject })\n\t},\n\n\t/**\n\t * Toggle whether a calendar is enabled\n\t *\n\t * @param {object} context the store mutations Current context\n\t * @param {object} data destructuring object\n\t * @param {object} data.calendar the calendar to modify\n\t * @return {Promise}\n\t */\n\tasync toggleCalendarEnabled(context, { calendar }) {\n\t\tcontext.commit('markCalendarAsLoading', { calendar })\n\t\tcalendar.dav.enabled = !calendar.dav.enabled\n\n\t\ttry {\n\t\t\tawait calendar.dav.update()\n\t\t\tcontext.commit('markCalendarAsNotLoading', { calendar })\n\t\t\tcontext.commit('toggleCalendarEnabled', { calendar })\n\t\t} catch (error) {\n\t\t\tcontext.commit('markCalendarAsNotLoading', { calendar })\n\t\t\tthrow error\n\t\t}\n\t},\n\n\t/**\n\t * Rename a calendar\n\t *\n\t * @param {object} context the store mutations Current context\n\t * @param {object} data destructuring object\n\t * @param {object} data.calendar the calendar to modify\n\t * @param {string} data.newName the new name of the calendar\n\t * @return {Promise}\n\t */\n\tasync renameCalendar(context, { calendar, newName }) {\n\t\tcalendar.dav.displayname = newName\n\n\t\tawait calendar.dav.update()\n\t\tcontext.commit('renameCalendar', { calendar, newName })\n\t},\n\n\t/**\n\t * Change a calendar's color\n\t *\n\t * @param {object} context the store mutations Current context\n\t * @param {object} data destructuring object\n\t * @param {object} data.calendar the calendar to modify\n\t * @param {string} data.newColor the new color of the calendar\n\t * @return {Promise}\n\t */\n\tasync changeCalendarColor(context, { calendar, newColor }) {\n\t\tcalendar.dav.color = newColor\n\n\t\tawait calendar.dav.update()\n\t\tcontext.commit('changeCalendarColor', { calendar, newColor })\n\t},\n\n\t/**\n\t * Share calendar with User or Group\n\t *\n\t * @param {object} context the store mutations Current context\n\t * @param {object} data destructuring object\n\t * @param {object} data.calendar the calendar to share\n\t * @param {string} data.user the userId\n\t * @param {string} data.displayName the displayName\n\t * @param {string} data.uri the sharing principalScheme uri\n\t * @param {boolean} data.isGroup is this a group?\n\t * @param {boolean} data.isCircle is this a circle?\n\t */\n\tasync shareCalendar(context, { calendar, user, displayName, uri, isGroup, isCircle }) {\n\t\t// Share calendar with entered group or user\n\t\tawait calendar.dav.share(uri)\n\t\tcontext.commit('shareCalendar', { calendar, user, displayName, uri, isGroup, isCircle })\n\t},\n\n\t/**\n\t * Toggle permissions of calendar Sharees writeable rights\n\t *\n\t * @param {object} context the store mutations Current context\n\t * @param {object} data destructuring object\n\t * @param {object} data.calendar the calendar to change\n\t * @param {string} data.uri the sharing principalScheme uri\n\t */\n\tasync toggleCalendarShareWritable(context, { calendar, uri }) {\n\t\tconst sharee = calendar.shares.find(sharee => sharee.uri === uri)\n\t\tawait calendar.dav.share(uri, !sharee.writeable)\n\t\tcontext.commit('toggleCalendarShareWritable', { calendar, uri })\n\t},\n\n\t/**\n\t * Remove sharee from calendar\n\t *\n\t * @param {object} context the store mutations Current context\n\t * @param {object} data destructuring object\n\t * @param {object} data.calendar the calendar to change\n\t * @param {string} data.uri the sharing principalScheme uri\n\t */\n\tasync unshareCalendar(context, { calendar, uri }) {\n\t\tawait calendar.dav.unshare(uri)\n\t\tcontext.commit('unshareCalendar', { calendar, uri })\n\t},\n\n\t/**\n\t * Publish a calendar\n\t *\n\t * @param {object} context the store mutations Current context\n\t * @param {object} data destructuring object\n\t * @param {object} data.calendar the calendar to change\n\t * @return {Promise<void>}\n\t */\n\tasync publishCalendar(context, { calendar }) {\n\t\tawait calendar.dav.publish()\n\t\tconst publishURL = calendar.dav.publishURL\n\t\tcontext.commit('publishCalendar', { calendar, publishURL })\n\t},\n\n\t/**\n\t * Unpublish a calendar\n\t *\n\t * @param {object} context the store mutations Current context\n\t * @param {object} data destructuring object\n\t * @param {object} data.calendar the calendar to change\n\t * @return {Promise<void>}\n\t */\n\tasync unpublishCalendar(context, { calendar }) {\n\t\tawait calendar.dav.unpublish()\n\t\tcontext.commit('unpublishCalendar', { calendar })\n\t},\n\n\t/**\n\t * Retrieve the events of the specified calendar\n\t * and commit the results\n\t *\n\t * @param {object} context the store mutations\n\t * @param {object} data destructuring object\n\t * @param {object} data.calendar the calendar to get events from\n\t * @param {Date} data.from the date to start querying events from\n\t * @param {Date} data.to the last date to query events from\n\t * @return {Promise<void>}\n\t */\n\tasync getEventsFromCalendarInTimeRange(context, { calendar, from, to }) {\n\t\tcontext.commit('markCalendarAsLoading', { calendar })\n\t\tconst response = await calendar.dav.findByTypeInTimeRange('VEVENT', from, to)\n\t\tlet responseTodo = []\n\t\tif (context.rootState.settings.showTasks) {\n\t\t\tresponseTodo = await calendar.dav.findByTypeInTimeRange('VTODO', from, to)\n\t\t}\n\t\tcontext.commit('addTimeRange', {\n\t\t\tcalendarId: calendar.id,\n\t\t\tfrom: getUnixTimestampFromDate(from),\n\t\t\tto: getUnixTimestampFromDate(to),\n\t\t\tlastFetched: getUnixTimestampFromDate(dateFactory()),\n\t\t\tcalendarObjectIds: [],\n\t\t})\n\t\tconst insertId = context.getters.getLastTimeRangeInsertId\n\t\tcontext.commit('addFetchedTimeRangeToCalendar', {\n\t\t\tcalendar,\n\t\t\tfetchedTimeRangeId: insertId,\n\t\t})\n\n\t\tconst calendarObjects = []\n\t\tconst calendarObjectIds = []\n\t\tfor (const r of response.concat(responseTodo)) {\n\t\t\ttry {\n\t\t\t\tconst calendarObject = mapCDavObjectToCalendarObject(r, calendar.id)\n\t\t\t\tcalendarObjects.push(calendarObject)\n\t\t\t\tcalendarObjectIds.push(calendarObject.id)\n\t\t\t} catch (e) {\n\t\t\t\tconsole.error(`could not convert calendar object of calendar ${calendar.id}`, e, {\n\t\t\t\t\tresponse: r,\n\t\t\t\t})\n\t\t\t}\n\t\t}\n\n\t\tcontext.commit('appendCalendarObjects', { calendarObjects })\n\t\tcontext.commit('appendCalendarObjectsToCalendar', { calendar, calendarObjectIds })\n\t\tcontext.commit('appendCalendarObjectIdsToTimeFrame', {\n\t\t\ttimeRangeId: insertId,\n\t\t\tcalendarObjectIds,\n\t\t})\n\n\t\tcontext.commit('markCalendarAsNotLoading', { calendar })\n\t\treturn context.rootState.fetchedTimeRanges.lastTimeRangeInsertId\n\t},\n\n\t/**\n\t * Retrieve one object\n\t *\n\t * @param {object} context the store mutations\n\t * @param {object} data destructuring object\n\t * @param {string} data.objectId Id of the object to fetch\n\t * @return {Promise<CalendarObject>}\n\t */\n\tasync getEventByObjectId(context, { objectId }) {\n\t\t// TODO - we should still check if the calendar-object is up to date\n\t\t//  - Just send head and compare etags\n\t\tif (context.getters.getCalendarObjectById(objectId)) {\n\t\t\treturn Promise.resolve(context.getters.getCalendarObjectById(objectId))\n\t\t}\n\n\t\t// This might throw an exception, but we will leave it up to the methods\n\t\t// calling this action to properly handle it\n\t\tconst objectPath = atob(objectId)\n\t\tconst lastSlashIndex = objectPath.lastIndexOf('/')\n\t\tconst calendarPath = objectPath.slice(0, lastSlashIndex + 1)\n\t\tconst objectFileName = objectPath.slice(lastSlashIndex + 1)\n\n\t\tconst calendarId = btoa(calendarPath)\n\t\tif (!context.state.calendarsById[calendarId]) {\n\t\t\treturn Promise.reject(new Error(''))\n\t\t}\n\n\t\tconst calendar = context.state.calendarsById[calendarId]\n\t\tconst vObject = await calendar.dav.find(objectFileName)\n\t\tconst calendarObject = mapCDavObjectToCalendarObject(vObject, calendar.id)\n\t\tcontext.commit('appendCalendarObject', { calendarObject })\n\t\tcontext.commit('addCalendarObjectToCalendar', {\n\t\t\tcalendar: {\n\t\t\t\tid: calendarId,\n\t\t\t},\n\t\t\tcalendarObjectId: calendarObject.id,\n\t\t})\n\n\t\treturn calendarObject\n\t},\n\n\t/**\n\t * Import events into calendar\n\t *\n\t * @param {object} context the store mutations\n\t */\n\tasync importEventsIntoCalendar(context) {\n\t\tcontext.commit('changeStage', IMPORT_STAGE_IMPORTING)\n\n\t\t// Create a copy\n\t\tconst files = context.rootState.importFiles.importFiles.slice()\n\n\t\tlet totalCount = 0\n\t\tfor (const file of files) {\n\t\t\ttotalCount += file.parser.getItemCount()\n\n\t\t\tconst calendarId = context.rootState.importFiles.importCalendarRelation[file.id]\n\t\t\tif (calendarId === 'new') {\n\t\t\t\tconst displayName = file.parser.getName() || t('calendar', 'Imported {filename}', {\n\t\t\t\t\tfilename: file.name,\n\t\t\t\t})\n\t\t\t\tconst color = file.parser.getColor() || uidToHexColor(displayName)\n\t\t\t\tconst components = []\n\t\t\t\tif (file.parser.containsVEvents()) {\n\t\t\t\t\tcomponents.push('VEVENT')\n\t\t\t\t}\n\t\t\t\tif (file.parser.containsVJournals()) {\n\t\t\t\t\tcomponents.push('VJOURNAL')\n\t\t\t\t}\n\t\t\t\tif (file.parser.containsVTodos()) {\n\t\t\t\t\tcomponents.push('VTODO')\n\t\t\t\t}\n\n\t\t\t\tconst response = await createCalendar(displayName, color, components, 0)\n\t\t\t\tconst calendar = mapDavCollectionToCalendar(response, context.getters.getCurrentUserPrincipal)\n\t\t\t\tcontext.commit('addCalendar', { calendar })\n\t\t\t\tcontext.commit('setCalendarForFileId', {\n\t\t\t\t\tfileId: file.id,\n\t\t\t\t\tcalendarId: calendar.id,\n\t\t\t\t})\n\t\t\t}\n\t\t}\n\n\t\tcontext.commit('setTotal', totalCount)\n\n\t\tconst limit = pLimit(3)\n\t\tconst requests = []\n\n\t\tfor (const file of files) {\n\t\t\tconst calendarId = context.rootState.importFiles.importCalendarRelation[file.id]\n\t\t\tconst calendar = context.getters.getCalendarById(calendarId)\n\n\t\t\tfor (const item of file.parser.getItemIterator()) {\n\t\t\t\trequests.push(limit(async () => {\n\t\t\t\t\tconst ics = item.toICS()\n\n\t\t\t\t\tlet davObject\n\t\t\t\t\ttry {\n\t\t\t\t\t\tdavObject = await calendar.dav.createVObject(ics)\n\t\t\t\t\t} catch (error) {\n\t\t\t\t\t\tcontext.commit('incrementDenied')\n\t\t\t\t\t\tconsole.error(error)\n\t\t\t\t\t\treturn\n\t\t\t\t\t}\n\n\t\t\t\t\tconst calendarObject = mapCDavObjectToCalendarObject(davObject, calendarId)\n\t\t\t\t\tcontext.commit('appendCalendarObject', { calendarObject })\n\t\t\t\t\tcontext.commit('addCalendarObjectToCalendar', {\n\t\t\t\t\t\tcalendar,\n\t\t\t\t\t\tcalendarObjectId: calendarObject.id,\n\t\t\t\t\t})\n\t\t\t\t\tcontext.commit('addCalendarObjectIdToAllTimeRangesOfCalendar', {\n\t\t\t\t\t\tcalendarId: calendar.id,\n\t\t\t\t\t\tcalendarObjectId: calendarObject.id,\n\t\t\t\t\t})\n\t\t\t\t\tcontext.commit('incrementAccepted')\n\t\t\t\t}))\n\t\t\t}\n\t\t}\n\n\t\tawait Promise.all(requests)\n\t\tcontext.commit('changeStage', IMPORT_STAGE_PROCESSING)\n\t},\n\t/**\n\t *\n\t * @param {object} context the store object\n\t * @param {object} context.commit the store mutations\n\t * @param {object} context.state the store state\n\t * @param {object} data The data destructuring object\n\t * @param {object} data.newOrder The object containing String => Number with the new order\n\t * @return {Promise<void>}\n\t */\n\tasync updateCalendarListOrder({ state, commit }, { newOrder }) {\n\t\t// keep a record of the original order in case we need to do a rollback\n\n\t\tconst limit = pLimit(3)\n\t\tconst requests = []\n\t\tconst calendarsToUpdate = []\n\n\t\tfor (const key in newOrder) {\n\t\t\trequests.push(limit(async () => {\n\t\t\t\tconst calendar = state.calendarsById[key]\n\n\t\t\t\t// Do not update unless necessary\n\t\t\t\tif (calendar.dav.order === newOrder[key]) {\n\t\t\t\t\treturn\n\t\t\t\t}\n\n\t\t\t\tcalendar.dav.order = newOrder[key]\n\n\t\t\t\tawait calendar.dav.update()\n\n\t\t\t\tcalendarsToUpdate.push({ calendar, newOrder: newOrder[key] })\n\t\t\t}))\n\t\t}\n\n\t\tawait Promise.all(requests)\n\n\t\tfor (const { calendar, newOrder } of calendarsToUpdate) {\n\t\t\tconsole.debug(calendar, newOrder)\n\t\t\tcommit('changeCalendarOrder', { calendar, newOrder })\n\t\t}\n\t},\n}\n\nexport default { state, mutations, getters, actions }\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <oc.list@georgehrke.com>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport Vue from 'vue'\n\nconst state = {\n\tcontacts: [],\n\tcontactByEMail: {},\n}\n\nconst mutations = {\n\n\t/**\n\t * Append a single contact to the store\n\t *\n\t * @param {object} state The store data\n\t * @param {object} data The destructuring object\n\t * @param {object} data.contact The contact to append to the store\n\t */\n\tappendContact(state, { contact }) {\n\t\tif (state.contacts.indexOf(contact) === -1) {\n\t\t\tstate.contacts.push(contact)\n\t\t}\n\n\t\tfor (const email of contact.emails) {\n\t\t\t// In the unlikely case that multiple contacts\n\t\t\t// share the same email address, we will just follow\n\t\t\t// first come, first served.\n\t\t\tif (state.contactByEMail[email] === undefined) {\n\t\t\t\tVue.set(state.contactByEMail, email, contact)\n\t\t\t}\n\t\t}\n\t},\n\n\t/**\n\t * Removes a single contact from the store\n\t *\n\t * @param {object} state The store data\n\t * @param {object} data The destructuring object\n\t * @param {object} data.contact The contact to remove from the store\n\t */\n\tremoveContact(state, { contact }) {\n\t\tfor (const email of contact.emails) {\n\t\t\tif (state.contactByEMail[email] === contact) {\n\t\t\t\tVue.delete(state.contactByEMail, email)\n\t\t\t}\n\t\t}\n\n\t\tconst index = state.contacts.indexOf(contact)\n\t\tif (index !== -1) {\n\t\t\tstate.contacts.splice(index, 1)\n\t\t}\n\t},\n}\n\nconst getters = {}\n\nconst actions = {}\n\nexport default { state, mutations, getters, actions }\n","/**\n * @copyright Copyright (c) 2020 Georg Ehrke\n *\n * @author Georg Ehrke <oc.list@georgehrke.com>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nconst state = {\n\tminimumDate: '1970-01-01T00:00:00Z',\n\tmaximumDate: '2037-12-31T23:59:59Z',\n}\n\nconst mutations = {\n\n\t/**\n\t * Initialize restrictions imposed by CalDAV server\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} data The destructuring object\n\t * @param {string} data.minimumDate The minimum-date allowed by the CalDAV server\n\t * @param {string} data.maximumDate The maximum-date allowed by the CalDAV server\n\t */\n\tloadDavRestrictionsFromServer(state, { minimumDate, maximumDate }) {\n\t\tstate.minimumDate = minimumDate\n\t\tstate.maximumDate = maximumDate\n\t},\n}\n\nconst getters = {}\n\nconst actions = {}\n\nexport default { state, mutations, getters, actions }\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <oc.list@georgehrke.com>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport Vue from 'vue'\n\nconst state = {\n\tlastTimeRangeInsertId: -1,\n\tfetchedTimeRanges: [],\n\tfetchedTimeRangesById: {},\n}\n\nconst mutations = {\n\n\t/**\n\t * Adds a fetched time-range to the state\n\t *\n\t * @param {object} state The vuex state\n\t * @param {object} data The destructuring object\n\t * @param {string} data.calendarId Calendar-id which objects have been fetched\n\t * @param {number} data.from timestamp of start\n\t * @param {number} data.to timestamp of end\n\t * @param {number} data.lastFetched timestamp of last-fetched\n\t * @param {string[]} data.calendarObjectIds array of calendarObjectIds\n\t */\n\taddTimeRange(state, { calendarId, from, to, lastFetched, calendarObjectIds }) {\n\t\tconst fetchedTimeRange = {\n\t\t\tid: ++state.lastTimeRangeInsertId,\n\t\t\tcalendarId,\n\t\t\tfrom,\n\t\t\tto,\n\t\t\tlastFetched,\n\t\t\tcalendarObjectIds,\n\t\t}\n\n\t\tstate.fetchedTimeRanges.push(fetchedTimeRange)\n\t\tVue.set(state.fetchedTimeRangesById, fetchedTimeRange.id, fetchedTimeRange)\n\t},\n\n\t/**\n\t * Removes a fetched time-range from the state\n\t *\n\t * @param {object} state The vuex state\n\t * @param {object} data The destructuring object\n\t * @param {number} data.timeRangeId Id of time-range to remove\n\t */\n\tremoveTimeRange(state, { timeRangeId }) {\n\t\tconst obj = state.fetchedTimeRangesById[timeRangeId]\n\t\tconst index = state.fetchedTimeRanges.indexOf(obj)\n\n\t\tif (index !== -1) {\n\t\t\tstate.fetchedTimeRanges.splice(index, 1)\n\t\t\tVue.delete(state.fetchedTimeRangesById, timeRangeId)\n\t\t}\n\t},\n\n\t/**\n\t * Adds a calendar-object-id to an already fetched time-range\n\t *\n\t * @param {object} state The vuex state\n\t * @param {object} data The destructuring object\n\t * @param {number} data.timeRangeId The id of the time-range\n\t * @param {string[]} data.calendarObjectIds The array of ids of the calendar-object to add\n\t */\n\tappendCalendarObjectIdsToTimeFrame(state, { timeRangeId, calendarObjectIds }) {\n\t\tfor (const calendarObjectId of calendarObjectIds) {\n\t\t\tif (state.fetchedTimeRangesById[timeRangeId].calendarObjectIds.indexOf(calendarObjectId) === -1) {\n\t\t\t\tstate.fetchedTimeRangesById[timeRangeId].calendarObjectIds.push(calendarObjectId)\n\t\t\t}\n\t\t}\n\t},\n\n\t/**\n\t * Adds a calendar-object-id to an already fetched time-range\n\t *\n\t * @param {object} state The vuex state\n\t * @param {object} data The destructuring object\n\t * @param {number} data.timeRangeId The id of the time-range\n\t * @param {string} data.calendarObjectId The id of the calendar-object to add\n\t */\n\tappendCalendarObjectIdToTimeRange(state, { timeRangeId, calendarObjectId }) {\n\t\tstate.fetchedTimeRangesById[timeRangeId].calendarObjectIds.push(calendarObjectId)\n\t},\n\n\t/**\n\t * Removes a calendar-object-id from an already fetched time-range\n\t *\n\t * @param {object} state The vuex state\n\t * @param {object} data The destructuring object\n\t * @param {number} data.timeRangeId The id of the timerange\n\t * @param {string} data.calendarObjectId The id of the calendar-object to remove\n\t */\n\tremoveCalendarObjectIdFromTimeRange(state, { timeRangeId, calendarObjectId }) {\n\t\tconst index = state.fetchedTimeRangesById[timeRangeId]\n\t\t\t.calendarObjectIds\n\t\t\t.indexOf(calendarObjectId)\n\t\tif (index !== -1) {\n\t\t\tstate.fetchedTimeRangesById[timeRangeId]\n\t\t\t\t.calendarObjectIds\n\t\t\t\t.splice(index, 1)\n\t\t}\n\t},\n\n\t/**\n\t * Removes a calendar-object-id from any time-range it may occur in\n\t *\n\t * @param {object} state The vuex state\n\t * @param {object} data The destructuring object\n\t * @param {string} data.calendarObjectId The id of the calendar-object to remove\n\t */\n\tremoveCalendarObjectIdFromAnyTimeRange(state, { calendarObjectId }) {\n\t\tfor (const timeRange of state.fetchedTimeRanges) {\n\t\t\tconst index = timeRange\n\t\t\t\t.calendarObjectIds\n\t\t\t\t.indexOf(calendarObjectId)\n\t\t\tif (index !== -1) {\n\t\t\t\ttimeRange\n\t\t\t\t\t.calendarObjectIds\n\t\t\t\t\t.splice(index, 1)\n\t\t\t}\n\t\t}\n\t},\n\n\t/**\n\t * Updates the last-fetched timestamp of a time-range\n\t *\n\t * @param {object} state The vuex state\n\t * @param {object} data The destructuring object\n\t * @param {number} data.timeRangeId The id of the timerange\n\t * @param {number} data.lastFetched Timestamp of last-fetched\n\t */\n\tupdateTimestampOfLastFetched(state, { timeRangeId, lastFetched }) {\n\t\tstate.fetchedTimeRangesById[timeRangeId].lastFetched = lastFetched\n\t},\n\n\t/**\n\t * Adds a calendar-object-id to all time-ranges of a given caloendar\n\t *\n\t * @param {object} state The vuex state\n\t * @param {object} data The destructuring object\n\t * @param {string} data.calendarObjectId The id of the calendar-object\n\t * @param {string} data.calendarId The id of the calendar\n\t */\n\taddCalendarObjectIdToAllTimeRangesOfCalendar(state, { calendarObjectId, calendarId }) {\n\t\tfor (const timerange of state.fetchedTimeRanges) {\n\t\t\tif (timerange.calendarId !== calendarId) {\n\t\t\t\tcontinue\n\t\t\t}\n\n\t\t\tif (timerange.calendarObjectIds.indexOf(calendarObjectId) === -1) {\n\t\t\t\ttimerange.calendarObjectIds.push(calendarObjectId)\n\t\t\t}\n\t\t}\n\t},\n\n\t/**\n\t * Removes a calendar-object-id to all time-ranges of a given caloendar\n\t *\n\t * @param {object} state The vuex state\n\t * @param {object} data The destructuring object\n\t * @param {string} data.calendarObjectId The id of the calendar-object\n\t * @param {string} data.calendarId The id of the calendar\n\t */\n\tremoveCalendarObjectIdFromAllTimeRangesOfCalendar(state, { calendarObjectId, calendarId }) {\n\t\tfor (const timerange of state.fetchedTimeRanges) {\n\t\t\tif (timerange.calendarId !== calendarId) {\n\t\t\t\tcontinue\n\t\t\t}\n\n\t\t\tconst index = timerange.calendarObjectIds.indexOf(calendarObjectId)\n\t\t\tif (index !== -1) {\n\t\t\t\ttimerange.calendarObjectIds.splice(index, 1)\n\t\t\t}\n\t\t}\n\t},\n\n\t/**\n\t * clear FetchedTimeRanges Store\n\t *\n\t * @param {object} state The vuex state\n\t */\n\tclearFetchedTimeRanges(state) {\n\t\tstate.lastTimeRangeInsertId = -1\n\t\tstate.fetchedTimeRanges = []\n\t\tstate.fetchedTimeRangesById = {}\n\t},\n}\n\nconst getters = {\n\n\t/**\n\t * Get all time-ranges for a calendar\n\t *\n\t * @param {object} state The vuex state\n\t * @return {function({String}): {Object}[]}\n\t */\n\tgetAllTimeRangesForCalendar: (state) => (calendarId) =>\n\t\tstate.fetchedTimeRanges.filter(f => (f.calendarId === calendarId)),\n\n\t/**\n\t * Get time-range covering\n\t *\n\t * @param {object} state The vuex state\n\t * @return {function({Number}, {Number}, {Number}): {Object}|false}\n\t */\n\tgetTimeRangeForCalendarCoveringRange: (state) => (calendarId, requestedFrom, requestedTo) => {\n\t\treturn state.fetchedTimeRanges.find(f => {\n\t\t\treturn f.calendarId === calendarId && f.from <= requestedFrom && f.to >= requestedTo\n\t\t})\n\t},\n\n\t/**\n\t * Get all time-ranges that have been last fetched before a given time\n\t *\n\t * @param {object} state The vuex state\n\t * @return {function({Number}): {Object}[]}\n\t */\n\tgetAllTimeRangesOlderThan: (state) => (olderThan) =>\n\t\tstate.fetchedTimeRanges.filter(f => (f.lastFetched <= olderThan)),\n\n\t/**\n\t *\n\t * @param {object} state The vuex state\n\t * @return {number}\n\t */\n\tgetLastTimeRangeInsertId: (state) => state.lastTimeRangeInsertId,\n\n\t/**\n\t *\n\t * @param {object} state The vuex state\n\t * @param {object} getters The vuex getters\n\t * @return {function({Number}): {CalendarObject}[]}\n\t */\n\tgetCalendarObjectsByTimeRangeId: (state, getters) => (timeRangeId) => {\n\t\tif (!state.fetchedTimeRangesById[timeRangeId]) {\n\t\t\treturn []\n\t\t}\n\n\t\treturn state.fetchedTimeRangesById[timeRangeId].calendarObjectIds.map((calendarObjectId) => {\n\t\t\treturn getters.getCalendarObjectById(calendarObjectId)\n\t\t})\n\t},\n}\n\nconst actions = {}\n\nexport default { state, mutations, getters, actions }\n","/**\n * @copyright Copyright (c) 2019 Team Popcorn <teampopcornberlin@gmail.com>\n *\n * @copyright Copyright (c) 2020 Georg Ehrke\n *\n * @author Team Popcorn <teampopcornberlin@gmail.com>\n *\n * @author Georg Ehrke <oc.list@georgehrke.com>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport Vue from 'vue'\n\nconst state = {\n\tlastFileInsertId: -1,\n\timportFiles: [],\n\timportFilesById: {},\n\timportCalendarRelation: {},\n}\n\nconst mutations = {\n\n\t/**\n\t * Adds a file to the state\n\t *\n\t * @param {object} state The vuex state\n\t * @param {object} data The destructuring object\n\t * @param {string} data.contents Contents of file\n\t * @param {number} data.lastModified Timestamp of last modification\n\t * @param {string} data.name Name of file\n\t * @param {AbstractParser} data.parser The parser\n\t * @param {number} data.size Size of file\n\t * @param {string} data.type mime-type of file\n\t */\n\taddFile(state, { contents, lastModified, name, parser, size, type }) {\n\t\tconst file = {\n\t\t\tid: ++state.lastFileInsertId,\n\t\t\tcontents,\n\t\t\tlastModified,\n\t\t\tname,\n\t\t\tparser,\n\t\t\tsize,\n\t\t\ttype,\n\t\t}\n\n\t\tstate.importFiles.push(file)\n\t\tVue.set(state.importFilesById, file.id, file)\n\t},\n\n\t/**\n\t * Sets a calendar for the file\n\t *\n\t * @param {object} state The vuex state\n\t * @param {object} data The destructuring object\n\t * @param {number} data.fileId Id of file to select calendar for\n\t * @param {string} data.calendarId Id of calendar to import file into\n\t */\n\tsetCalendarForFileId(state, { fileId, calendarId }) {\n\t\tVue.set(state.importCalendarRelation, fileId, calendarId)\n\t},\n\n\t/**\n\t * Removes all files from state\n\t *\n\t * @param {object} state The vuex state\n\t */\n\tremoveAllFiles(state) {\n\t\tVue.set(state, 'importFiles', [])\n\t\tVue.set(state, 'importFilesById', {})\n\t\tVue.set(state, 'importCalendarRelation', {})\n\t},\n}\n\nconst getters = {}\n\nconst actions = {}\n\nexport default { state, mutations, getters, actions }\n","/**\n * @copyright Copyright (c) 2019 Team Popcorn <teampopcornberlin@gmail.com>\n *\n * @copyright Copyright (c) 2020 Georg Ehrke\n *\n * @author Team Popcorn <teampopcornberlin@gmail.com>\n *\n * @author Georg Ehrke <oc.list@georgehrke.com>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport { IMPORT_STAGE_DEFAULT } from '../models/consts.js'\n\nconst state = {\n\ttotal: 0,\n\taccepted: 0,\n\tdenied: 0,\n\tstage: IMPORT_STAGE_DEFAULT,\n}\n\nconst mutations = {\n\n\t/**\n\t * Increment the number of calendar-objects accepted\n\t *\n\t * @param {object} state the store data\n\t */\n\tincrementAccepted(state) {\n\t\tstate.accepted++\n\t},\n\n\t/**\n\t * Increment the number of calendar-objects denied\n\t *\n\t * @param {object} state the store data\n\t */\n\tincrementDenied(state) {\n\t\tstate.denied++\n\t},\n\n\t/**\n\t * Set the total number of calendar-objects\n\t *\n\t * @param {object} state the store data\n\t * @param {number} total the total number of calendar-objects to import\n\t */\n\tsetTotal(state, total) {\n\t\tstate.total = total\n\t},\n\n\t/**\n\t * Change stage to the indicated one\n\t *\n\t * @param {object} state the store data\n\t * @param {string} stage the name of the stage, see /src/models/consts.js\n\t */\n\tchangeStage(state, stage) {\n\t\tstate.stage = stage\n\t},\n\n\t/**\n\t * Reset to the default state\n\t *\n\t * @param {object} state the store data\n\t */\n\tresetState(state) {\n\t\tstate.total = 0\n\t\tstate.accepted = 0\n\t\tstate.denied = 0\n\t\tstate.stage = IMPORT_STAGE_DEFAULT\n\t},\n}\n\nconst getters = {}\nconst actions = {}\n\nexport default { state, mutations, getters, actions }\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <oc.list@georgehrke.com>\n *\n * @author John Molakvo <skjnldsv@protonmail.com>\n *\n * @author Thomas Citharel <tcit@tcit.fr>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport Vue from 'vue'\nimport Vuex from 'vuex'\n\nimport calendarObjectInstance from './calendarObjectInstance.js'\nimport calendarObjects from './calendarObjects.js'\nimport calendars from './calendars.js'\nimport contacts from './contacts.js'\nimport davRestrictions from './davRestrictions.js'\nimport fetchedTimeRanges from './fetchedTimeRanges.js'\nimport importFiles from './importFiles.js'\nimport importState from './importState.js'\nimport principals from './principals.js'\nimport settings from './settings.js'\nimport appointmentConfigs from './appointmentConfigs.js'\n\nVue.use(Vuex)\n\nexport default new Vuex.Store({\n\tmodules: {\n\t\tappointmentConfigs,\n\t\tcalendarObjectInstance,\n\t\tcalendarObjects,\n\t\tcalendars,\n\t\tcontacts,\n\t\tdavRestrictions,\n\t\tfetchedTimeRanges,\n\t\timportFiles,\n\t\timportState,\n\t\tprincipals,\n\t\tsettings,\n\t},\n\t// // Throw errors when the state is edited outside of mutations\n\t// strict: true\n})\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <oc.list@georgehrke.com>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport Vue from 'vue'\nimport {\n\tfindPrincipalByUrl,\n\tgetCurrentUserPrincipal,\n} from '../services/caldavService.js'\nimport logger from '../utils/logger.js'\nimport {\n\tgetDefaultPrincipalObject,\n\tmapDavToPrincipal,\n} from '../models/principal.js'\n\nconst state = {\n\tprincipals: [],\n\tprincipalsById: {},\n\tcurrentUserPrincipal: null,\n}\n\nconst mutations = {\n\n\t/**\n\t * Adds a principal to the state\n\t *\n\t * @param {object} state The vuex state\n\t * @param {object} data The destructuring object\n\t * @param {object} data.principal The principal to add\n\t */\n\taddPrincipal(state, { principal }) {\n\t\tconst object = getDefaultPrincipalObject(principal)\n\n\t\tif (state.principalsById[object.id]) {\n\t\t\treturn\n\t\t}\n\n\t\tstate.principals.push(object)\n\t\tVue.set(state.principalsById, object.id, object)\n\t},\n\n\t/**\n\t * Adds the current user principal to the state\n\t *\n\t * @param {object} state The vuex state\n\t * @param {object} data destructuring object\n\t * @param {string} data.principalId principalId of the current-user-principal\n\t */\n\tsetCurrentUserPrincipal(state, { principalId }) {\n\t\tstate.currentUserPrincipal = principalId\n\t},\n}\n\nconst getters = {\n\n\t/**\n\t * Gets a principal object by its url\n\t *\n\t * @param {object} state the store data\n\t * @return {function({String}): {Object}}\n\t */\n\tgetPrincipalByUrl: (state) => (url) => state.principals.find((principal) => principal.url === url),\n\n\t/**\n\t * Gets a principal object by its id\n\t *\n\t * @param {object} state the store data\n\t * @return {function({String}): {Object}}\n\t */\n\tgetPrincipalById: (state) => (id) => state.principalsById[id],\n\n\t/**\n\t * Gets the principal object of the current-user-principal\n\t *\n\t * @param {object} state the store data\n\t * @return {{Object}}\n\t */\n\tgetCurrentUserPrincipal: (state) => state.principalsById[state.currentUserPrincipal],\n\n\t/**\n\t * Gets the email-address of the current-user-principal\n\t *\n\t * @param {object} state the store data\n\t * @return {string|undefined}\n\t */\n\tgetCurrentUserPrincipalEmail: (state) => state.principalsById[state.currentUserPrincipal]?.emailAddress,\n}\n\nconst actions = {\n\n\t/**\n\t * Fetches a principal from the DAV server and commits it to the state\n\t *\n\t * @param {object} context The vuex context\n\t * @param {string} url The URL of the principal\n\t * @return {Promise<void>}\n\t */\n\tasync fetchPrincipalByUrl(context, { url }) {\n\t\t// Don't refetch principals we already have\n\t\tif (context.getters.getPrincipalByUrl(url)) {\n\t\t\treturn\n\t\t}\n\n\t\tconst principal = await findPrincipalByUrl(url)\n\t\tif (!principal) {\n\t\t\t// TODO - handle error\n\t\t\treturn\n\t\t}\n\n\t\tcontext.commit('addPrincipal', {\n\t\t\tprincipal: mapDavToPrincipal(principal),\n\t\t})\n\t},\n\n\t/**\n\t * Fetches the current-user-principal\n\t *\n\t * @param {object} context The vuex context\n\t * @return {Promise<void>}\n\t */\n\tasync fetchCurrentUserPrincipal(context) {\n\t\tconst currentUserPrincipal = getCurrentUserPrincipal()\n\t\tif (!currentUserPrincipal) {\n\t\t\t// TODO - handle error\n\t\t\treturn\n\t\t}\n\n\t\tconst principal = mapDavToPrincipal(currentUserPrincipal)\n\t\tcontext.commit('addPrincipal', { principal })\n\t\tcontext.commit('setCurrentUserPrincipal', { principalId: principal.id })\n\t\tlogger.debug(`Current user principal is ${principal.url}`)\n\t},\n}\n\nexport default { state, mutations, getters, actions }\n","/**\n * @copyright Copyright (c) 2020 Georg Ehrke\n * @copyright Copyright (c) 2022 Informatyka Boguslawski sp. z o.o. sp.k., http://www.ib.pl/\n *\n * @author Georg Ehrke <oc.list@georgehrke.com>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport { enableBirthdayCalendar } from '../services/caldavService.js'\nimport { mapDavCollectionToCalendar } from '../models/calendar.js'\nimport { detectTimezone } from '../services/timezoneDetectionService.js'\nimport { setConfig as setCalendarJsConfig } from '@nextcloud/calendar-js'\nimport { setConfig } from '../services/settings.js'\nimport { logInfo } from '../utils/logger.js'\nimport getTimezoneManager from '../services/timezoneDataProviderService.js'\n\nconst state = {\n\t// env\n\tappVersion: null,\n\tfirstRun: null,\n\ttalkEnabled: false,\n\tdisableAppointments: false,\n\t// user-defined calendar settings\n\teventLimit: null,\n\tshowTasks: null,\n\tshowWeekends: null,\n\tshowWeekNumbers: null,\n\tskipPopover: null,\n\tslotDuration: null,\n\tdefaultReminder: null,\n\ttasksEnabled: false,\n\ttimezone: 'automatic',\n\thideEventExport: false,\n\tforceEventAlarmType: false,\n\tcanSubscribeLink: true,\n\tshowResources: true,\n\t// user-defined Nextcloud settings\n\tmomentLocale: 'en',\n\tattachmentsFolder: '/Calendar',\n}\n\nconst mutations = {\n\n\t/**\n\t * Updates the user's setting for event limit\n\t *\n\t * @param {object} state The Vuex state\n\t */\n\ttoggleEventLimitEnabled(state) {\n\t\tstate.eventLimit = !state.eventLimit\n\t},\n\n\t/**\n\t * Updates the user's setting for visibility of event popover\n\t *\n\t * @param {object} state The Vuex state\n\t */\n\ttogglePopoverEnabled(state) {\n\t\tstate.skipPopover = !state.skipPopover\n\t},\n\n\t/**\n\t * Updates the user's setting for visibility of weekends\n\t *\n\t * @param {object} state The Vuex state\n\t */\n\ttoggleTasksEnabled(state) {\n\t\tstate.showTasks = !state.showTasks\n\t},\n\n\t/**\n\t * Updates the user's setting for visibility of weekends\n\t *\n\t * @param {object} state The Vuex state\n\t */\n\ttoggleWeekendsEnabled(state) {\n\t\tstate.showWeekends = !state.showWeekends\n\t},\n\n\t/**\n\t * Updates the user's setting for visibility of week numbers\n\t *\n\t * @param {object} state The Vuex state\n\t */\n\ttoggleWeekNumberEnabled(state) {\n\t\tstate.showWeekNumbers = !state.showWeekNumbers\n\t},\n\n\t/**\n\t * Updates the user's preferred slotDuration\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} data The destructuring object\n\t * @param {string} data.slotDuration The new slot duration\n\t */\n\tsetSlotDuration(state, { slotDuration }) {\n\t\tstate.slotDuration = slotDuration\n\t},\n\n\t/**\n\t * Updates the user's preferred defaultReminder\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} data The destructuring object\n\t * @param {string} data.defaultReminder The new default reminder length\n\t */\n\t setDefaultReminder(state, { defaultReminder }) {\n\t\tstate.defaultReminder = defaultReminder\n\t},\n\n\t/**\n\t * Updates the user's timezone\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} data The destructuring object\n\t * @param {string} data.timezoneId The new timezone\n\t */\n\tsetTimezone(state, { timezoneId }) {\n\t\tstate.timezone = timezoneId\n\t},\n\n\t/**\n\t * Updates the user's attachments folder\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} data The destructuring object\n\t * @param {string} data.attachmentsFolder The new attachments folder\n\t */\n\tsetAttachmentsFolder(state, { attachmentsFolder }) {\n\t\tstate.attachmentsFolder = attachmentsFolder\n\t},\n\n\t/**\n\t * Initialize settings\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} data The destructuring object\n\t * @param {string} data.appVersion The version of the Nextcloud app\n\t * @param {boolean} data.eventLimit Whether or not to limit number of visible events in grid view\n\t * @param {boolean} data.firstRun Whether or not this is the first run\n\t * @param {boolean} data.showWeekNumbers Whether or not to show week numbers\n\t * @param {boolean} data.showTasks Whether or not to display tasks with a due-date\n\t * @param {boolean} data.showWeekends Whether or not to display weekends\n\t * @param {boolean} data.skipPopover Whether or not to skip the simple event popover\n\t * @param {string} data.slotDuration The duration of one slot in the agendaView\n\t * @param {string} data.defaultReminder The default reminder to set on newly created events\n\t * @param {boolean} data.talkEnabled Whether or not the talk app is enabled\n\t * @param {boolean} data.tasksEnabled Whether ot not the tasks app is enabled\n\t * @param {string} data.timezone The timezone to view the calendar in. Either an Olsen timezone or \"automatic\"\n\t * @param {boolean} data.hideEventExport\n\t * @param {string} data.forceEventAlarmType\n\t * @param {boolean} data.disableAppointments Allow to disable the appointments feature\n\t * @param {boolean} data.canSubscribeLink\n\t * @param {string} data.attachmentsFolder Default user's attachments folder\n\t * @param {boolean} data.showResources Show or hide the resources tab\n\t */\n\tloadSettingsFromServer(state, { appVersion, eventLimit, firstRun, showWeekNumbers, showTasks, showWeekends, skipPopover, slotDuration, defaultReminder, talkEnabled, tasksEnabled, timezone, hideEventExport, forceEventAlarmType, disableAppointments, canSubscribeLink, attachmentsFolder, showResources }) {\n\t\tlogInfo(`\nInitial settings:\n\t- AppVersion: ${appVersion}\n\t- EventLimit: ${eventLimit}\n\t- FirstRun: ${firstRun}\n\t- ShowWeekNumbers: ${showWeekNumbers}\n\t- ShowTasks: ${showTasks}\n\t- ShowWeekends: ${showWeekends}\n\t- SkipPopover: ${skipPopover}\n\t- SlotDuration: ${slotDuration}\n\t- DefaultReminder: ${defaultReminder}\n\t- TalkEnabled: ${talkEnabled}\n\t- TasksEnabled: ${tasksEnabled}\n\t- Timezone: ${timezone}\n\t- HideEventExport: ${hideEventExport}\n\t- ForceEventAlarmType: ${forceEventAlarmType}\n\t- disableAppointments: ${disableAppointments}\n\t- CanSubscribeLink: ${canSubscribeLink}\n\t- attachmentsFolder: ${attachmentsFolder}\n\t- ShowResources: ${showResources}\n`)\n\n\t\tstate.appVersion = appVersion\n\t\tstate.eventLimit = eventLimit\n\t\tstate.firstRun = firstRun\n\t\tstate.showWeekNumbers = showWeekNumbers\n\t\tstate.showTasks = showTasks\n\t\tstate.showWeekends = showWeekends\n\t\tstate.skipPopover = skipPopover\n\t\tstate.slotDuration = slotDuration\n\t\tstate.defaultReminder = defaultReminder\n\t\tstate.talkEnabled = talkEnabled\n\t\tstate.tasksEnabled = tasksEnabled\n\t\tstate.timezone = timezone\n\t\tstate.hideEventExport = hideEventExport\n\t\tstate.forceEventAlarmType = forceEventAlarmType\n\t\tstate.disableAppointments = disableAppointments\n\t\tstate.canSubscribeLink = canSubscribeLink\n\t\tstate.attachmentsFolder = attachmentsFolder\n\t\tstate.showResources = showResources\n\t},\n\n\t/**\n\t * Sets the name of the moment.js locale to be used\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} data The destructuring object\n\t * @param {string} data.locale The moment.js locale to be used\n\t */\n\tsetMomentLocale(state, { locale }) {\n\t\tlogInfo(`Updated moment locale: ${locale}`)\n\n\t\tstate.momentLocale = locale\n\t},\n}\n\nconst getters = {\n\n\tisTalkEnabled: (state) => state.talkEnabled,\n\n\t/**\n\t * Gets the resolved timezone.\n\t * If the timezone is set to automatic, it returns the user's current timezone\n\t * Otherwise, it returns the Olsen timezone stored\n\t *\n\t * @param {object} state The Vuex state\n\t * @return {string}\n\t */\n\tgetResolvedTimezone: (state) => state.timezone === 'automatic'\n\t\t? detectTimezone()\n\t\t: state.timezone,\n\n\t/**\n\t * Gets the resolved timezone object.\n\t * Falls back to UTC if timezone is invalid.\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} getters The vuex getters\n\t * @return {object} The calendar-js timezone object\n\t */\n\tgetResolvedTimezoneObject: (state, getters) => {\n\t\tconst timezone = getters.getResolvedTimezone\n\t\tlet timezoneObject = getTimezoneManager().getTimezoneForId(timezone)\n\t\tif (!timezoneObject) {\n\t\t\ttimezoneObject = getTimezoneManager().getTimezoneForId('UTC')\n\t\t}\n\t\treturn timezoneObject\n\t},\n}\n\nconst actions = {\n\n\t/**\n\t * Updates the user's setting for visibility of birthday calendar\n\t *\n\t * @param {object} vuex The Vuex destructuring object\n\t * @param {object} vuex.getters The Vuex Getters\n\t * @param {Function} vuex.commit The Vuex commit Function\n\t * @param {Function} vuex.dispatch The Vuex dispatch Function\n\t * @return {Promise<void>}\n\t */\n\tasync toggleBirthdayCalendarEnabled({ getters, commit, dispatch }) {\n\t\tif (getters.hasBirthdayCalendar) {\n\t\t\tconst calendar = getters.getBirthdayCalendar\n\t\t\tawait dispatch('deleteCalendar', { calendar })\n\t\t} else {\n\t\t\tconst davCalendar = await enableBirthdayCalendar()\n\t\t\tconst calendar = mapDavCollectionToCalendar(davCalendar)\n\t\t\tcommit('addCalendar', { calendar })\n\t\t}\n\t},\n\n\t/**\n\t * Updates the user's setting for event limit\n\t *\n\t * @param {object} vuex The Vuex destructuring object\n\t * @param {object} vuex.state The Vuex state\n\t * @param {Function} vuex.commit The Vuex commit Function\n\t * @return {Promise<void>}\n\t */\n\tasync toggleEventLimitEnabled({ state, commit }) {\n\t\tconst newState = !state.eventLimit\n\t\tconst value = newState ? 'yes' : 'no'\n\n\t\tawait setConfig('eventLimit', value)\n\t\tcommit('toggleEventLimitEnabled')\n\t},\n\n\t/**\n\t * Updates the user's setting for visibility of event popover\n\t *\n\t * @param {object} context The Vuex context\n\t * @param {object} context.state The store state\n\t * @param {object} context.commit The store mutations\n\t * @return {Promise<void>}\n\t */\n\tasync togglePopoverEnabled({ state, commit }) {\n\t\tconst newState = !state.skipPopover\n\t\tconst value = newState ? 'yes' : 'no'\n\n\t\tawait setConfig('skipPopover', value)\n\t\tcommit('togglePopoverEnabled')\n\t},\n\n\t/**\n\t * Updates the user's setting for visibility of weekends\n\t *\n\t * @param {object} context The Vuex context\n\t * @param {object} context.state The store state\n\t * @param {object} context.commit The store mutations\n\t * @return {Promise<void>}\n\t */\n\tasync toggleWeekendsEnabled({ state, commit }) {\n\t\tconst newState = !state.showWeekends\n\t\tconst value = newState ? 'yes' : 'no'\n\n\t\tawait setConfig('showWeekends', value)\n\t\tcommit('toggleWeekendsEnabled')\n\t},\n\n\t/**\n\t * Updates the user's setting for visibility of tasks\n\t *\n\t * @param {object} vuex The Vuex destructuring object\n\t * @param {object} vuex.state The Vuex state\n\t * @param {Function} vuex.commit The Vuex commit Function\n\t * @return {Promise<void>}\n\t */\n\tasync toggleTasksEnabled({ state, commit }) {\n\t\tconst newState = !state.showTasks\n\t\tconst value = newState ? 'yes' : 'no'\n\n\t\tawait setConfig('showTasks', value)\n\t\tcommit('toggleTasksEnabled')\n\t\tcommit('clearFetchedTimeRanges')\n\t\tcommit('incrementModificationCount')\n\t},\n\n\t/**\n\t * Updates the user's setting for visibility of week numbers\n\t *\n\t * @param {object} vuex The Vuex destructuring object\n\t * @param {object} vuex.state The Vuex state\n\t * @param {Function} vuex.commit The Vuex commit Function\n\t * @return {Promise<void>}\n\t */\n\tasync toggleWeekNumberEnabled({ state, commit }) {\n\t\tconst newState = !state.showWeekNumbers\n\t\tconst value = newState ? 'yes' : 'no'\n\n\t\tawait setConfig('showWeekNr', value)\n\t\tcommit('toggleWeekNumberEnabled')\n\t},\n\n\t/**\n\t * Updates the view to be used as initial view when opening\n\t * the calendar app again\n\t *\n\t * @param {object} context The Vuex destructuring object\n\t * @param {object} data The destructuring object\n\t * @param {string} data.initialView New view to be used as initial view\n\t * @return {Promise<void>}\n\t */\n\tasync setInitialView(context, { initialView }) {\n\t\tawait setConfig('view', initialView)\n\t},\n\n\t/**\n\t * Updates the user's preferred slotDuration\n\t *\n\t * @param {object} vuex The Vuex destructuring object\n\t * @param {object} vuex.state The Vuex state\n\t * @param {Function} vuex.commit The Vuex commit Function\n\t * @param {object} data The destructuring object\n\t * @param {string} data.slotDuration The new slot duration\n\t */\n\tasync setSlotDuration({ state, commit }, { slotDuration }) {\n\t\tif (state.slotDuration === slotDuration) {\n\t\t\treturn\n\t\t}\n\n\t\tawait setConfig('slotDuration', slotDuration)\n\t\tcommit('setSlotDuration', { slotDuration })\n\t},\n\n\t/**\n\t * Updates the user's preferred defaultReminder\n\t *\n\t * @param {object} vuex The Vuex destructuring object\n\t * @param {object} vuex.state The Vuex state\n\t * @param {Function} vuex.commit The Vuex commit Function\n\t * @param {object} data The destructuring object\n\t * @param {string} data.defaultReminder The new default reminder\n\t */\n\tasync setDefaultReminder({ state, commit }, { defaultReminder }) {\n\t\tif (state.defaultReminder === defaultReminder) {\n\t\t\treturn\n\t\t}\n\n\t\tawait setConfig('defaultReminder', defaultReminder)\n\t\tcommit('setDefaultReminder', { defaultReminder })\n\t},\n\n\t/**\n\t * Updates the user's timezone\n\t *\n\t * @param {object} vuex The Vuex destructuring object\n\t * @param {object} vuex.state The Vuex state\n\t * @param {Function} vuex.commit The Vuex commit Function\n\t * @param {object} data The destructuring object\n\t * @param {string} data.timezoneId The new timezone\n\t * @return {Promise<void>}\n\t */\n\tasync setTimezone({ state, commit }, { timezoneId }) {\n\t\tif (state.timezone === timezoneId) {\n\t\t\treturn\n\t\t}\n\n\t\tawait setConfig('timezone', timezoneId)\n\t\tcommit('setTimezone', { timezoneId })\n\t},\n\n\t/**\n\t * Updates the user's attachments folder\n\t *\n\t * @param {object} vuex The Vuex destructuring object\n\t * @param {object} vuex.state The Vuex state\n\t * @param {Function} vuex.commit The Vuex commit Function\n\t * @param {object} data The destructuring object\n\t * @param {string} data.attachmentsFolder The new attachments folder\n\t * @return {Promise<void>}\n\t */\n\tasync setAttachmentsFolder({ state, commit }, { attachmentsFolder }) {\n\t\tif (state.attachmentsFolder === attachmentsFolder) {\n\t\t\treturn\n\t\t}\n\n\t\tawait setConfig('attachmentsFolder', attachmentsFolder)\n\t\tcommit('setAttachmentsFolder', { attachmentsFolder })\n\t},\n\n\t/**\n\t * Initializes the calendar-js configuration\n\t *\n\t * @param {object} vuex The Vuex destructuring object\n\t * @param {object} vuex.state The Vuex state\n\t */\n\tinitializeCalendarJsConfig({ state }) {\n\t\tsetCalendarJsConfig('PRODID', `-//IDN nextcloud.com//Calendar app ${state.appVersion}//EN`)\n\t\tsetCalendarJsConfig('property-list-significant-change', [\n\t\t\t'SUMMARY',\n\t\t\t'LOCATION',\n\t\t\t'DESCRIPTION',\n\t\t])\n\t},\n}\n\nexport default { state, mutations, getters, actions }\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <oc.list@georgehrke.com>\n * @author Richard Steinmetz <richard@steinmetz.cloud>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\nimport { AttendeeProperty, Property } from '@nextcloud/calendar-js'\nimport { translate as t } from '@nextcloud/l10n'\n\n/**\n * Get the factor for a given unit\n *\n * @param {string} unit The name of the unit to get the factor of\n * @return {number}\n */\nexport function getFactorForAlarmUnit(unit) {\n\tswitch (unit) {\n\tcase 'seconds':\n\t\treturn 1\n\n\tcase 'minutes':\n\t\treturn 60\n\n\tcase 'hours':\n\t\treturn 60 * 60\n\n\tcase 'days':\n\t\treturn 24 * 60 * 60\n\n\tcase 'weeks':\n\t\treturn 7 * 24 * 60 * 60\n\n\tdefault:\n\t\treturn 1\n\t}\n}\n\n/**\n * Gets the amount of days / weeks, unit from total seconds\n *\n * @param {number} totalSeconds Total amount of seconds\n * @return {{amount: number, unit: string}}\n */\nexport function getAmountAndUnitForTimedEvents(totalSeconds) {\n\t// Before or after the event is handled somewhere else,\n\t// so make sure totalSeconds is positive\n\ttotalSeconds = Math.abs(totalSeconds)\n\n\t// Handle the special case of 0, so we don't show 0 weeks\n\tif (totalSeconds === 0) {\n\t\treturn {\n\t\t\tamount: 0,\n\t\t\tunit: 'minutes',\n\t\t}\n\t}\n\n\tif (totalSeconds % (7 * 24 * 60 * 60) === 0) {\n\t\treturn {\n\t\t\tamount: totalSeconds / (7 * 24 * 60 * 60),\n\t\t\tunit: 'weeks',\n\t\t}\n\t}\n\tif (totalSeconds % (24 * 60 * 60) === 0) {\n\t\treturn {\n\t\t\tamount: totalSeconds / (24 * 60 * 60),\n\t\t\tunit: 'days',\n\t\t}\n\t}\n\tif (totalSeconds % (60 * 60) === 0) {\n\t\treturn {\n\t\t\tamount: totalSeconds / (60 * 60),\n\t\t\tunit: 'hours',\n\t\t}\n\t}\n\tif (totalSeconds % (60) === 0) {\n\t\treturn {\n\t\t\tamount: totalSeconds / (60),\n\t\t\tunit: 'minutes',\n\t\t}\n\t}\n\n\treturn {\n\t\tamount: totalSeconds,\n\t\tunit: 'seconds',\n\t}\n}\n\n/**\n * Get the total amount of seconds based on amount and unit for timed events\n *\n * @param {number} amount Amount of unit\n * @param {string} unit Minutes/Hours/Days/Weeks\n * @param {boolean=} isBefore Whether the reminder is before or after the event\n * @return {number}\n */\nexport function getTotalSecondsFromAmountAndUnitForTimedEvents(amount, unit, isBefore = true) {\n\treturn amount * getFactorForAlarmUnit(unit) * (isBefore ? -1 : 1)\n}\n\n/**\n * Gets the amount of days / weeks, unit, hours and minutes from total seconds\n *\n * @param {number} totalSeconds Total amount of seconds\n * @return {{amount: *, unit: *, hours: *, minutes: *}}\n */\nexport function getAmountHoursMinutesAndUnitForAllDayEvents(totalSeconds) {\n\tconst dayFactor = getFactorForAlarmUnit('days')\n\tconst hourFactor = getFactorForAlarmUnit('hours')\n\tconst minuteFactor = getFactorForAlarmUnit('minutes')\n\tconst isNegative = totalSeconds < 0\n\ttotalSeconds = Math.abs(totalSeconds)\n\n\tlet dayPart = Math.floor(totalSeconds / dayFactor)\n\tconst hourPart = totalSeconds % dayFactor\n\n\tif (hourPart !== 0) {\n\t\tif (isNegative) {\n\t\t\tdayPart++\n\t\t}\n\t}\n\n\tlet amount = 0\n\tlet unit = null\n\tif (dayPart === 0) {\n\t\tunit = 'days'\n\t} else if (dayPart % 7 === 0) {\n\t\tamount = dayPart / 7\n\t\tunit = 'weeks'\n\t} else {\n\t\tamount = dayPart\n\t\tunit = 'days'\n\t}\n\n\tlet hours = Math.floor(hourPart / hourFactor)\n\tconst minutePart = hourPart % hourFactor\n\tlet minutes = Math.floor(minutePart / minuteFactor)\n\n\tif (isNegative) {\n\t\thours = 24 - hours\n\n\t\tif (minutes !== 0) {\n\t\t\thours--\n\t\t\tminutes = 60 - minutes\n\t\t}\n\t}\n\n\treturn {\n\t\tamount,\n\t\tunit,\n\t\thours,\n\t\tminutes,\n\t}\n}\n\n/**\n * Get the total amount of seconds for all-day events\n *\n * @param {number} amount amount of unit\n * @param {number} hours Time of reminder\n * @param {number} minutes Time of reminder\n * @param {string} unit days/weeks\n * @return {number}\n */\nexport function getTotalSecondsFromAmountHourMinutesAndUnitForAllDayEvents(amount, hours, minutes, unit) {\n\tif (unit === 'weeks') {\n\t\tamount *= 7\n\t\tunit = 'days'\n\t}\n\n\t// 0 is on the same day of the all-day event => positive\n\t// 1 ... n before the event is negative\n\tconst isNegative = amount > 0\n\n\tif (isNegative) {\n\t\t// If it's negative, we need to subtract one day\n\t\tamount--\n\t\t// Convert days to seconds\n\t\tamount *= getFactorForAlarmUnit(unit)\n\n\t\tlet invertedHours = 24 - hours\n\t\tlet invertedMinutes = 0\n\n\t\tif (minutes !== 0) {\n\t\t\tinvertedHours--\n\t\t\tinvertedMinutes = 60 - minutes\n\t\t}\n\n\t\tamount += (invertedHours * getFactorForAlarmUnit('hours'))\n\t\tamount += (invertedMinutes * getFactorForAlarmUnit('minutes'))\n\n\t\tamount *= -1\n\t} else {\n\t\t// Convert days to seconds\n\t\tamount *= getFactorForAlarmUnit('days')\n\n\t\tamount += (hours * getFactorForAlarmUnit('hours'))\n\t\tamount += (minutes * getFactorForAlarmUnit('minutes'))\n\t}\n\n\treturn amount\n}\n\n/**\n * Propagate data from an event component to all EMAIL alarm components.\n * An alarm component must contain a description, summary and all attendees to be notified.\n * We don't have a separate UI for maintaining attendees of an alarm, so we just copy them from the event.\n *\n * https://www.rfc-editor.org/rfc/rfc5545#section-3.6.6\n *\n * @param {AbstractRecurringComponent} eventComponent\n */\nexport function updateEmailAlarms(eventComponent) {\n\tfor (const alarmComponent of eventComponent.getAlarmIterator()) {\n\t\tif (alarmComponent.action !== 'EMAIL') {\n\t\t\tcontinue\n\t\t}\n\n\t\talarmComponent.deleteAllProperties('SUMMARY')\n\t\tconst summaryProperty = eventComponent.getFirstProperty('SUMMARY')\n\t\tif (summaryProperty) {\n\t\t\talarmComponent.addProperty(summaryProperty.clone())\n\t\t} else {\n\t\t\tconst defaultSummary = t('calendar', 'Untitled event')\n\t\t\talarmComponent.addProperty(new Property('SUMMARY', defaultSummary))\n\t\t}\n\n\t\tif (!alarmComponent.hasProperty('DESCRIPTION')) {\n\t\t\tconst defaultDescription = t('calendar', 'This is an event reminder.')\n\t\t\talarmComponent.addProperty(new Property('DESCRIPTION', defaultDescription))\n\t\t}\n\n\t\talarmComponent.deleteAllProperties('ATTENDEE')\n\t\tfor (const attendee of eventComponent.getAttendeeIterator()) {\n\t\t\tif (['RESOURCE', 'ROOM'].includes(attendee.userType)) {\n\t\t\t\tcontinue\n\t\t\t}\n\n\t\t\t// Only copy the email address (value) of the attendee\n\t\t\talarmComponent.addProperty(new AttendeeProperty('ATTENDEE', attendee.value))\n\t\t}\n\t}\n}\n","/**\n * @copyright Copyright (c) 2021 Richard Steinmetz <richard@steinmetz.cloud>\n *\n * @author Richard Steinmetz <richard@steinmetz.cloud>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\n/**\n * Remove the mailto prefix from a URI and return it\n *\n * @param {string} uri URI to remove the prefix from\n * @return {string} URI without a mailto prefix\n */\nexport function removeMailtoPrefix(uri) {\n\tif (typeof uri !== 'string') {\n\t\treturn ''\n\t}\n\n\tif (uri.startsWith('mailto:')) {\n\t\treturn uri.slice(7)\n\t}\n\n\treturn uri\n}\n\n/**\n * Add the mailto prefix to a URI if it doesn't have one yet and return it\n *\n * @param {string} uri URI to add the prefix to\n * @return {string} URI with a mailto prefix\n */\nexport function addMailtoPrefix(uri) {\n\tif (typeof uri !== 'string') {\n\t\treturn 'mailto:'\n\t}\n\n\tif (uri.startsWith('mailto:')) {\n\t\treturn uri\n\t}\n\n\treturn `mailto:${uri}`\n}\n\n/**\n * Get the display name of an organizer\n *\n * @param {?object} organizer Organizer object to extract a display name from\n * @return {string} Display name of given organizer\n */\nexport function organizerDisplayName(organizer) {\n\tif (!organizer) {\n\t\treturn ''\n\t}\n\n\tif (organizer.commonName) {\n\t\treturn organizer.commonName\n\t}\n\n\treturn removeMailtoPrefix(organizer.uri)\n}\n","/**\n * @copyright Copyright (c) 2020 Georg Ehrke\n *\n * @author Georg Ehrke <oc.list@georgehrke.com>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport { DateTimeValue } from '@nextcloud/calendar-js'\n\n/**\n * Get all recurrence-items in given range\n *\n * @param {object} calendarObject Calendar-object model\n * @param {Date} start Begin of time-range\n * @param {Date} end End of time-range\n * @return {Array}\n */\nconst getAllObjectsInTimeRange = (calendarObject, start, end) => {\n\tconst iterator = calendarObject.calendarComponent.getVObjectIterator()\n\tconst firstVObject = iterator.next().value\n\tif (!firstVObject) {\n\t\treturn []\n\t}\n\n\tconst s = DateTimeValue.fromJSDate(start, true)\n\tconst e = DateTimeValue.fromJSDate(end, true)\n\treturn firstVObject.recurrenceManager.getAllOccurrencesBetween(s, e)\n}\n\n/**\n * Get recurrence-item at exactly a given recurrence-Id\n *\n * @param {object} calendarObject Calendar-object model\n * @param {Date} recurrenceId RecurrenceId to retrieve\n * @return {AbstractRecurringComponent|null}\n */\nconst getObjectAtRecurrenceId = (calendarObject, recurrenceId) => {\n\tconst iterator = calendarObject.calendarComponent.getVObjectIterator()\n\tconst firstVObject = iterator.next().value\n\tif (!firstVObject) {\n\t\treturn null\n\t}\n\n\tconst d = DateTimeValue.fromJSDate(recurrenceId, true)\n\treturn firstVObject.recurrenceManager.getOccurrenceAtExactly(d)\n}\n\nexport {\n\tgetAllObjectsInTimeRange,\n\tgetObjectAtRecurrenceId,\n}\n","/**\n * @copyright Copyright (c) 2023 Richard Steinmetz <richard@steinmetz.cloud>\n *\n * @author Richard Steinmetz <richard@steinmetz.cloud>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\n// Code was taken from:\n//   - https://github.com/juliuste/closest-css-color\n//   - https://github.com/gausie/colour-proximity\n//   - https://github.com/gausie/colour-proximity/pull/3\n\nimport cssColors from 'css-color-names'\nimport sortBy from 'lodash/sortBy.js'\nimport pick from 'lodash/pick.js'\nimport uniqBy from 'lodash/uniqBy.js'\nimport { get } from 'color-string'\n\nconst uniqColorKeys = uniqBy(Object.keys(cssColors), c => cssColors[c])\nconst filteredColors = pick(cssColors, uniqColorKeys)\n\nconst colors = sortBy(\n\tObject.keys(filteredColors).map(name => ({\n\t\tname,\n\t\thex: filteredColors[name],\n\t})),\n\tc => c.hex,\n)\n\nconst defaults = {\n\tdetailed: false,\n}\n\n/**\n * Find the closest CSS color to a given hex color.\n *\n * Adapted from https://github.com/juliuste/closest-css-color\n *\n * Copyright (c) 2021, Julius Tens\n *\n * Permission to use, copy, modify, and/or distribute this software for any purpose with or without\n * fee is hereby granted, provided that the above copyright notice and this permission notice\n * appear in all copies.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH REGARD TO THIS\n * SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE\n * AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES\n * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT,\n * NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR PERFORMANCE\n * OF THIS SOFTWARE.\n *\n * @param {string} hex Hex color string\n * @param {object} opt Options\n * @param {boolean=} opt.detailed Return color object instead of just the name\n * @return {string|{name: string, hex: string}} Closest color name or object\n */\nexport default function closestColor(hex, opt = {}) {\n\tconst options = { ...defaults, ...opt }\n\tconst sortedColors = sortBy(colors, c => proximity(hex, c.hex))\n\tif (options.detailed) {\n\t\treturn sortedColors[0]\n\t}\n\treturn sortedColors[0].name\n}\n\n/**\n * Calculate the proximity between two colors.\n *\n * Adapted from https://github.com/gausie/colour-proximity\n *\n * Copyright (c) 2013, Samuel Gaus\n *\n * @param {string} s1 Hex color string 1\n * @param {string} s2 Hex color string 2\n * @return {number}\n */\nfunction proximity(s1, s2) {\n\tconst c1 = rgb2lab(get.rgb(s1))\n\tconst c2 = rgb2lab(get.rgb(s2))\n\treturn Math.sqrt(\n\t\tMath.pow(c1[0] - c2[0], 2)\n\t\t+ Math.pow(c1[1] - c2[1], 2)\n\t\t+ Math.pow(c1[2] - c2[2], 2)\n\t)\n}\n\n/**\n * Adapted from https://github.com/gausie/colour-proximity\n *\n * Copyright (c) 2013, Samuel Gaus\n *\n * @param {number[]} input RGB array\n */\nfunction rgb2lab(input) {\n\t// This code is adapted from various functions at http://www.easyrgb.com/index.php?X=MATH\n\n\tconst rgb = [0, 0, 0]\n\tconst xyz = [0, 0, 0]\n\tconst Lab = [0, 0, 0]\n\n\tfor (let i = 0; i < input.length; i++) {\n\t\tlet value = input[i] / 255\n\n\t\tif (value > 0.04045) {\n\t\t\tvalue = Math.pow(((value + 0.055) / 1.055), 2.4)\n\t\t} else {\n\t\t\tvalue = value / 12.92\n\t\t}\n\n\t\trgb[i] = value * 100\n\t}\n\n\txyz[0] = (rgb[0] * 0.4124 + rgb[1] * 0.3576 + rgb[2] * 0.1805) / 95.047 // ref_X =  95.047   Observer= 2, Illuminant= D65\n\txyz[1] = (rgb[0] * 0.2126 + rgb[1] * 0.7152 + rgb[2] * 0.0722) / 100.0 // ref_Y = 100.000\n\txyz[2] = (rgb[0] * 0.0193 + rgb[1] * 0.1192 + rgb[2] * 0.9505) / 108.883 // ref_Z = 108.883\n\n\tfor (let i = 0; i < 3; i++) {\n\t\tlet value = xyz[i]\n\t\tif (value > 0.008856) {\n\t\t\tvalue = Math.pow(value, 1 / 3)\n\t\t} else {\n\t\t\tvalue = (7.787 * value) + (16 / 116)\n\t\t}\n\t\txyz[i] = value\n\t}\n\n\tLab[0] = parseFloat(((116 * xyz[1]) - 16).toFixed(3))\n\tLab[1] = parseFloat((500 * (xyz[0] - xyz[1])).toFixed(3))\n\tLab[2] = parseFloat((200 * (xyz[1] - xyz[2])).toFixed(3))\n\n\treturn Lab\n}\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <oc.list@georgehrke.com>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport convert from 'color-convert'\nimport { uidToColor } from './uidToColor.js'\nimport css3Colors from 'css-color-names'\nimport closestColor from './closestColor.js'\n\n/**\n * Detect if a color is light or dark\n *\n * @param {object} data The destructuring object\n * @param {number} data.red Red part of the RGB\n * @param {number} data.green Green part of the RGB\n * @param {number} data.blue Blue part of the RGB\n * @return {boolean} true if color is light, false if color is dark\n */\nexport function isLight({ red, green, blue }) {\n\tconst brightness = (((red * 299) + (green * 587) + (blue * 114)) / 1000)\n\treturn (brightness > 130)\n}\n\n/**\n * Get a text-color that's readable on a given background color\n *\n * @param {string} hexColor The hex color to get a text color for\n * @return {string} the matching text color\n */\nexport function generateTextColorForHex(hexColor) {\n\treturn generateTextColorForRGB(hexToRGB(hexColor))\n}\n\n/**\n * Get a text-color that's readable on a given background color\n *\n * @param {object} data The destructuring object\n * @param {number} data.red Red part of the RGB\n * @param {number} data.green Green part of the RGB\n * @param {number} data.blue Blue part of the RGB\n * @return {string}\n */\nexport function generateTextColorForRGB({ red, green, blue }) {\n\treturn isLight({ red, green, blue }) ? '#000000' : '#FAFAFA'\n}\n\n/**\n * Convert hex string to RGB\n *\n * @param {string} hexColor The hex color to convert\n * @return {string} the RGB result\n */\nexport function hexToRGB(hexColor) {\n\tif (hexColor == null) {\n\t\treturn { red: 0, green: 0, blue: 0 }\n\t}\n\tconst [red, green, blue] = convert.hex.rgb(hexColor.slice(1))\n\treturn { red, green, blue }\n}\n\n/**\n * Generates a hex color based on RGB string\n *\n * @param {string} uid The string to generate a color from\n * @return {string} The hex color\n */\nexport function uidToHexColor(uid) {\n\tconst color = uidToColor(uid)\n\treturn '#' + convert.rgb.hex(color.r, color.g, color.b)\n}\n\n/**\n * Detects a color from a given string\n *\n * @param {string} color The color to get the real RGB hex string from\n * @return {string|boolean|*} String if color detected, boolean if not\n */\nexport function detectColor(color) {\n\tif (/^(#)((?:[A-Fa-f0-9]{3}){1,2})$/.test(color)) { // #ff00ff and #f0f\n\t\treturn color\n\t} else if (/^((?:[A-Fa-f0-9]{3}){1,2})$/.test(color)) { // ff00ff and f0f\n\t\treturn '#' + color\n\t} else if (/^(#)((?:[A-Fa-f0-9]{8}))$/.test(color)) { // #ff00ffff and #f0ff\n\t\treturn color.slice(0, 7)\n\t} else if (/^((?:[A-Fa-f0-9]{8}))$/.test(color)) { // ff00ffff and f0ff\n\t\treturn '#' + color.slice(0, 6)\n\t}\n\n\treturn false\n\n}\n\n/**\n * Gets the HEX code for a css3 color name\n *\n * @param {string} colorName The name of the css3 color\n * @return {string | null} string of HEX if valid color, null if not\n */\nexport function getHexForColorName(colorName) {\n\treturn css3Colors[colorName] || null\n}\n\n/**\n * Gets the closest css3 color name for a given HEX code\n *\n * @param {string} hex The HEX code to get a css3 color name for\n * @return {string}\n */\nexport function getClosestCSS3ColorNameForHex(hex) {\n\treturn closestColor(hex)\n}\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <oc.list@georgehrke.com>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\nimport logger from './logger.js'\n\n/**\n * returns a new Date object\n *\n * @return {Date}\n */\nexport function dateFactory() {\n\treturn new Date()\n}\n\n/**\n * formats a Date object as YYYYMMDD\n *\n * @param {Date} date Date to format\n * @return {string}\n */\nexport function getYYYYMMDDFromDate(date) {\n\treturn new Date(date.getTime() - (date.getTimezoneOffset() * 60000))\n\t\t.toISOString()\n\t\t.split('T')[0]\n}\n\n/**\n * get unix time from date object\n *\n * @param {Date} date Date to format\n * @return {number}\n */\nexport function getUnixTimestampFromDate(date) {\n\treturn Math.floor(date.getTime() / 1000)\n}\n\n/**\n * Gets a Date-object based on the firstday param used in routes\n *\n * @param {string} firstDayParam The firstday param from the router\n * @return {Date}\n */\nexport function getDateFromFirstdayParam(firstDayParam) {\n\tif (firstDayParam === 'now') {\n\t\treturn dateFactory()\n\t}\n\n\tconst [year, month, date] = firstDayParam.split('-')\n\t\t.map((str) => parseInt(str, 10))\n\n\tif (Number.isNaN(year) || Number.isNaN(month) || Number.isNaN(date)) {\n\t\tlogger.error('First day parameter contains non-numerical components, falling back to today')\n\t\treturn dateFactory()\n\t}\n\n\tconst dateObject = dateFactory()\n\tdateObject.setFullYear(year, month - 1, date)\n\tdateObject.setHours(0, 0, 0, 0)\n\n\treturn dateObject\n}\n\n/**\n * formats firstday param as YYYYMMDD\n *\n * @param {string} firstDayParam The firstday param from the router\n * @return {string}\n */\nexport function getYYYYMMDDFromFirstdayParam(firstDayParam) {\n\tif (firstDayParam === 'now') {\n\t\treturn getYYYYMMDDFromDate(dateFactory())\n\t}\n\n\treturn firstDayParam\n}\n\n/**\n * Gets a date object based on the given DateTimeValue\n * Ignores given timezone-information\n *\n * @param {DateTimeValue} dateTimeValue Value to get date from\n * @return {Date}\n */\nexport function getDateFromDateTimeValue(dateTimeValue) {\n\treturn new Date(\n\t\tdateTimeValue.year,\n\t\tdateTimeValue.month - 1,\n\t\tdateTimeValue.day,\n\t\tdateTimeValue.hour,\n\t\tdateTimeValue.minute,\n\t\t0,\n\t\t0\n\t)\n}\n\n/**\n * modifies a date\n *\n * @param {Date} date Date object to modify\n * @param {object} data The destructuring object\n * @param {number} data.day Number of days to add\n * @param {number} data.week Number of weeks to add\n * @param {number} data.month Number of months to add\n * @param data.year\n * @return {Date}\n */\nexport function modifyDate(date, { day = 0, week = 0, month = 0, year = 0 }) {\n\tdate = new Date(date.getTime())\n\tdate.setDate(date.getDate() + day)\n\tdate.setDate(date.getDate() + week * 7)\n\tdate.setMonth(date.getMonth() + month)\n\tdate.setFullYear(date.getFullYear() + year)\n\n\treturn date\n}\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <oc.list@georgehrke.com>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport { getLoggerBuilder } from '@nextcloud/logger'\n\nconst logger = getLoggerBuilder()\n\t.setApp('calendar')\n\t.detectUser()\n\t.build()\n\n/**\n * Logs a debug message\n *\n * @param {string} message The message to log\n * @param {object=} context Additional context if needed\n */\nconst logDebug = (message, context = {}) => {\n\tlogger.debug(message, context)\n}\n\n/**\n * Logs an error message\n *\n * @param {string} message The message to log\n * @param {object=} context Additional context if needed\n */\nconst logError = (message, context = {}) => {\n\tlogger.error(message, context)\n}\n\n/**\n * Logs a fatal message\n *\n * @param {string} message The message to log\n * @param {object=} context Additional context if needed\n */\nconst logFatal = (message, context = {}) => {\n\tlogger.fatal(message, context)\n}\n\n/**\n * Logs an info message\n *\n * @param {string} message The message to log\n * @param {object=} context Additional context if needed\n */\nconst logInfo = (message, context = {}) => {\n\tlogger.info(message, context)\n}\n\n/**\n * Logs a warn message\n *\n * @param {string} message The message to log\n * @param {object=} context Additional context if needed\n */\nconst logWarn = (message, context = {}) => {\n\tlogger.warn(message, context)\n}\n\nexport default logger\nexport {\n\tlogDebug,\n\tlogError,\n\tlogFatal,\n\tlogInfo,\n\tlogWarn,\n}\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <oc.list@georgehrke.com>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\n/**\n * Gets the ByDay and BySetPosition\n *\n * @param {Date} jsDate The date to get the weekday of\n * @return {object}\n */\nexport function getBySetPositionAndBySetFromDate(jsDate) {\n\tconst byDay = getWeekDayFromDate(jsDate)\n\tlet bySetPosition = 1\n\tlet dayOfMonth = jsDate.getDate()\n\tfor (; dayOfMonth > 7; dayOfMonth -= 7) {\n\t\tbySetPosition++\n\t}\n\n\treturn {\n\t\tbyDay,\n\t\tbySetPosition,\n\t}\n}\n\n/**\n * Gets the string-representation of the weekday of a given date\n *\n * @param {Date} jsDate The date to get the weekday of\n * @return {string}\n */\nexport function getWeekDayFromDate(jsDate) {\n\tswitch (jsDate.getDay()) {\n\tcase 0:\n\t\treturn 'SU'\n\tcase 1:\n\t\treturn 'MO'\n\tcase 2:\n\t\treturn 'TU'\n\tcase 3:\n\t\treturn 'WE'\n\tcase 4:\n\t\treturn 'TH'\n\tcase 5:\n\t\treturn 'FR'\n\tcase 6:\n\t\treturn 'SA'\n\tdefault:\n\t\tthrow TypeError('Invalid date-object given')\n\t}\n}\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <oc.list@georgehrke.com>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport { linkTo } from '@nextcloud/router'\n\n/**\n * Get URL to modify config-key\n *\n * @param {string} key URL of config-key to modify\n * @return {string}\n */\nexport function getLinkToConfig(key) {\n\treturn [\n\t\tlinkTo('calendar', 'index.php'),\n\t\t'v1/config',\n\t\tkey,\n\t].join('/')\n}\n","/**\n * @copyright Copyright (c) 2018 John Molakvo <skjnldsv@protonmail.com>\n *\n * @author John Molakvo <skjnldsv@protonmail.com>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport md5 from 'md5'\n\n/**\n * This is copied from nextcloud-vue for now, until it is exposed upstream.\n */\n\nexport const uidToColor = (uid) => {\n\t// Normalize hash\n\tlet hash = uid.toLowerCase()\n\n\t// Already a md5 hash?\n\tif (hash.match(/^([0-9a-f]{4}-?){8}$/) === null) {\n\t\thash = md5(hash)\n\t}\n\n\thash = hash.replace(/[^0-9a-f]/g, '')\n\n\tconst steps = 6\n\tconst finalPalette = GenColors(steps)\n\n\t/**\n\t * Convert a string to an integer evenly\n\t *\n\t * @param {string} hash The string to convert\n\t * @param {number} maximum The maximum value\n\t * @return {number} The integer calculated\n\t */\n\tfunction hashToInt(hash, maximum) {\n\t\tlet finalInt = 0\n\t\tconst result = []\n\n\t\t// Splitting evenly the string\n\t\tfor (let i = 0; i < hash.length; i++) {\n\t\t\t// chars in md5 goes up to f, hex:16\n\t\t\tresult.push(parseInt(hash.charAt(i), 16) % 16)\n\t\t}\n\n\t\t// Adds up all results\n\t\tfor (const j in result) {\n\t\t\tfinalInt += result[j]\n\t\t}\n\n\t\t// chars in md5 goes up to f, hex:16\n\t\t// make sure we're always using int in our operation\n\t\treturn parseInt(parseInt(finalInt, 10) % maximum, 10)\n\t}\n\treturn finalPalette[hashToInt(hash, steps * 3)]\n}\n\n/**\n * Color object\n *\n * @param {number} r The red value\n * @param {number} g The green value\n * @param {number} b The blue value\n */\nfunction Color(r, g, b) {\n\tthis.r = r\n\tthis.g = g\n\tthis.b = b\n}\n\n/**\n * Calculate the number of steps\n *\n * @param {number} steps The number of steps\n * @param {Array} ends The ends\n * @return {Array} Array containing the number of steps per color\n */\nfunction stepCalc(steps, ends) {\n\tconst step = new Array(3)\n\tstep[0] = (ends[1].r - ends[0].r) / steps\n\tstep[1] = (ends[1].g - ends[0].g) / steps\n\tstep[2] = (ends[1].b - ends[0].b) / steps\n\treturn step\n}\n\n/**\n * Create a color palette from two colors\n *\n * @param {number} steps The number of steps the palette has\n * @param {string} color1 The first color\n * @param {string} color2 The second color\n * @return {Array} The created palette array\n */\nfunction mixPalette(steps, color1, color2) {\n\tconst palette = []\n\tpalette.push(color1)\n\tconst step = stepCalc(steps, [color1, color2])\n\tfor (let i = 1; i < steps; i++) {\n\t\tconst r = parseInt(color1.r + step[0] * i, 10)\n\t\tconst g = parseInt(color1.g + step[1] * i, 10)\n\t\tconst b = parseInt(color1.b + step[2] * i, 10)\n\t\tpalette.push(new Color(r, g, b))\n\t}\n\treturn palette\n}\n\n/**\n * Generate colors from the official nextcloud color\n * You can provide how many colors you want (multiplied by 3)\n * if step = 6\n * 3 colors * 6 will result in 18 generated colors\n *\n * @param {number} [steps=6] Number of steps to go from a color to another\n * @return {object[]}\n */\nfunction GenColors(steps) {\n\tif (!steps) {\n\t\tsteps = 6\n\t}\n\n\tconst red = new Color(182, 70, 157)\n\tconst yellow = new Color(221, 203, 85)\n\tconst blue = new Color(0, 130, 201) // Nextcloud blue\n\n\tconst palette1 = mixPalette(steps, red, yellow)\n\tconst palette2 = mixPalette(steps, yellow, blue)\n\tconst palette3 = mixPalette(steps, blue, red)\n\n\treturn palette1.concat(palette2).concat(palette3)\n}\n\nexport default uidToColor\n","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \"#calendar_panel .calendar-dot{flex-shrink:0;height:1rem;width:1rem;margin-top:.2rem;border-radius:50%}#calendar_panel #calendar-widget-empty-content{text-align:center;margin-top:5vh}#calendar_panel #calendar-widget-empty-content.half-screen{margin-top:0;height:120px;margin-bottom:2vh}#calendar_panel .empty-label{display:flex;justify-content:center;margin-top:5vh}\", \"\",{\"version\":3,\"sources\":[\"webpack://./src/views/Dashboard.vue\"],\"names\":[],\"mappings\":\"AAEC,8BACC,aAAA,CACA,WAAA,CACA,UAAA,CACA,gBAAA,CACA,iBAAA,CAGD,+CACC,iBAAA,CACA,cAAA,CAEA,2DACC,YAAA,CACA,YAAA,CACA,iBAAA,CAKF,6BACC,YAAA,CACA,sBAAA,CACA,cAAA\",\"sourcesContent\":[\"\\n#calendar_panel {\\n\\t.calendar-dot {\\n\\t\\tflex-shrink: 0;\\n\\t\\theight: 1rem;\\n\\t\\twidth: 1rem;\\n\\t\\tmargin-top: 0.2rem;\\n\\t\\tborder-radius: 50%;\\n\\t}\\n\\n\\t#calendar-widget-empty-content {\\n\\t\\ttext-align: center;\\n\\t\\tmargin-top: 5vh;\\n\\n\\t\\t&.half-screen {\\n\\t\\t\\tmargin-top: 0;\\n\\t\\t\\theight: 120px;\\n\\t\\t\\tmargin-bottom: 2vh;\\n\\t\\t}\\n\\n\\t}\\n\\n\\t.empty-label {\\n\\t\\tdisplay: flex;\\n\\t\\tjustify-content: center;\\n\\t\\tmargin-top: 5vh;\\n\\t}\\n}\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","var map = {\n\t\"./af.js\": [\n\t\t42786,\n\t\t\"node_modules_moment_locale_af_js\"\n\t],\n\t\"./ar-dz.js\": [\n\t\t14130,\n\t\t\"node_modules_moment_locale_ar-dz_js\"\n\t],\n\t\"./ar-kw.js\": [\n\t\t96135,\n\t\t\"node_modules_moment_locale_ar-kw_js\"\n\t],\n\t\"./ar-ly.js\": [\n\t\t56440,\n\t\t\"node_modules_moment_locale_ar-ly_js\"\n\t],\n\t\"./ar-ma.js\": [\n\t\t47702,\n\t\t\"node_modules_moment_locale_ar-ma_js\"\n\t],\n\t\"./ar-sa.js\": [\n\t\t16040,\n\t\t\"node_modules_moment_locale_ar-sa_js\"\n\t],\n\t\"./ar-tn.js\": [\n\t\t37100,\n\t\t\"node_modules_moment_locale_ar-tn_js\"\n\t],\n\t\"./ar.js\": [\n\t\t30867,\n\t\t\"node_modules_moment_locale_ar_js\"\n\t],\n\t\"./az.js\": [\n\t\t31083,\n\t\t\"node_modules_moment_locale_az_js\"\n\t],\n\t\"./be.js\": [\n\t\t9808,\n\t\t\"node_modules_moment_locale_be_js\"\n\t],\n\t\"./bg.js\": [\n\t\t68338,\n\t\t\"node_modules_moment_locale_bg_js\"\n\t],\n\t\"./bm.js\": [\n\t\t67438,\n\t\t\"node_modules_moment_locale_bm_js\"\n\t],\n\t\"./bn-bd.js\": [\n\t\t76225,\n\t\t\"node_modules_moment_locale_bn-bd_js\"\n\t],\n\t\"./bn.js\": [\n\t\t8905,\n\t\t\"node_modules_moment_locale_bn_js\"\n\t],\n\t\"./bo.js\": [\n\t\t11560,\n\t\t\"node_modules_moment_locale_bo_js\"\n\t],\n\t\"./br.js\": [\n\t\t1278,\n\t\t\"node_modules_moment_locale_br_js\"\n\t],\n\t\"./bs.js\": [\n\t\t80622,\n\t\t\"node_modules_moment_locale_bs_js\"\n\t],\n\t\"./ca.js\": [\n\t\t2468,\n\t\t\"node_modules_moment_locale_ca_js\"\n\t],\n\t\"./cs.js\": [\n\t\t5822,\n\t\t\"node_modules_moment_locale_cs_js\"\n\t],\n\t\"./cv.js\": [\n\t\t50877,\n\t\t\"node_modules_moment_locale_cv_js\"\n\t],\n\t\"./cy.js\": [\n\t\t47373,\n\t\t\"node_modules_moment_locale_cy_js\"\n\t],\n\t\"./da.js\": [\n\t\t24780,\n\t\t\"node_modules_moment_locale_da_js\"\n\t],\n\t\"./de-at.js\": [\n\t\t60217,\n\t\t\"node_modules_moment_locale_de-at_js\"\n\t],\n\t\"./de-ch.js\": [\n\t\t60894,\n\t\t\"node_modules_moment_locale_de-ch_js\"\n\t],\n\t\"./de.js\": [\n\t\t59740,\n\t\t\"node_modules_moment_locale_de_js\"\n\t],\n\t\"./dv.js\": [\n\t\t5300,\n\t\t\"node_modules_moment_locale_dv_js\"\n\t],\n\t\"./el.js\": [\n\t\t50837,\n\t\t\"node_modules_moment_locale_el_js\"\n\t],\n\t\"./en-au.js\": [\n\t\t78348,\n\t\t\"node_modules_moment_locale_en-au_js\"\n\t],\n\t\"./en-ca.js\": [\n\t\t77925,\n\t\t\"node_modules_moment_locale_en-ca_js\"\n\t],\n\t\"./en-gb.js\": [\n\t\t22243,\n\t\t\"node_modules_moment_locale_en-gb_js\"\n\t],\n\t\"./en-ie.js\": [\n\t\t46436,\n\t\t\"node_modules_moment_locale_en-ie_js\"\n\t],\n\t\"./en-il.js\": [\n\t\t47207,\n\t\t\"node_modules_moment_locale_en-il_js\"\n\t],\n\t\"./en-in.js\": [\n\t\t44175,\n\t\t\"node_modules_moment_locale_en-in_js\"\n\t],\n\t\"./en-nz.js\": [\n\t\t76319,\n\t\t\"node_modules_moment_locale_en-nz_js\"\n\t],\n\t\"./en-sg.js\": [\n\t\t31662,\n\t\t\"node_modules_moment_locale_en-sg_js\"\n\t],\n\t\"./eo.js\": [\n\t\t92915,\n\t\t\"node_modules_moment_locale_eo_js\"\n\t],\n\t\"./es-do.js\": [\n\t\t55251,\n\t\t\"node_modules_moment_locale_es-do_js\"\n\t],\n\t\"./es-mx.js\": [\n\t\t96112,\n\t\t\"node_modules_moment_locale_es-mx_js\"\n\t],\n\t\"./es-us.js\": [\n\t\t71146,\n\t\t\"node_modules_moment_locale_es-us_js\"\n\t],\n\t\"./es.js\": [\n\t\t55655,\n\t\t\"node_modules_moment_locale_es_js\"\n\t],\n\t\"./et.js\": [\n\t\t5603,\n\t\t\"node_modules_moment_locale_et_js\"\n\t],\n\t\"./eu.js\": [\n\t\t77763,\n\t\t\"node_modules_moment_locale_eu_js\"\n\t],\n\t\"./fa.js\": [\n\t\t76959,\n\t\t\"node_modules_moment_locale_fa_js\"\n\t],\n\t\"./fi.js\": [\n\t\t11897,\n\t\t\"node_modules_moment_locale_fi_js\"\n\t],\n\t\"./fil.js\": [\n\t\t42549,\n\t\t\"node_modules_moment_locale_fil_js\"\n\t],\n\t\"./fo.js\": [\n\t\t94694,\n\t\t\"node_modules_moment_locale_fo_js\"\n\t],\n\t\"./fr-ca.js\": [\n\t\t63049,\n\t\t\"node_modules_moment_locale_fr-ca_js\"\n\t],\n\t\"./fr-ch.js\": [\n\t\t52330,\n\t\t\"node_modules_moment_locale_fr-ch_js\"\n\t],\n\t\"./fr.js\": [\n\t\t15596,\n\t\t\"node_modules_moment_locale_fr_js\"\n\t],\n\t\"./fy.js\": [\n\t\t5044,\n\t\t\"node_modules_moment_locale_fy_js\"\n\t],\n\t\"./ga.js\": [\n\t\t29295,\n\t\t\"node_modules_moment_locale_ga_js\"\n\t],\n\t\"./gd.js\": [\n\t\t2101,\n\t\t\"node_modules_moment_locale_gd_js\"\n\t],\n\t\"./gl.js\": [\n\t\t38794,\n\t\t\"node_modules_moment_locale_gl_js\"\n\t],\n\t\"./gom-deva.js\": [\n\t\t27884,\n\t\t\"node_modules_moment_locale_gom-deva_js\"\n\t],\n\t\"./gom-latn.js\": [\n\t\t23168,\n\t\t\"node_modules_moment_locale_gom-latn_js\"\n\t],\n\t\"./gu.js\": [\n\t\t95349,\n\t\t\"node_modules_moment_locale_gu_js\"\n\t],\n\t\"./he.js\": [\n\t\t24206,\n\t\t\"node_modules_moment_locale_he_js\"\n\t],\n\t\"./hi.js\": [\n\t\t2819,\n\t\t\"node_modules_moment_locale_hi_js\"\n\t],\n\t\"./hr.js\": [\n\t\t30316,\n\t\t\"node_modules_moment_locale_hr_js\"\n\t],\n\t\"./hu.js\": [\n\t\t22138,\n\t\t\"node_modules_moment_locale_hu_js\"\n\t],\n\t\"./hy-am.js\": [\n\t\t11423,\n\t\t\"node_modules_moment_locale_hy-am_js\"\n\t],\n\t\"./id.js\": [\n\t\t29218,\n\t\t\"node_modules_moment_locale_id_js\"\n\t],\n\t\"./is.js\": [\n\t\t90135,\n\t\t\"node_modules_moment_locale_is_js\"\n\t],\n\t\"./it-ch.js\": [\n\t\t10150,\n\t\t\"node_modules_moment_locale_it-ch_js\"\n\t],\n\t\"./it.js\": [\n\t\t90626,\n\t\t\"node_modules_moment_locale_it_js\"\n\t],\n\t\"./ja.js\": [\n\t\t39183,\n\t\t\"node_modules_moment_locale_ja_js\"\n\t],\n\t\"./jv.js\": [\n\t\t24286,\n\t\t\"node_modules_moment_locale_jv_js\"\n\t],\n\t\"./ka.js\": [\n\t\t12105,\n\t\t\"node_modules_moment_locale_ka_js\"\n\t],\n\t\"./kk.js\": [\n\t\t47772,\n\t\t\"node_modules_moment_locale_kk_js\"\n\t],\n\t\"./km.js\": [\n\t\t18758,\n\t\t\"node_modules_moment_locale_km_js\"\n\t],\n\t\"./kn.js\": [\n\t\t79282,\n\t\t\"node_modules_moment_locale_kn_js\"\n\t],\n\t\"./ko.js\": [\n\t\t33730,\n\t\t\"node_modules_moment_locale_ko_js\"\n\t],\n\t\"./ku.js\": [\n\t\t1408,\n\t\t\"node_modules_moment_locale_ku_js\"\n\t],\n\t\"./ky.js\": [\n\t\t33291,\n\t\t\"node_modules_moment_locale_ky_js\"\n\t],\n\t\"./lb.js\": [\n\t\t36841,\n\t\t\"node_modules_moment_locale_lb_js\"\n\t],\n\t\"./lo.js\": [\n\t\t55466,\n\t\t\"node_modules_moment_locale_lo_js\"\n\t],\n\t\"./lt.js\": [\n\t\t57010,\n\t\t\"node_modules_moment_locale_lt_js\"\n\t],\n\t\"./lv.js\": [\n\t\t37595,\n\t\t\"node_modules_moment_locale_lv_js\"\n\t],\n\t\"./me.js\": [\n\t\t39861,\n\t\t\"node_modules_moment_locale_me_js\"\n\t],\n\t\"./mi.js\": [\n\t\t35493,\n\t\t\"node_modules_moment_locale_mi_js\"\n\t],\n\t\"./mk.js\": [\n\t\t95966,\n\t\t\"node_modules_moment_locale_mk_js\"\n\t],\n\t\"./ml.js\": [\n\t\t87341,\n\t\t\"node_modules_moment_locale_ml_js\"\n\t],\n\t\"./mn.js\": [\n\t\t5115,\n\t\t\"node_modules_moment_locale_mn_js\"\n\t],\n\t\"./mr.js\": [\n\t\t10370,\n\t\t\"node_modules_moment_locale_mr_js\"\n\t],\n\t\"./ms-my.js\": [\n\t\t41237,\n\t\t\"node_modules_moment_locale_ms-my_js\"\n\t],\n\t\"./ms.js\": [\n\t\t9847,\n\t\t\"node_modules_moment_locale_ms_js\"\n\t],\n\t\"./mt.js\": [\n\t\t72126,\n\t\t\"node_modules_moment_locale_mt_js\"\n\t],\n\t\"./my.js\": [\n\t\t56165,\n\t\t\"node_modules_moment_locale_my_js\"\n\t],\n\t\"./nb.js\": [\n\t\t64924,\n\t\t\"node_modules_moment_locale_nb_js\"\n\t],\n\t\"./ne.js\": [\n\t\t16744,\n\t\t\"node_modules_moment_locale_ne_js\"\n\t],\n\t\"./nl-be.js\": [\n\t\t59814,\n\t\t\"node_modules_moment_locale_nl-be_js\"\n\t],\n\t\"./nl.js\": [\n\t\t93901,\n\t\t\"node_modules_moment_locale_nl_js\"\n\t],\n\t\"./nn.js\": [\n\t\t83877,\n\t\t\"node_modules_moment_locale_nn_js\"\n\t],\n\t\"./oc-lnc.js\": [\n\t\t92135,\n\t\t\"node_modules_moment_locale_oc-lnc_js\"\n\t],\n\t\"./pa-in.js\": [\n\t\t15858,\n\t\t\"node_modules_moment_locale_pa-in_js\"\n\t],\n\t\"./pl.js\": [\n\t\t64495,\n\t\t\"node_modules_moment_locale_pl_js\"\n\t],\n\t\"./pt-br.js\": [\n\t\t57971,\n\t\t\"node_modules_moment_locale_pt-br_js\"\n\t],\n\t\"./pt.js\": [\n\t\t89520,\n\t\t\"node_modules_moment_locale_pt_js\"\n\t],\n\t\"./ro.js\": [\n\t\t96459,\n\t\t\"node_modules_moment_locale_ro_js\"\n\t],\n\t\"./ru.js\": [\n\t\t21793,\n\t\t\"node_modules_moment_locale_ru_js\"\n\t],\n\t\"./sd.js\": [\n\t\t40950,\n\t\t\"node_modules_moment_locale_sd_js\"\n\t],\n\t\"./se.js\": [\n\t\t10490,\n\t\t\"node_modules_moment_locale_se_js\"\n\t],\n\t\"./si.js\": [\n\t\t26994,\n\t\t\"node_modules_moment_locale_si_js\"\n\t],\n\t\"./sk.js\": [\n\t\t64249,\n\t\t\"node_modules_moment_locale_sk_js\"\n\t],\n\t\"./sl.js\": [\n\t\t14985,\n\t\t\"node_modules_moment_locale_sl_js\"\n\t],\n\t\"./sq.js\": [\n\t\t51104,\n\t\t\"node_modules_moment_locale_sq_js\"\n\t],\n\t\"./sr-cyrl.js\": [\n\t\t79915,\n\t\t\"node_modules_moment_locale_sr-cyrl_js\"\n\t],\n\t\"./sr.js\": [\n\t\t49131,\n\t\t\"node_modules_moment_locale_sr_js\"\n\t],\n\t\"./ss.js\": [\n\t\t85893,\n\t\t\"node_modules_moment_locale_ss_js\"\n\t],\n\t\"./sv.js\": [\n\t\t98760,\n\t\t\"node_modules_moment_locale_sv_js\"\n\t],\n\t\"./sw.js\": [\n\t\t91172,\n\t\t\"node_modules_moment_locale_sw_js\"\n\t],\n\t\"./ta.js\": [\n\t\t27333,\n\t\t\"node_modules_moment_locale_ta_js\"\n\t],\n\t\"./te.js\": [\n\t\t23110,\n\t\t\"node_modules_moment_locale_te_js\"\n\t],\n\t\"./tet.js\": [\n\t\t52095,\n\t\t\"node_modules_moment_locale_tet_js\"\n\t],\n\t\"./tg.js\": [\n\t\t27321,\n\t\t\"node_modules_moment_locale_tg_js\"\n\t],\n\t\"./th.js\": [\n\t\t9041,\n\t\t\"node_modules_moment_locale_th_js\"\n\t],\n\t\"./tk.js\": [\n\t\t19005,\n\t\t\"node_modules_moment_locale_tk_js\"\n\t],\n\t\"./tl-ph.js\": [\n\t\t75768,\n\t\t\"node_modules_moment_locale_tl-ph_js\"\n\t],\n\t\"./tlh.js\": [\n\t\t89444,\n\t\t\"node_modules_moment_locale_tlh_js\"\n\t],\n\t\"./tr.js\": [\n\t\t72397,\n\t\t\"node_modules_moment_locale_tr_js\"\n\t],\n\t\"./tzl.js\": [\n\t\t28254,\n\t\t\"node_modules_moment_locale_tzl_js\"\n\t],\n\t\"./tzm-latn.js\": [\n\t\t30699,\n\t\t\"node_modules_moment_locale_tzm-latn_js\"\n\t],\n\t\"./tzm.js\": [\n\t\t51106,\n\t\t\"node_modules_moment_locale_tzm_js\"\n\t],\n\t\"./ug-cn.js\": [\n\t\t9288,\n\t\t\"node_modules_moment_locale_ug-cn_js\"\n\t],\n\t\"./uk.js\": [\n\t\t67691,\n\t\t\"node_modules_moment_locale_uk_js\"\n\t],\n\t\"./ur.js\": [\n\t\t13795,\n\t\t\"node_modules_moment_locale_ur_js\"\n\t],\n\t\"./uz-latn.js\": [\n\t\t60588,\n\t\t\"node_modules_moment_locale_uz-latn_js\"\n\t],\n\t\"./uz.js\": [\n\t\t6791,\n\t\t\"node_modules_moment_locale_uz_js\"\n\t],\n\t\"./vi.js\": [\n\t\t65666,\n\t\t\"node_modules_moment_locale_vi_js\"\n\t],\n\t\"./x-pseudo.js\": [\n\t\t14378,\n\t\t\"node_modules_moment_locale_x-pseudo_js\"\n\t],\n\t\"./yo.js\": [\n\t\t75805,\n\t\t\"node_modules_moment_locale_yo_js\"\n\t],\n\t\"./zh-cn.js\": [\n\t\t83839,\n\t\t\"node_modules_moment_locale_zh-cn_js\"\n\t],\n\t\"./zh-hk.js\": [\n\t\t55726,\n\t\t\"node_modules_moment_locale_zh-hk_js\"\n\t],\n\t\"./zh-mo.js\": [\n\t\t99807,\n\t\t\"node_modules_moment_locale_zh-mo_js\"\n\t],\n\t\"./zh-tw.js\": [\n\t\t74152,\n\t\t\"node_modules_moment_locale_zh-tw_js\"\n\t]\n};\nfunction webpackAsyncContext(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\treturn Promise.resolve().then(() => {\n\t\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\t\te.code = 'MODULE_NOT_FOUND';\n\t\t\tthrow e;\n\t\t});\n\t}\n\n\tvar ids = map[req], id = ids[0];\n\treturn __webpack_require__.e(ids[1]).then(() => {\n\t\treturn __webpack_require__.t(id, 7 | 16);\n\t});\n}\nwebpackAsyncContext.keys = () => (Object.keys(map));\nwebpackAsyncContext.id = 77961;\nmodule.exports = webpackAsyncContext;","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('DashboardWidget',{attrs:{\"id\":\"calendar_panel\",\"items\":_vm.items,\"loading\":_vm.loading},scopedSlots:_vm._u([{key:\"default\",fn:function({ item }){return [(item.isEmptyItem)?_c('EmptyContent',{staticClass:\"half-screen\",attrs:{\"id\":\"calendar-widget-empty-content\",\"title\":_vm.t('calendar', 'No more events today')},scopedSlots:_vm._u([{key:\"icon\",fn:function(){return [_c('IconCheck',{attrs:{\"size\":67}})]},proxy:true}],null,true)}):_c('DashboardWidgetItem',{attrs:{\"main-text\":item.mainText,\"sub-text\":item.subText,\"target-url\":item.targetUrl},scopedSlots:_vm._u([{key:\"avatar\",fn:function(){return [(item.componentName === 'VEVENT')?_c('div',{staticClass:\"calendar-dot\",style:({'background-color': item.calendarColor}),attrs:{\"title\":item.calendarDisplayName}}):_c('IconCheckbox',{attrs:{\"fill-color\":item.calendarColor}})]},proxy:true}],null,true)})]}},{key:\"empty-content\",fn:function(){return [_c('EmptyContent',{attrs:{\"id\":\"calendar-widget-empty-content\",\"title\":_vm.t('calendar', 'No upcoming events')},scopedSlots:_vm._u([{key:\"icon\",fn:function(){return [_c('EmptyCalendar')]},proxy:true}])}),_vm._v(\" \"),_c('div',{staticClass:\"empty-label\"},[_c('NcButton',{attrs:{\"type\":\"secondary\",\"href\":_vm.clickStartNew}},[_vm._v(\"\\n\\t\\t\\t\\t\"+_vm._s(_vm.t('calendar', 'Create a new event'))+\"\\n\\t\\t\\t\")])],1)]},proxy:true}])})\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <oc.list@georgehrke.com>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport { translate as t } from '@nextcloud/l10n'\nimport {\n\thexToRGB,\n\tisLight,\n\tgenerateTextColorForHex,\n\tgetHexForColorName,\n} from '../../utils/color.js'\nimport logger from '../../utils/logger.js'\nimport { getAllObjectsInTimeRange } from '../../utils/calendarObject.js'\n\n/**\n * convert an array of calendar-objects to events\n *\n * @param {CalendarObject[]} calendarObjects Array of calendar-objects to turn into fc events\n * @param {object} calendar The calendar object\n * @param {Date} start Start of time-range\n * @param {Date} end End of time-range\n * @param {Timezone} timezone Desired time-zone\n * @return {object}[]\n */\nexport function eventSourceFunction(calendarObjects, calendar, start, end, timezone) {\n\tconst fcEvents = []\n\tfor (const calendarObject of calendarObjects) {\n\t\tlet allObjectsInTimeRange\n\t\ttry {\n\t\t\tallObjectsInTimeRange = getAllObjectsInTimeRange(calendarObject, start, end)\n\t\t} catch (error) {\n\t\t\tlogger.error(error.message)\n\t\t\tcontinue\n\t\t}\n\n\t\tfor (const object of allObjectsInTimeRange) {\n\t\t\tconst classNames = []\n\n\t\t\tif (object.status === 'CANCELLED') {\n\t\t\t\tclassNames.push('fc-event-nc-cancelled')\n\t\t\t} else if (object.status === 'TENTATIVE') {\n\t\t\t\tclassNames.push('fc-event-nc-tentative')\n\t\t\t}\n\n\t\t\tif (object.hasComponent('VALARM')) {\n\t\t\t\tclassNames.push('fc-event-nc-alarms')\n\t\t\t}\n\n\t\t\t// For now, we only display\n\t\t\tif (object.name === 'VTODO' && object.endDate === null) {\n\t\t\t\tcontinue\n\t\t\t}\n\n\t\t\tlet jsStart, jsEnd\n\t\t\tif (object.name === 'VEVENT') {\n\t\t\t\tjsStart = object.startDate.getInTimezone(timezone).jsDate\n\t\t\t\tjsEnd = object.endDate.getInTimezone(timezone).jsDate\n\t\t\t} else if (object.name === 'VTODO') {\n\t\t\t\t// For tasks, we only want to display when it is due,\n\t\t\t\t// not for how long it has been in progress already\n\t\t\t\tjsStart = object.endDate.getInTimezone(timezone).jsDate\n\t\t\t\tjsEnd = object.endDate.getInTimezone(timezone).jsDate\n\t\t\t} else {\n\t\t\t\t// We do not want to display anything that's neither\n\t\t\t\t// an event nor a task\n\t\t\t\tcontinue\n\t\t\t}\n\n\t\t\t// Technically, an event's end is not allowed to be equal to it's start,\n\t\t\t// because the event's end is exclusive. Most calendar applications\n\t\t\t// (including all big ones) allow creating such events anyway (we do too).\n\t\t\t// If the event's start is equal to it's end, fullcalendar is giving\n\t\t\t// the event a default length of one hour. We are preventing that by\n\t\t\t// adding one second to the end in that case.\n\t\t\tif (jsStart.getTime() === jsEnd.getTime()) {\n\t\t\t\tjsEnd.setSeconds(jsEnd.getSeconds() + 1)\n\t\t\t}\n\n\t\t\tif (object.name === 'VTODO') {\n\t\t\t\tclassNames.push('fc-event-nc-task')\n\t\t\t\tif (object.percent === 100 || object.status === 'COMPLETED') {\n\t\t\t\t\tclassNames.push('fc-event-nc-task-completed')\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tlet title\n\t\t\tif (object.name === 'VEVENT') {\n\t\t\t\tif (object.title) {\n\t\t\t\t\ttitle = object.title.replace(/\\n/g, ' ')\n\t\t\t\t} else {\n\t\t\t\t\ttitle = t('calendar', 'Untitled event')\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif (object.title) {\n\t\t\t\t\ttitle = object.title.replace(/\\n/g, ' ')\n\t\t\t\t} else {\n\t\t\t\t\ttitle = t('calendar', 'Untitled task')\n\t\t\t\t}\n\n\t\t\t\tif (object.percent !== null) {\n\t\t\t\t\ttitle += ` (${object.percent}%)`\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst fcEvent = {\n\t\t\t\tid: [calendarObject.id, object.id].join('###'),\n\t\t\t\ttitle,\n\t\t\t\tallDay: object.isAllDay(),\n\t\t\t\tstart: jsStart,\n\t\t\t\tend: jsEnd,\n\t\t\t\t// start: formatLocal(jsStart, object.isAllDay()),\n\t\t\t\t// end: formatLocal(jsEnd, object.isAllDay()),\n\t\t\t\tclassNames,\n\t\t\t\textendedProps: {\n\t\t\t\t\tobjectId: calendarObject.id,\n\t\t\t\t\trecurrenceId: object.getReferenceRecurrenceId()\n\t\t\t\t\t\t? object.getReferenceRecurrenceId().unixTime\n\t\t\t\t\t\t: null,\n\t\t\t\t\tcanModifyAllDay: object.canModifyAllDay(),\n\t\t\t\t\tcalendarOrder: calendar.order,\n\t\t\t\t\tcalendarName: calendar.displayName,\n\t\t\t\t\tcalendarId: calendar.id,\n\t\t\t\t\tdarkText: isLight(hexToRGB(calendar.color)),\n\t\t\t\t\tobjectType: object.name,\n\t\t\t\t\tpercent: object.percent || null,\n\t\t\t\t\tdavUrl: calendarObject.dav.url,\n\t\t\t\t\tlocation: object.location,\n\t\t\t\t\tdescription: object.description,\n\t\t\t\t},\n\t\t\t}\n\n\t\t\tif (object.color) {\n\t\t\t\tconst customColor = getHexForColorName(object.color)\n\t\t\t\tif (customColor) {\n\t\t\t\t\tfcEvent.backgroundColor = customColor\n\t\t\t\t\tfcEvent.borderColor = customColor\n\t\t\t\t\tfcEvent.textColor = generateTextColorForHex(customColor)\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfcEvents.push(fcEvent)\n\t\t}\n\t}\n\n\treturn fcEvents\n}\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @copyright Copyright (c) 2018 John Molakvo\n *\n * @author Georg Ehrke <oc.list@georgehrke.com>\n *\n * @author John Molakvo <skjnldsv@protonmail.com>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport { getLanguage, getLocale } from '@nextcloud/l10n'\nimport moment from '@nextcloud/moment'\n\n/**\n *\n * @return {Promise<string>}\n */\nexport default async function loadMomentLocalization() {\n\tconst locale = getLocale().replace('_', '-').toLowerCase()\n\tconst language = getLanguage().replace('_', '-').toLowerCase()\n\n\tif (locale === language) {\n\t\treturn getLocaleFor(locale)\n\t}\n\n\tconst [realLocale, realLanguage] = await Promise.all([getLocaleFor(locale), getLocaleFor(language)])\n\tif (realLocale === realLanguage) {\n\t\treturn realLocale\n\t}\n\n\tconst name = `nextcloud-calendar-fake-locale-${realLocale}-${realLanguage}`\n\tmoment.defineLocale(name, {\n\t\tparentLocale: realLanguage,\n\t\tlongDateFormat: {\n\t\t\tLT: moment.localeData(realLocale).longDateFormat('LT'),\n\t\t\tLTS: moment.localeData(realLocale).longDateFormat('LTS'),\n\t\t\tL: moment.localeData(realLocale).longDateFormat('L'),\n\t\t\tLL: moment.localeData(realLocale).longDateFormat('LL'),\n\t\t\tLLL: moment.localeData(realLocale).longDateFormat('LLL'),\n\t\t\tLLLL: moment.localeData(realLocale).longDateFormat('LLLL'),\n\t\t\tl: moment.localeData(realLocale).longDateFormat('l'),\n\t\t\tll: moment.localeData(realLocale).longDateFormat('ll'),\n\t\t\tlll: moment.localeData(realLocale).longDateFormat('lll'),\n\t\t\tllll: moment.localeData(realLocale).longDateFormat('llll'),\n\t\t},\n\t\tweek: {\n\t\t\tdow: moment.localeData(realLocale).firstDayOfWeek(),\n\t\t\tdoy: moment.localeData(realLocale).firstDayOfYear(),\n\t\t},\n\t})\n\n\treturn name\n}\n\n/**\n * Dynamically loads the requested locale and returns the actually loaded locale\n *\n * @param {string} locale Name of locale to load\n * @return {Promise<string>}\n */\nasync function getLocaleFor(locale) {\n\t// IMPORTANT: Keep each '/moment/local/...' string as is. Otherwise, webpack might not bundle\n\t//            locale data because the contentRegExp fails to detect any files.\n\ttry {\n\t\t// default load e.g. en-de\n\t\tawait import(`moment/locale/${locale}.js`)\n\t\treturn locale\n\t} catch (error) {\n\t\tconst splitLocale = locale.split('-')\n\t\ttry {\n\t\t\t// failure: fallback to first part of locale, which\n\t\t\t// should be language\n\t\t\tlocale = splitLocale[0]\n\t\t\tawait import(`moment/locale/${locale}.js`)\n\t\t\treturn locale\n\t\t} catch (e) {\n\t\t\t// failure, fallback to english\n\t\t\tconsole.debug('Fallback to locale', 'en')\n\t\t\t// English is the default locale and doesn't need to imported.\n\t\t\t// It is already included in moment.js.\n\t\t}\n\t}\n\n\treturn 'en'\n}\n\n/**\n * Get's the first day of a week based on a moment locale\n *\n * @return {number}\n */\nexport function getFirstDayOfWeekFromMomentLocale() {\n\treturn moment.localeData().firstDayOfWeek()\n}\n","<!--\n\t- @copyright Copyright (c) 2020 Julius Hrtl <jus@bitgrid.net>\n\t-\n\t- @author Julius Hrtl <jus@bitgrid.net>\n\t-\n\t- @license AGPL-3.0-or-later\n\t-\n\t- This program is free software: you can redistribute it and/or modify\n\t- it under the terms of the GNU Affero General Public License as\n\t- published by the Free Software Foundation, either version 3 of the\n\t- License, or (at your option) any later version.\n\t-\n\t- This program is distributed in the hope that it will be useful,\n\t- but WITHOUT ANY WARRANTY; without even the implied warranty of\n\t- MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n\t- GNU Affero General Public License for more details.\n\t-\n\t- You should have received a copy of the GNU Affero General Public License\n\t- along with this program. If not, see <http://www.gnu.org/licenses/>.\n\t-\n\t-->\n\n<template>\n\t<DashboardWidget id=\"calendar_panel\"\n\t\t:items=\"items\"\n\t\t:loading=\"loading\">\n\t\t<template #default=\"{ item }\">\n\t\t\t<EmptyContent v-if=\"item.isEmptyItem\"\n\t\t\t\tid=\"calendar-widget-empty-content\"\n\t\t\t\tclass=\"half-screen\"\n\t\t\t\t:title=\"t('calendar', 'No more events today')\">\n\t\t\t\t<template #icon>\n\t\t\t\t\t<IconCheck :size=\"67\" />\n\t\t\t\t</template>\n\t\t\t</EmptyContent>\n\t\t\t<DashboardWidgetItem v-else\n\t\t\t\t:main-text=\"item.mainText\"\n\t\t\t\t:sub-text=\"item.subText\"\n\t\t\t\t:target-url=\"item.targetUrl\">\n\t\t\t\t<template #avatar>\n\t\t\t\t\t<div v-if=\"item.componentName === 'VEVENT'\"\n\t\t\t\t\t\tclass=\"calendar-dot\"\n\t\t\t\t\t\t:style=\"{'background-color': item.calendarColor}\"\n\t\t\t\t\t\t:title=\"item.calendarDisplayName\" />\n\t\t\t\t\t<IconCheckbox v-else\n\t\t\t\t\t\t:fill-color=\"item.calendarColor\" />\n\t\t\t\t</template>\n\t\t\t</DashboardWidgetItem>\n\t\t</template>\n\t\t<template #empty-content>\n\t\t\t<EmptyContent id=\"calendar-widget-empty-content\"\n\t\t\t\t:title=\"t('calendar', 'No upcoming events')\">\n\t\t\t\t<template #icon>\n\t\t\t\t\t<EmptyCalendar />\n\t\t\t\t</template>\n\t\t\t</EmptyContent>\n\t\t\t<div class=\"empty-label\">\n\t\t\t\t<NcButton type=\"secondary\" :href=\"clickStartNew\">\n\t\t\t\t\t{{ t('calendar', 'Create a new event') }}\n\t\t\t\t</NcButton>\n\t\t\t</div>\n\t\t</template>\n\t</DashboardWidget>\n</template>\n\n<script>\nimport { DashboardWidget, DashboardWidgetItem } from '@nextcloud/vue-dashboard'\nimport { NcEmptyContent as EmptyContent, NcButton } from '@nextcloud/vue'\nimport EmptyCalendar from 'vue-material-design-icons/CalendarBlankOutline.vue'\nimport IconCheck from 'vue-material-design-icons/Check.vue'\nimport IconCheckbox from 'vue-material-design-icons/CheckboxBlankOutline.vue'\nimport { loadState } from '@nextcloud/initial-state'\nimport moment from '@nextcloud/moment'\nimport { imagePath, generateUrl } from '@nextcloud/router'\nimport { initializeClientForUserView } from '../services/caldavService.js'\nimport { dateFactory } from '../utils/date.js'\nimport pLimit from 'p-limit'\nimport { eventSourceFunction } from '../fullcalendar/eventSources/eventSourceFunction.js'\nimport loadMomentLocalization from '../utils/moment.js'\nimport { DateTimeValue } from '@nextcloud/calendar-js'\nimport { mapGetters } from 'vuex'\n\nexport default {\n\tname: 'Dashboard',\n\tcomponents: {\n\t  DashboardWidget,\n\t\tDashboardWidgetItem,\n\t  NcButton,\n\t\tEmptyContent,\n\t  EmptyCalendar,\n\t  IconCheck,\n\t  IconCheckbox,\n\t},\n\tdata() {\n\t\treturn {\n\t\t\tevents: null,\n\t\t\tlocale: 'en',\n\t\t\timagePath: imagePath('calendar', 'illustrations/calendar'),\n\t\t\tloading: true,\n\t\t\tnow: dateFactory(),\n\t\t}\n\t},\n\tcomputed: {\n\t\t...mapGetters({\n\t\t\ttimezoneObject: 'getResolvedTimezoneObject',\n\t\t}),\n\t\t/**\n\t\t * Format loaded events\n\t\t *\n\t\t * @return {Array}\n\t\t */\n\t\titems() {\n\t\t\tif (!Array.isArray(this.events) || this.events.length === 0) {\n\t\t\t\treturn []\n\t\t\t}\n\n\t\t\tconst firstEvent = this.events[0]\n\t\t\tconst endOfToday = moment(this.now).endOf('day')\n\t\t\tif (endOfToday.isBefore(firstEvent.startDate)) {\n\t\t\t\treturn [{\n\t\t\t\t\tisEmptyItem: true,\n\t\t\t\t}].concat(this.events.slice(0, 4))\n\t\t\t}\n\n\t\t\treturn this.events\n\t\t},\n\t\t/**\n\t\t * Redirects to the new event route\n\t\t *\n\t\t * @return {string}\n\t\t */\n\t\tclickStartNew() {\n\t\t\treturn generateUrl('apps/calendar') + '/new'\n\t\t},\n\t},\n\tmounted() {\n\t\tthis.initialize()\n\t},\n\tmethods: {\n\t\t/**\n\t\t * Initialize the widget\n\t\t */\n\t\tasync initialize() {\n\t\t\tconst start = dateFactory()\n\t\t\tconst end = dateFactory()\n\t\t\tend.setDate(end.getDate() + 14)\n\n\t\t\tconst startOfToday = moment(start).startOf('day').toDate()\n\n\t\t\tawait this.initializeEnvironment()\n\t\t\tconst expandedEvents = await this.fetchExpandedEvents(start, end)\n\t\t\tthis.events = await this.formatEvents(expandedEvents, startOfToday)\n\t\t\tthis.loading = false\n\t\t},\n\t\t/**\n\t\t * Initialize everything necessary,\n\t\t * before we can fetch events\n\t\t *\n\t\t * @return {Promise<void>}\n\t\t */\n\t\tasync initializeEnvironment() {\n\t\t\tawait initializeClientForUserView()\n\t\t\tawait this.$store.dispatch('fetchCurrentUserPrincipal')\n\t\t\tawait this.$store.dispatch('loadCollections')\n\n\t\t\tconst {\n\t\t\t\tshow_tasks: showTasks,\n\t\t\t\ttimezone,\n\t\t\t} = loadState('calendar', 'dashboard_data')\n\t\t\tconst locale = await loadMomentLocalization()\n\n\t\t\tthis.$store.commit('loadSettingsFromServer', {\n\t\t\t\ttimezone,\n\t\t\t\tshowTasks,\n\t\t\t})\n\t\t\tthis.$store.commit('setMomentLocale', {\n\t\t\t\tlocale,\n\t\t\t})\n\t\t},\n\t\t/**\n\t\t * Fetch events\n\t\t *\n\t\t * @param {Date} from Start of time-range\n\t\t * @param {Date} to End of time-range\n\t\t * @return {Promise<object[]>}\n\t\t */\n\t\tasync fetchExpandedEvents(from, to) {\n\t\t\tconst limit = pLimit(10)\n\t\t\tconst fetchEventPromises = []\n\t\t\tfor (const calendar of this.$store.getters.enabledCalendars) {\n\t\t\t\tfetchEventPromises.push(limit(async () => {\n\t\t\t\t\tlet timeRangeId\n\t\t\t\t\ttry {\n\t\t\t\t\t\ttimeRangeId = await this.$store.dispatch('getEventsFromCalendarInTimeRange', {\n\t\t\t\t\t\t\tcalendar,\n\t\t\t\t\t\t\tfrom,\n\t\t\t\t\t\t\tto,\n\t\t\t\t\t\t})\n\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\treturn []\n\t\t\t\t\t}\n\n\t\t\t\t\tconst calendarObjects = this.$store.getters.getCalendarObjectsByTimeRangeId(timeRangeId)\n\t\t\t\t\treturn eventSourceFunction(calendarObjects, calendar, from, to, this.timezoneObject)\n\t\t\t\t}))\n\t\t\t}\n\n\t\t\tconst expandedEvents = await Promise.all(fetchEventPromises)\n\t\t\treturn expandedEvents.flat()\n\t\t},\n\t\t/**\n\t\t * @param {object[]} expandedEvents Array of fullcalendar events\n\t\t * @param {Date} filterBefore filter events that start before date\n\t\t * @return {object[]}\n\t\t */\n\t\tformatEvents(expandedEvents, filterBefore) {\n\t\t\treturn expandedEvents\n\t\t\t\t.sort((a, b) => a.start.getTime() - b.start.getTime())\n\t\t\t\t.filter(event => !event.classNames.includes('fc-event-nc-task-completed'))\n\t\t\t\t.filter(event => !event.classNames.includes('fc-event-nc-cancelled'))\n\t\t\t\t.filter(event => filterBefore.getTime() <= event.start.getTime())\n\t\t\t\t.slice(0, 7)\n\t\t\t\t.map((event) => ({\n\t\t\t\t\tisEmptyItem: false,\n\t\t\t\t\tcomponentName: event.extendedProps.objectType,\n\t\t\t\t\ttargetUrl: event.extendedProps.objectType === 'VEVENT'\n\t\t\t\t\t\t? this.getCalendarAppUrl(event)\n\t\t\t\t\t\t: this.getTasksAppUrl(event),\n\t\t\t\t\tsubText: this.formatSubtext(event),\n\t\t\t\t\tmainText: event.title,\n\t\t\t\t\tstartDate: event.start,\n\t\t\t\t\tcalendarColor: this.$store.state.calendars.calendarsById[event.extendedProps.calendarId].color,\n\t\t\t\t\tcalendarDisplayName: this.$store.state.calendars.calendarsById[event.extendedProps.calendarId].displayname,\n\t\t\t\t}))\n\t\t},\n\t\t/**\n\t\t * @param {object} event The full-calendar formatted event\n\t\t * @return {string}\n\t\t */\n\t\tformatSubtext(event) {\n\t\t\tconst locale = this.$store.state.settings.momentLocale\n\n\t\t\tif (event.allDay) {\n\t\t\t\treturn moment(event.start).locale(locale).calendar(null, {\n\t\t\t\t\t// TRANSLATORS Please translate only the text in brackets and keep the brackets!\n\t\t\t\t\tsameDay: t('calendar', '[Today]'),\n\t\t\t\t\t// TRANSLATORS Please translate only the text in brackets and keep the brackets!\n\t\t\t\t\tnextDay: t('calendar', '[Tomorrow]'),\n\t\t\t\t\tnextWeek: 'dddd',\n\t\t\t\t\t// TRANSLATORS Please translate only the text in brackets and keep the brackets!\n\t\t\t\t\tlastDay: t('calendar', '[Yesterday]'),\n\t\t\t\t\t// TRANSLATORS Please translate only the text in brackets and keep the brackets!\n\t\t\t\t\tlastWeek: t('calendar', '[Last] dddd'),\n\t\t\t\t\tsameElse: () => '[replace-from-now]',\n\t\t\t\t}).replace('replace-from-now', moment(event.start).locale(locale).fromNow())\n\t\t\t} else {\n\t\t\t\tconst start = DateTimeValue.fromJSDate(event.start).getInTimezone(this.timezoneObject)\n\t\t\t\tconst utcOffset = start.utcOffset() / 60\n\t\t\t\treturn moment(event.start)\n\t\t\t\t\t.utcOffset(utcOffset)\n\t\t\t\t\t.locale(locale)\n\t\t\t\t\t.calendar(null, {\n\t\t\t\t\t\tsameElse: () => '[replace-from-now]',\n\t\t\t\t\t})\n\t\t\t\t\t.replace(\n\t\t\t\t\t\t'replace-from-now',\n\t\t\t\t\t\tmoment(event.start).utcOffset(utcOffset).locale(locale).fromNow(),\n\t\t\t\t\t)\n\t\t\t}\n\t\t},\n\t\t/**\n\t\t * @param {object} data The data destructuring object\n\t\t * @param {object} data.extendedProps Extended Properties of the FC object\n\t\t * @return {string}\n\t\t */\n\t\tgetCalendarAppUrl({ extendedProps }) {\n\t\t\treturn generateUrl('apps/calendar') + '/edit/' + extendedProps.objectId + '/' + extendedProps.recurrenceId\n\t\t},\n\t\t/**\n\t\t * @param {object} data The data destructuring object\n\t\t * @param {object} data.extendedProps Extended Properties of the FC object\n\t\t * @return {string}\n\t\t */\n\t\tgetTasksAppUrl({ extendedProps }) {\n\t\t\tconst davUrlParts = extendedProps.davUrl.split('/')\n\t\t\tconst taskId = davUrlParts.pop()\n\t\t\tconst calendarId = davUrlParts.pop()\n\t\t\treturn generateUrl('apps/tasks') + `/#/calendars/${calendarId}/tasks/${taskId}`\n\t\t},\n\t},\n}\n</script>\n\n<style lang=\"scss\">\n#calendar_panel {\n\t.calendar-dot {\n\t\tflex-shrink: 0;\n\t\theight: 1rem;\n\t\twidth: 1rem;\n\t\tmargin-top: 0.2rem;\n\t\tborder-radius: 50%;\n\t}\n\n\t#calendar-widget-empty-content {\n\t\ttext-align: center;\n\t\tmargin-top: 5vh;\n\n\t\t&.half-screen {\n\t\t\tmargin-top: 0;\n\t\t\theight: 120px;\n\t\t\tmargin-bottom: 2vh;\n\t\t}\n\n\t}\n\n\t.empty-label {\n\t\tdisplay: flex;\n\t\tjustify-content: center;\n\t\tmargin-top: 5vh;\n\t}\n}\n</style>\n","import mod from \"-!../../node_modules/babel-loader/lib/index.js!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Dashboard.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/babel-loader/lib/index.js!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Dashboard.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Dashboard.vue?vue&type=template&id=1324c966&\"\nimport script from \"./Dashboard.vue?vue&type=script&lang=js&\"\nexport * from \"./Dashboard.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Dashboard.vue?vue&type=style&index=0&id=1324c966&prod&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../node_modules/css-loader/dist/cjs.js!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/resolve-url-loader/index.js!../../node_modules/sass-loader/dist/cjs.js??clonedRuleSet-2.use[3]!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Dashboard.vue?vue&type=style&index=0&id=1324c966&prod&lang=scss&\");\nif(content.__esModule) content = content.default;\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"6040151a\", content, true, {});"],"names":["getDefaultCategories","t","map","value","label","getDefaultAlarmObject","props","arguments","length","undefined","Object","assign","alarmComponent","type","isRelative","absoluteDate","absoluteTimezoneId","relativeIsBefore","relativeIsRelatedToStart","relativeUnitTimed","relativeAmountTimed","relativeUnitAllDay","relativeAmountAllDay","relativeHoursAllDay","relativeMinutesAllDay","relativeTrigger","mapAlarmComponentToAlarmObject","trigger","isNegative","related","amount","unit","getAmountAndUnitForTimedEvents","totalSeconds","hours","minutes","getAmountHoursMinutesAndUnitForAllDayEvents","action","getDateFromDateTimeValue","timezoneId","AppointmentConfig","id","token","name","description","location","visibility","targetCalendarUri","availability","increment","preparationDuration","followupDuration","timeBeforeNextSlot","dailyMax","futureLimit","calendarFreeBusyUris","createTalkRoom","constructor","data","this","tryParseInt","static","scheduleInbox","slots","getEmptySlots","converted","vavailabilityToSlots","tsAtTime","Math","round","Date","setHours","forEach","day","push","start","end","clone","fromJSON","JSON","stringify","jsonString","parse","bookingUrl","window","protocol","hostname","generateUrl","parseInt","mapAttachmentPropertyToAttchmentObject","attachmentProperty","fileName","formatType","uri","xNcHasPreview","xNcFileId","getDefaultAttachmentObject","getParameterFirstValue","mapAttendeePropertyToAttendeeObject","attendeeProperty","commonName","calendarUserType","participationStatus","role","rsvp","member","getDefaultAttendeeObject","userType","email","getDefaultCalendarObject","displayName","color","uidToHexColor","enabled","loading","supportsEvents","supportsJournals","supportsTasks","owner","timezone","shares","publishURL","url","readOnly","order","isSharedWithMe","canBeShared","canBePublished","dav","calendarObjects","fetchedTimeRanges","mapDavCollectionToCalendar","calendar","currentUserPrincipal","btoa","displayname","endsWith","substring","lastIndexOf","getCalendarUriFromUrl","detectColor","components","includes","isWriteable","isShareable","isPublishable","Array","isArray","share","href","principalScheme","mapDavShareeToCalendarShareObject","getDefaultCalendarObjectObject","calendarId","calendarComponent","uid","objectType","isEvent","isJournal","isTodo","existsOnServer","mapCDavObjectToCalendarObject","parser","getParserManager","getParserForFileType","trim","Error","getItemIterator","next","firstVObject","getVObjectIterator","COMPONENT_NAME_EVENT","COMPONENT_NAME_JOURNAL","COMPONENT_NAME_VTODO","mapCalendarJsToCalendarObject","vObjectIterator","sharee","encodeURI","startsWith","PRINCIPAL_PREFIX_GROUP","decodeURIComponent","slice","PRINCIPAL_PREFIX_USER","writeable","isUser","isGroup","isCircle","getDefaultCalendarShareObject","access","PRINCIPAL_PREFIX_CIRCLE","PRINCIPAL_PREFIX_CALENDAR_RESOURCE","PRINCIPAL_PREFIX_CALENDAR_ROOM","CALDAV_BIRTHDAY_CALENDAR","IMPORT_STAGE_DEFAULT","IMPORT_STAGE_IMPORTING","IMPORT_STAGE_PROCESSING","getDefaultEventObject","eventComponent","title","startDate","startTimezoneId","endDate","endTimezoneId","isAllDay","canModifyAllDay","accessClass","status","timeTransparency","recurrenceRule","getDefaultRecurrenceRuleObject","hasMultipleRRules","isMasterItem","isRecurrenceException","forceThisAndAllFuture","canCreateRecurrenceException","attendees","organizer","alarms","customColor","categories","attachments","mapEventComponentToEventObject","eventObject","from","getCategoryIterator","canCreateRecurrenceExceptions","addDuration","DurationValue","organizerProperty","getFirstProperty","alarm","getAlarmIterator","attendee","getAttendeeIterator","attachment","getPropertyIterator","recurrenceRuleIterator","firstRecurrenceRule","mapRecurrenceRuleValueToRecurrenceRuleObject","getFirstValue","done","hasProperty","hexColor","getHexForColorName","getFirstPropertyFirstValue","copyCalendarObjectInstanceIntoEventComponent","category","addCategory","setOrganizerFromNameAndEMail","duration","addRelativeAlarm","date","DateTimeValue","addAbsoluteAlarm","addProperty","rule","getClosestCSS3ColorNameForHex","getDefaultPrincipalObject","emailAddress","userId","isCalendarResource","isCalendarRoom","principalId","mapDavToPrincipal","principalUrl","recurrenceRuleValue","frequency","interval","count","until","byDay","byMonth","byMonthDay","bySetPosition","isUnsupported","baseDate","mapDailyRuleValueToRecurrenceRuleObject","mapWeeklyRuleValueToRecurrenceRuleObject","mapMonthlyRuleValueToRecurrenceRuleObject","mapYearlyRuleValueToRecurrenceRuleObject","getDefaultRecurrenceRuleObjectForRecurrenceValue","FORBIDDEN_BY_PARTS_DAILY","FORBIDDEN_BY_PARTS_WEEKLY","FORBIDDEN_BY_PARTS_MONTHLY","FORBIDDEN_BY_PARTS_YEARLY","SUPPORTED_BY_DAY_WEEKLY","getRangeAsStrings","apply","_","n","s","toString","SUPPORTED_BY_MONTHDAY_MONTHLY","SUPPORTED_BY_MONTH_YEARLY","containsRecurrenceComponent","containsUnsupportedByParts","containsInvalidByDayPart","getComponent","some","weekday","filter","getWeekDayFromDate","jsDate","containsInvalidByMonthDay","monthDay","isAllowedByDay","setPositionArray","isAllowedBySetPos","byDayArray","firstElement","match","exec","matchedBySetPosition","matchedByDay","month","sort","join","bySetPos","component","isUnsupportedProps","getRFCProperties","readableName","icon","options","multiple","info","defaultValue","placeholder","defaultNumberOfRows","tagPlaceholder","async","createConfig","config","logger","response","axios","deleteConfig","updateConfig","clients","getClientKey","headers","getClient","clientKey","DavClient","rootUrl","generateRemoteUrl","mergedHeaders","requesttoken","getRequestToken","xhr","XMLHttpRequest","oldOpen","open","result","setRequestHeader","OC","registerXHRForErrorProcessing","initializeClientForUserView","connect","enableCalDAV","getCalendarHome","calendarHomes","findAll","findAllCalDAVCollectionsGrouped","findAllDeletedCalendars","findPublicCalendarsByTokens","findPromises","tokens","promise","publicCalendarHome","find","catch","Promise","all","createCalendar","timezoneIcs","createCalendarCollection","createSubscription","source","createSubscribedCollection","enableBirthdayCalendar","getBirthdayCalendar","getCurrentUserPrincipal","findPrincipalByUrl","findPrincipal","setConfig","key","HttpClient","getLinkToConfig","updateTalkParticipants","apiVersion","loadState","getConferenceList","host","participantsResponse","HTTPClient","generateOcsUrl","ocs","participant","actorId","getCurrentUser","participantType","currentUser","conversation","participantId","removeMailtoPrefix","attendeeSource","searchResult","encodeURIComponent","error","newParticipant","timezoneManager","getTimezoneManager","initialized","registerDefaultTimezones","detectTimezone","determinedTimezone","jstz","timezoneName","mutations","addInitialConfigs","state","configs","Vue","_ref","addConfig","_ref2","_ref3","getters","allConfigs","values","actions","_ref4","_ref5","commit","updatedConfig","_ref6","_ref7","fullConfig","_ref8","_ref9","setCalendarObjectInstanceForExistingEvent","calendarObject","calendarObjectInstance","objectId","recurrenceId","isNew","existingEvent","setCalendarObjectInstanceForNewEvent","resetCalendarObjectInstanceObjectIdAndRecurrenceId","changeTitle","changeStartDate","year","getFullYear","getMonth","getDate","hour","getHours","minute","getMinutes","second","endDateObj","startDateObj","compare","getTimezoneForId","getInTimezone","changeStartTimezone","startTimezone","replaceTimezone","changeEndDate","endDateObject","getTime","changeEndTimezone","endTimezone","toggleAllDay","isDate","changeTimeToDefaultForTimedEvents","changeLocation","_ref10","deleteAllProperties","changeDescription","_ref11","descriptionProperty","parameter","getParametersIterator","deleteParameter","changeAccessClass","_ref12","changeStatus","_ref13","changeTimeTransparency","_ref14","changeCustomColor","_ref15","cssColorName","hexColorOfCssName","console","addAttendee","_ref16","language","AttendeeProperty","updateParameterIfExist","removeAttendee","_ref17","members","index","indexOf","splice","changeAttendeesParticipationStatus","_ref18","changeAttendeesRole","_ref19","toggleAttendeeRSVP","_ref20","oldRSVP","setOrganizer","_ref21","_ref22","removeCategory","_ref23","changeRecurrenceInterval","_ref24","debug","_innerValue","changeRecurrenceFrequency","_ref25","changeRecurrenceCount","_ref26","changeRecurrenceUntil","_ref27","zone","changeRecurrenceToInfinite","_ref28","setToInfinite","resetRecurrenceByParts","_ref29","parts","part","setComponent","setDefaultRecurrenceByPartsForWeekly","_ref30","setDefaultRecurrenceByPartsForMonthly","_ref31","setDefaultRecurrenceByPartsForMonthlyBySetPosition","_ref32","getBySetPositionAndBySetFromDate","setDefaultRecurrenceByPartsForYearly","_ref33","addByDayToRecurrenceRule","_ref34","byDayList","removeByDayFromRecurrenceRule","_ref35","index2","addByMonthDayToRecurrenceRule","_ref36","byMonthDayList","removeByMonthDayFromRecurrenceRule","_ref37","addByMonthToRecurrenceRule","_ref38","byMonthList","removeByMonthFromRecurrenceRule","_ref39","changeRecurrenceByDay","_ref40","changeRecurrenceBySetPosition","_ref41","unsetRecurrenceBySetPosition","_ref42","removeRecurrenceRuleFromCalendarObjectInstance","_ref43","addRecurrenceRuleFromCalendarObjectInstance","_ref44","recurrenceValue","RecurValue","recurrenceProperty","Property","markRecurrenceRuleAsSupported","_ref45","changeAlarmType","_ref46","toICALJs","changeAlarmAmountTimed","_ref47","getTotalSecondsFromAmountAndUnitForTimedEvents","changeAlarmUnitTimed","_ref48","changeAlarmAmountAllDay","_ref49","getTotalSecondsFromAmountHourMinutesAndUnitForAllDayEvents","changeAlarmUnitAllDay","_ref50","changeAlarmHoursMinutesAllDay","_ref51","changeAlarmAbsoluteDate","_ref52","changeAlarmAbsoluteTimezoneId","_ref53","changeAlarmFromRelativeToAbsolute","_ref54","triggerDateTime","setTriggerFromAbsolute","changeAlarmFromAbsoluteToRelative","_ref55","subtractDateWithTimezone","setTriggerFromRelative","resetAlarmRelativeParts","_ref56","resetAlarmAbsoluteParts","_ref57","updateAlarmAllDayParts","_ref58","allDayParts","updateAlarmTimedParts","_ref59","timedParts","addAlarmToCalendarObjectInstance","_ref60","alarmObject","removeAlarmFromCalendarObjectInstance","_ref61","removeAlarm","addAttachmentBySharedData","_ref62","sharedData","AttachmentProperty","parameterFileName","Parameter","fileid","xNcSharedTypes","setParameter","shareTypes","getcontenttype","addAttachmentWithProperty","_ref63","deleteAttachment","_ref64","removeAttachment","_ref65","_ref66","dispatch","closeToDate","d","recurrenceManager","getClosestOccurrence","getReferenceRecurrenceId","unixTime","_ref67","_ref68","resolve","recurrenceIdDate","getObjectAtRecurrenceId","_ref69","_ref70","defaultReminder","settings","isNaN","_ref71","_ref72","_ref73","_ref74","thisAndAllFuture","updateEmailAlarms","isDirty","original","fork","primaryItem","createRecurrenceException","root","newCalendarId","_ref75","oldCalendarObjectInstance","oldEventComponent","getInUTC","_ref76","_ref77","isRecurrenceSetEmpty","removeThisOccurrence","_ref78","_ref79","difference","_ref80","_ref81","_ref82","_ref83","_ref84","_ref85","setDefaultRecurrenceByParts","_ref86","_ref87","setRecurrenceToInfinite","_ref88","_ref89","changeMonthlyRecurrenceFromByDayToBySetPosition","_ref90","_ref91","changeMonthlyRecurrenceFromBySetPositionToByDay","_ref92","_ref93","enableYearlyRecurrenceBySetPosition","_ref94","_ref95","disableYearlyRecurrenceBySetPosition","_ref96","_ref97","enableRecurrenceLimitByUntil","_ref98","_ref99","enableRecurrenceLimitByCount","_ref100","_ref101","_ref102","_ref103","_ref104","_ref105","_ref106","_ref107","_ref108","_ref109","_ref110","_ref111","_ref112","_ref113","_ref114","_ref115","_ref116","_ref117","getResolvedTimezone","appendCalendarObjects","appendCalendarObject","updateCalendarObjectId","updateCalendarObjectIdCalendarId","calendarObjectId","resetCalendarObjectToDav","firstVCalendar","deleteCalendarObject","incrementModificationCount","modificationCount","getCalendarObjectById","context","oldCalendarObjectId","oldCalendarId","newCalendar","getCalendarById","move","toICS","update","createVObject","delete","createNewEvent","startDateTime","endDateTime","createEvent","vObject","undirtify","firstCalendar","sortedCalendars","updateTimeOfNewEvent","addCalendar","object","calendars","existing","calendarsById","addTrashBin","trashBin","addScheduleInbox","addDeletedCalendar","deletedCalendars","c","removeDeletedCalendar","removeDeletedCalendarObject","vobject","deletedCalendarObjects","vo","addDeletedCalendarObject","deleteCalendar","toggleCalendarEnabled","renameCalendar","newName","changeCalendarColor","newColor","changeCalendarOrder","newOrder","appendCalendarObjectsToCalendar","calendarObjectIds","addCalendarObjectToCalendar","deleteCalendarObjectFromCalendar","addFetchedTimeRangeToCalendar","fetchedTimeRangeId","deleteFetchedTimeRangeFromCalendar","shareCalendar","user","newSharee","unshareCalendar","search","shareIndex","findIndex","toggleCalendarShareWritable","publishCalendar","unpublishCalendar","initialCalendarsLoaded","markCalendarAsLoading","markCalendarAsNotLoading","showEditCalendarModal","editCalendarModal","hideEditCalendarModal","setCalendarDeleteCountdown","countdown","setCalendarDeleteHandles","deleteTimeout","deleteInterval","sortedCalendarsSubscriptions","store","rootState","showTasks","a","b","ownSortedCalendars","hasTrashBin","retentionDuration","sortedDeletedCalendars","deletedAt","calendarUriMap","withoutTrail","replace","obj","_props","sortedSubscriptions","enabledCalendars","lastSlash","hasBirthdayCalendar","sortedCalendarFilteredByComponents","vevent","vjournal","vtodo","trashBins","scheduleInboxes","subscriptions","vobjects","findDeletedObjects","davCalendar","timezoneObject","Timezone","CalendarComponent","addComponent","TimezoneComponent","deleteCalendarAfterTimeout","setInterval","setTimeout","showError","clearInterval","cancelCalendarDeletion","clearTimeout","restore","getFirstComponent","timeRange","getTimeRangeForCalendarCoveringRange","timeRangeId","unshare","publish","unpublish","to","findByTypeInTimeRange","responseTodo","getUnixTimestampFromDate","lastFetched","dateFactory","insertId","getLastTimeRangeInsertId","r","concat","e","lastTimeRangeInsertId","objectPath","atob","lastSlashIndex","calendarPath","objectFileName","reject","files","importFiles","totalCount","file","getItemCount","importCalendarRelation","getName","filename","getColor","containsVEvents","containsVJournals","containsVTodos","fileId","limit","pLimit","requests","item","ics","davObject","calendarsToUpdate","appendContact","contact","contacts","emails","contactByEMail","removeContact","loadDavRestrictionsFromServer","minimumDate","maximumDate","addTimeRange","fetchedTimeRange","fetchedTimeRangesById","removeTimeRange","appendCalendarObjectIdsToTimeFrame","appendCalendarObjectIdToTimeRange","removeCalendarObjectIdFromTimeRange","removeCalendarObjectIdFromAnyTimeRange","updateTimestampOfLastFetched","addCalendarObjectIdToAllTimeRangesOfCalendar","timerange","removeCalendarObjectIdFromAllTimeRangesOfCalendar","clearFetchedTimeRanges","getAllTimeRangesForCalendar","f","requestedFrom","requestedTo","getAllTimeRangesOlderThan","olderThan","getCalendarObjectsByTimeRangeId","addFile","contents","lastModified","size","lastFileInsertId","importFilesById","setCalendarForFileId","removeAllFiles","incrementAccepted","accepted","incrementDenied","denied","setTotal","total","changeStage","stage","resetState","Vuex","modules","appointmentConfigs","davRestrictions","importState","principals","addPrincipal","principal","principalsById","setCurrentUserPrincipal","getPrincipalByUrl","getPrincipalById","getCurrentUserPrincipalEmail","toggleEventLimitEnabled","eventLimit","togglePopoverEnabled","skipPopover","toggleTasksEnabled","toggleWeekendsEnabled","showWeekends","toggleWeekNumberEnabled","showWeekNumbers","setSlotDuration","slotDuration","setDefaultReminder","setTimezone","setAttachmentsFolder","attachmentsFolder","loadSettingsFromServer","appVersion","firstRun","talkEnabled","tasksEnabled","hideEventExport","forceEventAlarmType","disableAppointments","canSubscribeLink","showResources","logInfo","setMomentLocale","locale","momentLocale","isTalkEnabled","getResolvedTimezoneObject","initialView","initializeCalendarJsConfig","setCalendarJsConfig","getFactorForAlarmUnit","abs","isBefore","dayFactor","hourFactor","minuteFactor","dayPart","floor","hourPart","minutePart","invertedHours","invertedMinutes","summaryProperty","defaultSummary","defaultDescription","getAllObjectsInTimeRange","getAllOccurrencesBetween","getOccurrenceAtExactly","uniqColorKeys","uniqBy","keys","cssColors","filteredColors","pick","colors","sortBy","hex","defaults","detailed","proximity","s1","s2","c1","rgb2lab","get","c2","sqrt","pow","input","rgb","xyz","Lab","i","parseFloat","toFixed","isLight","red","green","blue","generateTextColorForHex","generateTextColorForRGB","hexToRGB","convert","uidToColor","g","test","colorName","css3Colors","opt","sortedColors","closestColor","dateTimeValue","getLoggerBuilder","setApp","detectUser","build","message","dayOfMonth","getDay","TypeError","linkTo","hash","toLowerCase","md5","finalPalette","steps","Color","yellow","palette1","mixPalette","palette2","palette3","GenColors","maximum","finalInt","charAt","j","hashToInt","color1","color2","palette","step","ends","stepCalc","___CSS_LOADER_EXPORT___","module","webpackAsyncContext","req","__webpack_require__","o","then","code","ids","exports","eventSourceFunction","fcEvents","allObjectsInTimeRange","classNames","hasComponent","jsStart","jsEnd","setSeconds","getSeconds","percent","fcEvent","allDay","extendedProps","calendarOrder","calendarName","darkText","davUrl","backgroundColor","borderColor","textColor","getLocaleFor","splitLocale","split","DashboardWidget","DashboardWidgetItem","NcButton","EmptyContent","EmptyCalendar","IconCheck","IconCheckbox","events","imagePath","now","computed","mapGetters","items","firstEvent","moment","endOf","isEmptyItem","clickStartNew","mounted","initialize","methods","setDate","startOfToday","startOf","toDate","initializeEnvironment","expandedEvents","fetchExpandedEvents","formatEvents","$store","show_tasks","getLocale","getLanguage","realLocale","realLanguage","parentLocale","longDateFormat","LT","LTS","L","LL","LLL","LLLL","l","ll","lll","llll","week","dow","firstDayOfWeek","doy","firstDayOfYear","loadMomentLocalization","fetchEventPromises","flat","filterBefore","event","componentName","targetUrl","getCalendarAppUrl","getTasksAppUrl","subText","formatSubtext","mainText","calendarColor","calendarDisplayName","sameDay","nextDay","nextWeek","lastDay","lastWeek","sameElse","fromNow","utcOffset","davUrlParts","taskId","pop","_vm","_c","_self","attrs","scopedSlots","_u","fn","staticClass","proxy","style","_v","_s","content","__esModule","default","locals","add"],"sourceRoot":""}